<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title></title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>





<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<p>#&#39;title: &quot;Competitive Balance 1st Part&quot;
#&#39;author: &quot;Thanos Spinoulas&quot;
#&#39;date: &quot;July 9, 2017&quot;
#&#39;output: html_document</p>

<pre><code class="r">getwd()
</code></pre>

<pre><code>## [1] &quot;C:/Users/Thanos/Documents/MSc In Business Analytics/Thesis - FSP/R/Competitive Balance/Competitive_Balance&quot;
</code></pre>

<pre><code class="r">#####Install useful packages#####
#install.packages(&quot;xlsx&quot;)
#install.packages(&quot;readxl&quot;)

#####Call the packages#####
library(xlsx)
library(readxl)
</code></pre>

<pre><code class="r">#####Importing the data for the English Premier League, seasons 2008-2016#####
data_1 &lt;- read.csv(&quot;Eng_premier_league_2010_11.csv&quot;, sep = &quot;,&quot;)
data_2 &lt;- read.csv(&quot;Eng_premier_league_2011_12.csv&quot;, sep = &quot;,&quot;)
data_3 &lt;- read.csv(&quot;English Premier League 2012_13.csv&quot;, sep = &quot;,&quot;)
data_4 &lt;- read.csv(&quot;English Premier League_2013_14.csv&quot;, sep = &quot;,&quot;)
data_5 &lt;- read.csv(&quot;_English Premier League 2014_15.csv&quot;, sep = &quot;,&quot;)
data_6 &lt;- read.csv(&quot;_English Premier League_2008.csv&quot;, sep = &quot;,&quot;)
data_7 &lt;- read.csv(&quot;English Premier League_2009_10.csv&quot;, sep = &quot;,&quot;)
data_8 &lt;- read.xlsx(&quot;Eng_premier_league_2015_16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)

#####Importing the data for the German League seasons 2008-2016#####
data_GL09 &lt;- read.xlsx(&quot;German_League_season_2008-09.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL10 &lt;- read.xlsx(&quot;German_League_season_2009-10.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL11 &lt;- read.xlsx(&quot;German_League_season_2010-11.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL12 &lt;- read.xlsx(&quot;German_League_season_2011-12.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL13 &lt;- read.xlsx(&quot;German_League_season_2012-13.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL14 &lt;- read.xlsx(&quot;German_League_season_2013-14.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL15 &lt;- read.xlsx(&quot;German_League_season_2014-15.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GL16 &lt;- read.xlsx(&quot;German_League_season_2015-16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)


#####Importing the data for the Italian League seasons 2008-2016#####
data_ITL09 &lt;- read.xlsx(&quot;Italy_League_season_2008-09.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Season_2008-09&quot;, header = TRUE)
data_ITL10 &lt;- read.xlsx(&quot;Italy_League_season_2009-10.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Season_2009-10&quot;, header = TRUE)
data_ITL11 &lt;- read.xlsx(&quot;Italy_League_season_2010-11.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Season_2010-11&quot;, header = TRUE)
data_ITL12 &lt;- read.xlsx(&quot;Italy_League_season_2011-12.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_ITL13 &lt;- read.xlsx(&quot;Italy_League_season_2012-13.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_ITL14 &lt;- read.xlsx(&quot;Italy_League_season_2013-14.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_ITL15 &lt;- read.xlsx(&quot;Italy_League_season_2014-15.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_ITL16 &lt;- read.xlsx(&quot;Italy_League_season_2015-16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)

#####Importing the data for the Spanish League seasons 2008-2016#####
data_SPL09 &lt;- read.xlsx(&quot;Spain_League_season_2008-09.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL10 &lt;- read.xlsx(&quot;Spain_League_season_2009-10.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL11 &lt;- read.xlsx(&quot;Spain_League_season_2010-11.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL12 &lt;- read.xlsx(&quot;Spain_League_season_2011-12.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL13 &lt;- read.xlsx(&quot;Spain_League_season_2012-13.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL14 &lt;- read.xlsx(&quot;Spain_League_season_2013-14.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL15 &lt;- read.xlsx(&quot;Spain_League_season_2014-15.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_SPL16 &lt;- read.xlsx(&quot;Spain_League_season_2015-16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)

#####Importing the data for the French League seasons 2008-2016#####
data_FRL09 &lt;- read.xlsx(&quot;France_League_season_2008-09.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL10 &lt;- read.xlsx(&quot;France_League_season_2009-10.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL11 &lt;- read.xlsx(&quot;France_League_season_2010-11.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL12 &lt;- read.xlsx(&quot;France_League_season_2011-12.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL13 &lt;- read.xlsx(&quot;France_League_season_2012-13.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL14 &lt;- read.xlsx(&quot;France_League_season_2013-14.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL15 &lt;- read.xlsx(&quot;France_League_season_2014-15.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_FRL16 &lt;- read.xlsx(&quot;France_League_season_2015-16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)

#####Importing the data for the Netherland League seasons 2008-2016#####
data_NTL09 &lt;- read.xlsx(&quot;Holland_League_season_2008-09.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL10 &lt;- read.xlsx(&quot;Holland_League_season_2009-10.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL11 &lt;- read.xlsx(&quot;Holland_League_season_2010-11.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL12 &lt;- read.xlsx(&quot;Holland_League_season_2011-12.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL13 &lt;- read.xlsx(&quot;Holland_League_season_2012-13.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL14 &lt;- read.xlsx(&quot;Holland_League_season_2013-14.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL15 &lt;- read.xlsx(&quot;Holland_League_season_2014-15.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_NTL16 &lt;- read.xlsx(&quot;Holland_League_season_2015-16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)

#####Importing the data for the Greek League seasons 2008-2016#####
data_GRL09 &lt;- read.xlsx(&quot;Greece_League_season_2008-09.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL10 &lt;- read.xlsx(&quot;Greece_League_season_2009-10.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL11 &lt;- read.xlsx(&quot;Greece_League_season_2010-11.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL12 &lt;- read.xlsx(&quot;Greece_League_season_2011-12.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL13 &lt;- read.xlsx(&quot;Greece_League_season_2012-13.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL14 &lt;- read.xlsx(&quot;Greece_League_season_2013-14.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL15 &lt;- read.xlsx(&quot;Greece_League_season_2014-15.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
data_GRL16 &lt;- read.xlsx(&quot;Greece_League_season_2015-16.xlsx&quot;, encoding = &quot;UTF-08&quot;, sheetName = &quot;Sheet1&quot;, header = TRUE)
</code></pre>

<pre><code class="r">####Simple Cap function capitalizes the first letter of each world
simpleCap &lt;- function(x) {
  s &lt;- strsplit(x, &quot; &quot;)[[1]]
  paste(toupper(substring(s, 1,1)), substring(s, 2),
        sep=&quot;&quot;, collapse=&quot; &quot;)
}

###Alltrim function removes leading and ending spaces
alltrim &lt;- function (x) gsub(&quot;^\\s+|\\s+$&quot;, &quot;&quot;, x)


#####Manipulating the names of the teams in all imported data of English PRemier League in order to have the same taxonomy with previous seasons#####
library(dplyr)
</code></pre>

<pre><code class="r">head(data_1)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   23    11    4     78-37     80
## 2     2           Chelsea    38   21     8    9     69-33     71
## 3     3   Manchester City    38   21     8    9     60-33     71
## 4     4           Arsenal    38   19    11    8     72-43     68
## 5     5 Tottenham Hotspur    38   16    14    8     55-46     62
## 6     6         Liverpool    38   17     7   14     59-44     58
</code></pre>

<pre><code class="r">data_1$Team2 &lt;-  tolower(data_1$Team)


data_1$Team3 &lt;- sapply(data_1$Team2, simpleCap)

data_1$Team4 &lt;- as.factor(data_1$Team3)

data_1$Team5 &lt;- alltrim(data_1$Team4)
head(data_1)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   23    11    4     78-37     80
## 2     2           Chelsea    38   21     8    9     69-33     71
## 3     3   Manchester City    38   21     8    9     60-33     71
## 4     4           Arsenal    38   19    11    8     72-43     68
## 5     5 Tottenham Hotspur    38   16    14    8     55-46     62
## 6     6         Liverpool    38   17     7   14     59-44     58
##               Team2             Team3             Team4             Team5
## 1 manchester united Manchester United Manchester United Manchester United
## 2           chelsea           Chelsea           Chelsea           Chelsea
## 3   manchester city   Manchester City   Manchester City   Manchester City
## 4           arsenal           Arsenal           Arsenal           Arsenal
## 5 tottenham hotspur Tottenham Hotspur Tottenham Hotspur Tottenham Hotspur
## 6         liverpool         Liverpool         Liverpool         Liverpool
</code></pre>

<pre><code class="r">data_1$Team5 &lt;-as.character(data_1$Team4)
rownames(data_1) &lt;- 1:nrow(data_1)

match(data_1$Teams, data_1$Team5)
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
</code></pre>

<pre><code class="r">nchar(data_1$Team5[1])
</code></pre>

<pre><code>## [1] 17
</code></pre>

<pre><code class="r">data_1$Teams2 &lt;- as.character(data_1$Teams)
data_1$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester United&quot; &quot;Chelsea&quot;
</code></pre>

<pre><code class="r">data_1$Teams2 &lt;- alltrim(data_1$Teams2)
data_1$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester United&quot; &quot;Chelsea&quot;
</code></pre>

<pre><code class="r">names(data_1)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;Team2&quot;     &quot;Team3&quot;    
## [11] &quot;Team4&quot;     &quot;Team5&quot;     &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_1 &lt;- data_1[c(1, 12, 3:8)]

str(data_1)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5    : chr  &quot;Manchester United&quot; &quot;Chelsea&quot; &quot;Manchester City&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  23 21 21 19 16 17 13 11 12 12 ...
##  $ Draws    : int  11 8 8 11 14 7 15 16 12 11 ...
##  $ Loss     : int  4 9 9 8 8 14 10 11 14 15 ...
##  $ Aggregate: Factor w/ 20 levels &quot;37-58&quot;,&quot;40-61&quot;,..: 20 18 17 19 12 16 10 9 8 4 ...
##  $ Points   : int  80 71 71 68 62 58 54 49 48 47 ...
</code></pre>

<pre><code class="r">head(data_1)
</code></pre>

<pre><code>##   Index             Team5 Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   23    11    4     78-37     80
## 2     2           Chelsea    38   21     8    9     69-33     71
## 3     3   Manchester City    38   21     8    9     60-33     71
## 4     4           Arsenal    38   19    11    8     72-43     68
## 5     5 Tottenham Hotspur    38   16    14    8     55-46     62
## 6     6         Liverpool    38   17     7   14     59-44     58
</code></pre>

<pre><code class="r">names(data_1)[2] &lt;-&quot;Teams&quot;
head(data_1)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   23    11    4     78-37     80
## 2     2           Chelsea    38   21     8    9     69-33     71
## 3     3   Manchester City    38   21     8    9     60-33     71
## 4     4           Arsenal    38   19    11    8     72-43     68
## 5     5 Tottenham Hotspur    38   16    14    8     55-46     62
## 6     6         Liverpool    38   17     7   14     59-44     58
</code></pre>

<pre><code class="r">match(data_1$Teams, data_2$Teams)
</code></pre>

<pre><code>##  [1]  2  6  1  3  4  8  7  9 16 13 10  5 14 18 19 15 20 NA NA NA
</code></pre>

<pre><code class="r">#####Manipulating imported data (data_2) in order to have the same taxonomy with previous seasons#####

library(dplyr)

head(data_2)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   28     5    5     93-29     89
## 2     2 Manchester United    38   28     5    5     89-33     89
## 3     3           Arsenal    38   21     7   10     74-49     70
## 4     4 Tottenham Hotspur    38   20     9    9     66-41     69
## 5     5  Newcastle United    38   19     8   11     56-51     65
## 6     6           Chelsea    38   18    10   10     65-46     64
</code></pre>

<pre><code class="r">data_2$Team2 &lt;-  tolower(data_2$Team)


data_2$Team3 &lt;- sapply(data_2$Team2, simpleCap)

data_2$Team4 &lt;- as.factor(data_2$Team3)

data_2$Team5 &lt;- alltrim(data_2$Team4)
head(data_2)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   28     5    5     93-29     89
## 2     2 Manchester United    38   28     5    5     89-33     89
## 3     3           Arsenal    38   21     7   10     74-49     70
## 4     4 Tottenham Hotspur    38   20     9    9     66-41     69
## 5     5  Newcastle United    38   19     8   11     56-51     65
## 6     6           Chelsea    38   18    10   10     65-46     64
##               Team2             Team3             Team4             Team5
## 1   manchester city   Manchester City   Manchester City   Manchester City
## 2 manchester united Manchester United Manchester United Manchester United
## 3           arsenal           Arsenal           Arsenal           Arsenal
## 4 tottenham hotspur Tottenham Hotspur Tottenham Hotspur Tottenham Hotspur
## 5  newcastle united  Newcastle United  Newcastle United  Newcastle United
## 6           chelsea           Chelsea           Chelsea           Chelsea
</code></pre>

<pre><code class="r">data_2$Team5 &lt;-as.character(data_2$Team4)
rownames(data_2) &lt;- 1:nrow(data_2)

match(data_2$Teams, data_2$Team5)
</code></pre>

<pre><code>##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
</code></pre>

<pre><code class="r">nchar(data_2$Team5[1])
</code></pre>

<pre><code>## [1] 15
</code></pre>

<pre><code class="r">data_2$Teams2 &lt;- as.character(data_2$Teams)
data_2$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester City&quot;   &quot;Manchester United&quot;
</code></pre>

<pre><code class="r">data_2$Teams2 &lt;- alltrim(data_2$Teams2)
data_2$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester City&quot;   &quot;Manchester United&quot;
</code></pre>

<pre><code class="r">names(data_2)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;Team2&quot;     &quot;Team3&quot;    
## [11] &quot;Team4&quot;     &quot;Team5&quot;     &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_2 &lt;- data_2[c(1, 12, 3:8)]

str(data_2)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5    : chr  &quot;Manchester City&quot; &quot;Manchester United&quot; &quot;Arsenal&quot; &quot;Tottenham Hotspur&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 28 21 20 19 18 15 14 14 13 ...
##  $ Draws    : int  5 5 7 9 8 10 11 10 10 8 ...
##  $ Loss     : int  5 5 10 9 11 10 12 14 14 17 ...
##  $ Aggregate: Factor w/ 20 levels &quot;36-53&quot;,&quot;37-53&quot;,..: 20 19 18 17 15 16 13 10 11 8 ...
##  $ Points   : int  89 89 70 69 65 64 56 52 52 47 ...
</code></pre>

<pre><code class="r">head(data_2)
</code></pre>

<pre><code>##   Index             Team5 Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   28     5    5     93-29     89
## 2     2 Manchester United    38   28     5    5     89-33     89
## 3     3           Arsenal    38   21     7   10     74-49     70
## 4     4 Tottenham Hotspur    38   20     9    9     66-41     69
## 5     5  Newcastle United    38   19     8   11     56-51     65
## 6     6           Chelsea    38   18    10   10     65-46     64
</code></pre>

<pre><code class="r">names(data_2)[2] &lt;-&quot;Teams&quot;
head(data_2)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   28     5    5     93-29     89
## 2     2 Manchester United    38   28     5    5     89-33     89
## 3     3           Arsenal    38   21     7   10     74-49     70
## 4     4 Tottenham Hotspur    38   20     9    9     66-41     69
## 5     5  Newcastle United    38   19     8   11     56-51     65
## 6     6           Chelsea    38   18    10   10     65-46     64
</code></pre>

<pre><code class="r">match(data_2$Teams, data_3$Teams)
</code></pre>

<pre><code>##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">str(data_2)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester City&quot; &quot;Manchester United&quot; &quot;Arsenal&quot; &quot;Tottenham Hotspur&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 28 21 20 19 18 15 14 14 13 ...
##  $ Draws    : int  5 5 7 9 8 10 11 10 10 8 ...
##  $ Loss     : int  5 5 10 9 11 10 12 14 14 17 ...
##  $ Aggregate: Factor w/ 20 levels &quot;36-53&quot;,&quot;37-53&quot;,..: 20 19 18 17 15 16 13 10 11 8 ...
##  $ Points   : int  89 89 70 69 65 64 56 52 52 47 ...
</code></pre>

<pre><code class="r">#####Manipulating imported data (data_3) in order to have the same taxonomy with previous seasons#####

head(data_3)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1  Manchester United    38   28     5    5     86-43     89 NA  NA
## 2     2    Manchester City    38   23     9    6     66-34     78 NA  NA
## 3     3            Chelsea    38   22     9    7     75-39     75 NA  NA
## 4     4            Arsenal    38   21    10    7     72-37     73 NA  NA
## 5     5  Tottenham Hotspur    38   21     9    8     66-46     72 NA  NA
## 6     6            Everton    38   16    15    7     55-40     63 NA  NA
##   X.2 X.3 X.4                          X.5 X.6
## 1  NA  NA  NA English Premier League 2012/  13
## 2  NA  NA  NA                               NA
## 3  NA  NA  NA                               NA
## 4  NA  NA  NA                               NA
## 5  NA  NA  NA                               NA
## 6  NA  NA  NA                               NA
</code></pre>

<pre><code class="r">data_3$Team2 &lt;-  tolower(data_3$Teams)


data_3$Team3 &lt;- sapply(data_3$Team2, simpleCap)

data_3$Team4 &lt;- as.factor(data_3$Team3)

data_3$Team5 &lt;- alltrim(data_3$Team4)
head(data_3)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1  Manchester United    38   28     5    5     86-43     89 NA  NA
## 2     2    Manchester City    38   23     9    6     66-34     78 NA  NA
## 3     3            Chelsea    38   22     9    7     75-39     75 NA  NA
## 4     4            Arsenal    38   21    10    7     72-37     73 NA  NA
## 5     5  Tottenham Hotspur    38   21     9    8     66-46     72 NA  NA
## 6     6            Everton    38   16    15    7     55-40     63 NA  NA
##   X.2 X.3 X.4                          X.5 X.6              Team2
## 1  NA  NA  NA English Premier League 2012/  13  manchester united
## 2  NA  NA  NA                               NA    manchester city
## 3  NA  NA  NA                               NA            chelsea
## 4  NA  NA  NA                               NA            arsenal
## 5  NA  NA  NA                               NA  tottenham hotspur
## 6  NA  NA  NA                               NA            everton
##                Team3              Team4             Team5
## 1  Manchester United  Manchester United Manchester United
## 2    Manchester City    Manchester City   Manchester City
## 3            Chelsea            Chelsea           Chelsea
## 4            Arsenal            Arsenal           Arsenal
## 5  Tottenham Hotspur  Tottenham Hotspur Tottenham Hotspur
## 6            Everton            Everton           Everton
</code></pre>

<pre><code class="r">data_3$Team5 &lt;-as.character(data_3$Team4)
rownames(data_3) &lt;- 1:nrow(data_3)

match(data_3$Teams, data_2$Teams)
</code></pre>

<pre><code>##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">data_3$Teams2 &lt;- as.character(data_3$Teams)
data_3$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot; Manchester United&quot; &quot; Manchester City&quot;
</code></pre>

<pre><code class="r">data_3$Teams2 &lt;- alltrim(data_3$Teams2)
data_3$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester United&quot; &quot;Manchester City&quot;
</code></pre>

<pre><code class="r">names(data_3)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;X&quot;         &quot;X.1&quot;      
## [11] &quot;X.2&quot;       &quot;X.3&quot;       &quot;X.4&quot;       &quot;X.5&quot;       &quot;X.6&quot;      
## [16] &quot;Team2&quot;     &quot;Team3&quot;     &quot;Team4&quot;     &quot;Team5&quot;     &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_3 &lt;- data_3[c(1, 20, 3:8)]

str(data_3)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams2   : chr  &quot;Manchester United&quot; &quot;Manchester City&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 23 22 21 21 16 16 14 11 12 ...
##  $ Draws    : int  5 9 9 10 9 15 13 7 13 10 ...
##  $ Loss     : int  5 6 7 7 8 7 9 17 14 16 ...
##  $ Aggregate: Factor w/ 20 levels &quot;30-60&quot;,&quot;34-45&quot;,..: 20 15 19 18 16 14 17 13 8 6 ...
##  $ Points   : int  89 78 75 73 72 63 61 49 46 46 ...
</code></pre>

<pre><code class="r">head(data_3)
</code></pre>

<pre><code>##   Index            Teams2 Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     5    5     86-43     89
## 2     2   Manchester City    38   23     9    6     66-34     78
## 3     3           Chelsea    38   22     9    7     75-39     75
## 4     4           Arsenal    38   21    10    7     72-37     73
## 5     5 Tottenham Hotspur    38   21     9    8     66-46     72
## 6     6           Everton    38   16    15    7     55-40     63
</code></pre>

<pre><code class="r">names(data_3)[2] &lt;-&quot;Teams&quot;
head(data_3)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     5    5     86-43     89
## 2     2   Manchester City    38   23     9    6     66-34     78
## 3     3           Chelsea    38   22     9    7     75-39     75
## 4     4           Arsenal    38   21    10    7     72-37     73
## 5     5 Tottenham Hotspur    38   21     9    8     66-46     72
## 6     6           Everton    38   16    15    7     55-40     63
</code></pre>

<pre><code class="r">match(data_2$Teams, data_3$Teams)
</code></pre>

<pre><code>##  [1]  2  1  4  5 16  3  6  7 12  8  9 11 17 13 18 15 20 NA NA NA
</code></pre>

<pre><code class="r">str(data_3)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester United&quot; &quot;Manchester City&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 23 22 21 21 16 16 14 11 12 ...
##  $ Draws    : int  5 9 9 10 9 15 13 7 13 10 ...
##  $ Loss     : int  5 6 7 7 8 7 9 17 14 16 ...
##  $ Aggregate: Factor w/ 20 levels &quot;30-60&quot;,&quot;34-45&quot;,..: 20 15 19 18 16 14 17 13 8 6 ...
##  $ Points   : int  89 78 75 73 72 63 61 49 46 46 ...
</code></pre>

<pre><code class="r">#####Manipulating imported data (data_4) in order to have the same taxonomy with previous seasons#####

head(data_4)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1    Manchester City    38   27     5    6    102-37     86 NA  NA
## 2     2          Liverpool    38   26     6    6    101-50     84 NA  NA
## 3     3            Chelsea    38   25     7    6     71-27     82 NA  NA
## 4     4            Arsenal    38   24     7    7     68-41     79 NA  NA
## 5     5            Everton    38   21     9    8     61-39     72 NA  NA
## 6     6  Tottenham Hotspur    38   21     6   11     55-51     69 NA  NA
##   X.2 X.3                    X.4   X.5 X.6
## 1  NA  NA English Premier League 2013/  14
## 2  NA  NA                               NA
## 3  NA  NA                               NA
## 4  NA  NA                               NA
## 5  NA  NA                               NA
## 6  NA  NA                               NA
</code></pre>

<pre><code class="r">data_4$Team2 &lt;-  tolower(data_4$Teams)


data_4$Team3 &lt;- sapply(data_4$Team2, simpleCap)

data_4$Team4 &lt;- as.factor(data_4$Team3)

data_4$Team5 &lt;- alltrim(data_4$Team4)
head(data_4)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1    Manchester City    38   27     5    6    102-37     86 NA  NA
## 2     2          Liverpool    38   26     6    6    101-50     84 NA  NA
## 3     3            Chelsea    38   25     7    6     71-27     82 NA  NA
## 4     4            Arsenal    38   24     7    7     68-41     79 NA  NA
## 5     5            Everton    38   21     9    8     61-39     72 NA  NA
## 6     6  Tottenham Hotspur    38   21     6   11     55-51     69 NA  NA
##   X.2 X.3                    X.4   X.5 X.6              Team2
## 1  NA  NA English Premier League 2013/  14    manchester city
## 2  NA  NA                               NA          liverpool
## 3  NA  NA                               NA            chelsea
## 4  NA  NA                               NA            arsenal
## 5  NA  NA                               NA            everton
## 6  NA  NA                               NA  tottenham hotspur
##                Team3              Team4             Team5
## 1    Manchester City    Manchester City   Manchester City
## 2          Liverpool          Liverpool         Liverpool
## 3            Chelsea            Chelsea           Chelsea
## 4            Arsenal            Arsenal           Arsenal
## 5            Everton            Everton           Everton
## 6  Tottenham Hotspur  Tottenham Hotspur Tottenham Hotspur
</code></pre>

<pre><code class="r">data_4$Team5 &lt;-as.character(data_4$Team4)
rownames(data_4) &lt;- 1:nrow(data_4)

match(data_4$Teams, data_3$Teams)
</code></pre>

<pre><code>##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">data_4$Teams2 &lt;- as.character(data_4$Teams)
data_4$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot; Manchester City&quot; &quot; Liverpool&quot;
</code></pre>

<pre><code class="r">data_4$Teams2 &lt;- alltrim(data_4$Teams2)
data_4$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester City&quot; &quot;Liverpool&quot;
</code></pre>

<pre><code class="r">names(data_4)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;X&quot;         &quot;X.1&quot;      
## [11] &quot;X.2&quot;       &quot;X.3&quot;       &quot;X.4&quot;       &quot;X.5&quot;       &quot;X.6&quot;      
## [16] &quot;Team2&quot;     &quot;Team3&quot;     &quot;Team4&quot;     &quot;Team5&quot;     &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_4 &lt;- data_4[c(1, 20, 3:8)]

str(data_4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams2   : chr  &quot;Manchester City&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  27 26 25 24 21 21 19 15 13 15 ...
##  $ Draws    : int  5 6 7 7 9 6 7 11 11 4 ...
##  $ Loss     : int  6 6 6 7 8 11 12 12 14 19 ...
##  $ Aggregate: Factor w/ 19 levels &quot;101-50&quot;,&quot;102-37&quot;,..: 2 1 19 18 16 15 17 13 12 11 ...
##  $ Points   : int  86 84 82 79 72 69 64 56 50 49 ...
</code></pre>

<pre><code class="r">head(data_4)
</code></pre>

<pre><code>##   Index            Teams2 Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   27     5    6    102-37     86
## 2     2         Liverpool    38   26     6    6    101-50     84
## 3     3           Chelsea    38   25     7    6     71-27     82
## 4     4           Arsenal    38   24     7    7     68-41     79
## 5     5           Everton    38   21     9    8     61-39     72
## 6     6 Tottenham Hotspur    38   21     6   11     55-51     69
</code></pre>

<pre><code class="r">names(data_4)[2] &lt;-&quot;Teams&quot;
head(data_4)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   27     5    6    102-37     86
## 2     2         Liverpool    38   26     6    6    101-50     84
## 3     3           Chelsea    38   25     7    6     71-27     82
## 4     4           Arsenal    38   24     7    7     68-41     79
## 5     5           Everton    38   21     9    8     61-39     72
## 6     6 Tottenham Hotspur    38   21     6   11     55-51     69
</code></pre>

<pre><code class="r">match(data_4$Teams, data_3$Teams)
</code></pre>

<pre><code>##  [1]  2  7  3  4  6  5  1 14 13 16 NA  9 10 17 15 NA NA 11 12 NA
</code></pre>

<pre><code class="r">str(data_4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester City&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  27 26 25 24 21 21 19 15 13 15 ...
##  $ Draws    : int  5 6 7 7 9 6 7 11 11 4 ...
##  $ Loss     : int  6 6 6 7 8 11 12 12 14 19 ...
##  $ Aggregate: Factor w/ 19 levels &quot;101-50&quot;,&quot;102-37&quot;,..: 2 1 19 18 16 15 17 13 12 11 ...
##  $ Points   : int  86 84 82 79 72 69 64 56 50 49 ...
</code></pre>

<pre><code class="r">match(data_4$Teams, data_3$Teams)
</code></pre>

<pre><code>##  [1]  2  7  3  4  6  5  1 14 13 16 NA  9 10 17 15 NA NA 11 12 NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(data_3$Teams, data_4$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Manchester United&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Manchester City&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)
</code></pre>

<pre><code class="r">#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.7647059 1.0000000 0.2000000 0.1333333 0.1176471
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1            Var2  Distance
## 1 Manchester United Manchester City 0.7647059
## 2   Manchester City Manchester City 1.0000000
## 3           Chelsea Manchester City 0.2000000
## 4           Arsenal Manchester City 0.1333333
## 5 Tottenham Hotspur Manchester City 0.1176471
## 6           Everton Manchester City 0.1333333
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 29
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the team which have to change due to taxonomy is###
###West Bromwich Albi###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                 Var1            Var2  Distance
## 1  Manchester United Manchester City 0.7647059
## 2    Manchester City Manchester City 1.0000000
## 9       Swansea City Manchester City 0.5333333
## 27         Liverpool       Liverpool 1.0000000
## 43           Chelsea         Chelsea 1.0000000
## 64           Arsenal         Arsenal 1.0000000
</code></pre>

<pre><code class="r">head(data_4)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   27     5    6    102-37     86
## 2     2         Liverpool    38   26     6    6    101-50     84
## 3     3           Chelsea    38   25     7    6     71-27     82
## 4     4           Arsenal    38   24     7    7     68-41     79
## 5     5           Everton    38   21     9    8     61-39     72
## 6     6 Tottenham Hotspur    38   21     6   11     55-51     69
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the previous seasons####
head(data_3)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     5    5     86-43     89
## 2     2   Manchester City    38   23     9    6     66-34     78
## 3     3           Chelsea    38   22     9    7     75-39     75
## 4     4           Arsenal    38   21    10    7     72-37     73
## 5     5 Tottenham Hotspur    38   21     9    8     66-46     72
## 6     6           Everton    38   16    15    7     55-40     63
</code></pre>

<pre><code class="r">head(data_4)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   27     5    6    102-37     86
## 2     2         Liverpool    38   26     6    6    101-50     84
## 3     3           Chelsea    38   25     7    6     71-27     82
## 4     4           Arsenal    38   24     7    7     68-41     79
## 5     5           Everton    38   21     9    8     61-39     72
## 6     6 Tottenham Hotspur    38   21     6   11     55-51     69
</code></pre>

<pre><code class="r">head(matches2)
</code></pre>

<pre><code>##                 Var1            Var2  Distance
## 1  Manchester United Manchester City 0.7647059
## 2    Manchester City Manchester City 1.0000000
## 9       Swansea City Manchester City 0.5333333
## 27         Liverpool       Liverpool 1.0000000
## 43           Chelsea         Chelsea 1.0000000
## 64           Arsenal         Arsenal 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                    Var1               Var2  Distance
## 2       Manchester City    Manchester City 1.0000000
## 4             Liverpool          Liverpool 1.0000000
## 5               Chelsea            Chelsea 1.0000000
## 6               Arsenal            Arsenal 1.0000000
## 7               Everton            Everton 1.0000000
## 8     Tottenham Hotspur  Tottenham Hotspur 1.0000000
## 9     Manchester United  Manchester United 1.0000000
## 12          Southampton        Southampton 1.0000000
## 14           Stoke City         Stoke City 1.0000000
## 17     Newcastle United   Newcastle United 1.0000000
## 19         Swansea City       Swansea City 1.0000000
## 21      West Ham United    West Ham United 1.0000000
## 23           Sunderland         Sunderland 1.0000000
## 24          Aston Villa        Aston Villa 1.0000000
## 27         Norwich City       Norwich City 1.0000000
## 28               Fulham             Fulham 1.0000000
## 26 West Bromwich Albion West Bromwich Albi 0.9000000
## 1     Manchester United    Manchester City 0.7647059
## 10      Manchester City  Manchester United 0.7647059
## 11     Newcastle United  Manchester United 0.5882353
## 15    Manchester United   Newcastle United 0.5882353
## 13         Swansea City         Stoke City 0.5833333
## 20           Stoke City       Swansea City 0.5833333
## 29         Norwich City       Cardiff City 0.5833333
## 3          Swansea City    Manchester City 0.5333333
## 18      Manchester City       Swansea City 0.5333333
## 16      West Ham United   Newcastle United 0.5000000
## 22     Newcastle United    West Ham United 0.5000000
## 25           Stoke City          Hull City 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
data_4$Teams[data_4$Teams == &quot;West Bromwich Albi&quot;] &lt;- data_3$Teams[8]

head(data_4)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1   Manchester City    38   27     5    6    102-37     86
## 2     2         Liverpool    38   26     6    6    101-50     84
## 3     3           Chelsea    38   25     7    6     71-27     82
## 4     4           Arsenal    38   24     7    7     68-41     79
## 5     5           Everton    38   21     9    8     61-39     72
## 6     6 Tottenham Hotspur    38   21     6   11     55-51     69
</code></pre>

<pre><code class="r">str(data_4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester City&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  27 26 25 24 21 21 19 15 13 15 ...
##  $ Draws    : int  5 6 7 7 9 6 7 11 11 4 ...
##  $ Loss     : int  6 6 6 7 8 11 12 12 14 19 ...
##  $ Aggregate: Factor w/ 19 levels &quot;101-50&quot;,&quot;102-37&quot;,..: 2 1 19 18 16 15 17 13 12 11 ...
##  $ Points   : int  86 84 82 79 72 69 64 56 50 49 ...
</code></pre>

<pre><code class="r">data_4[ ,c(3:6)] &lt;- apply(data_4[ ,c(3:6)], 2, as.numeric)
match(data_4$Teams, data_3$Teams)
</code></pre>

<pre><code>##  [1]  2  7  3  4  6  5  1 14 13 16 NA  9 10 17 15 NA  8 11 12 NA
</code></pre>

<pre><code class="r">#####Manipulating imported data (data_5) in order to have the same taxonomy with previous seasons#####

head(data_5)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1            Chelsea    38   26     9    3     73-32     87 NA  NA
## 2     2    Manchester City    38   24     7    7     83-38     79 NA  NA
## 3     3            Arsenal    38   22     9    7     71-36     75 NA  NA
## 4     4  Manchester United    38   20    10    8     62-37     70 NA  NA
## 5     5  Tottenham Hotspur    38   19     7   12     58-53     64 NA  NA
## 6     6          Liverpool    38   18     8   12     52-48     62 NA  NA
##   X.2 X.3 X.4                          X.5 X.6 X.7
## 1  NA  NA  NA English Premier League 2014/  15  NA
## 2  NA  NA  NA                               NA  NA
## 3  NA  NA  NA                               NA  NA
## 4  NA  NA  NA                               NA  NA
## 5  NA  NA  NA                               NA  NA
## 6  NA  NA  NA                               NA  NA
</code></pre>

<pre><code class="r">data_5$Team2 &lt;-  tolower(data_5$Teams)


data_5$Team3 &lt;- sapply(data_5$Team2, simpleCap)

data_5$Team4 &lt;- as.factor(data_5$Team3)

data_5$Team5 &lt;- alltrim(data_5$Team4)
head(data_5)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1            Chelsea    38   26     9    3     73-32     87 NA  NA
## 2     2    Manchester City    38   24     7    7     83-38     79 NA  NA
## 3     3            Arsenal    38   22     9    7     71-36     75 NA  NA
## 4     4  Manchester United    38   20    10    8     62-37     70 NA  NA
## 5     5  Tottenham Hotspur    38   19     7   12     58-53     64 NA  NA
## 6     6          Liverpool    38   18     8   12     52-48     62 NA  NA
##   X.2 X.3 X.4                          X.5 X.6 X.7              Team2
## 1  NA  NA  NA English Premier League 2014/  15  NA            chelsea
## 2  NA  NA  NA                               NA  NA    manchester city
## 3  NA  NA  NA                               NA  NA            arsenal
## 4  NA  NA  NA                               NA  NA  manchester united
## 5  NA  NA  NA                               NA  NA  tottenham hotspur
## 6  NA  NA  NA                               NA  NA          liverpool
##                Team3              Team4             Team5
## 1            Chelsea            Chelsea           Chelsea
## 2    Manchester City    Manchester City   Manchester City
## 3            Arsenal            Arsenal           Arsenal
## 4  Manchester United  Manchester United Manchester United
## 5  Tottenham Hotspur  Tottenham Hotspur Tottenham Hotspur
## 6          Liverpool          Liverpool         Liverpool
</code></pre>

<pre><code class="r">data_5$Team5 &lt;-as.character(data_5$Team4)
rownames(data_5) &lt;- 1:nrow(data_5)

match(data_5$Teams, data_4$Teams)
</code></pre>

<pre><code>##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">data_5$Teams2 &lt;- as.character(data_5$Teams)
data_5$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot; Chelsea&quot;         &quot; Manchester City&quot;
</code></pre>

<pre><code class="r">data_5$Teams2 &lt;- alltrim(data_5$Teams2)
data_5$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Chelsea&quot;         &quot;Manchester City&quot;
</code></pre>

<pre><code class="r">names(data_5)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;X&quot;         &quot;X.1&quot;      
## [11] &quot;X.2&quot;       &quot;X.3&quot;       &quot;X.4&quot;       &quot;X.5&quot;       &quot;X.6&quot;      
## [16] &quot;X.7&quot;       &quot;Team2&quot;     &quot;Team3&quot;     &quot;Team4&quot;     &quot;Team5&quot;    
## [21] &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_5 &lt;- data_5[c(1, 21, 3:8)]

str(data_5)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams2   : chr  &quot;Chelsea&quot; &quot;Manchester City&quot; &quot;Arsenal&quot; &quot;Manchester United&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  26 24 22 20 19 18 18 16 15 13 ...
##  $ Draws    : int  9 7 9 10 7 8 6 8 9 9 ...
##  $ Loss     : int  3 7 7 8 12 12 14 14 14 16 ...
##  $ Aggregate: Factor w/ 20 levels &quot;28-53&quot;,&quot;31-53&quot;,..: 19 20 18 17 16 14 15 9 12 11 ...
##  $ Points   : int  87 79 75 70 64 62 60 56 54 48 ...
</code></pre>

<pre><code class="r">head(data_5)
</code></pre>

<pre><code>##   Index            Teams2 Games Wins Draws Loss Aggregate Points
## 1     1           Chelsea    38   26     9    3     73-32     87
## 2     2   Manchester City    38   24     7    7     83-38     79
## 3     3           Arsenal    38   22     9    7     71-36     75
## 4     4 Manchester United    38   20    10    8     62-37     70
## 5     5 Tottenham Hotspur    38   19     7   12     58-53     64
## 6     6         Liverpool    38   18     8   12     52-48     62
</code></pre>

<pre><code class="r">names(data_5)[2] &lt;-&quot;Teams&quot;
head(data_5)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1           Chelsea    38   26     9    3     73-32     87
## 2     2   Manchester City    38   24     7    7     83-38     79
## 3     3           Arsenal    38   22     9    7     71-36     75
## 4     4 Manchester United    38   20    10    8     62-37     70
## 5     5 Tottenham Hotspur    38   19     7   12     58-53     64
## 6     6         Liverpool    38   18     8   12     52-48     62
</code></pre>

<pre><code class="r">match(data_4$Teams, data_5$Teams)
</code></pre>

<pre><code>##  [1]  2  6  1  3 11  5  4  7  9 15 10  8 12 16 17 18 13 NA NA NA
</code></pre>

<pre><code class="r">str(data_5)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Chelsea&quot; &quot;Manchester City&quot; &quot;Arsenal&quot; &quot;Manchester United&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  26 24 22 20 19 18 18 16 15 13 ...
##  $ Draws    : int  9 7 9 10 7 8 6 8 9 9 ...
##  $ Loss     : int  3 7 7 8 12 12 14 14 14 16 ...
##  $ Aggregate: Factor w/ 20 levels &quot;28-53&quot;,&quot;31-53&quot;,..: 19 20 18 17 16 14 15 9 12 11 ...
##  $ Points   : int  87 79 75 70 64 62 60 56 54 48 ...
</code></pre>

<pre><code class="r">str(data_4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester City&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : num  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : num  27 26 25 24 21 21 19 15 13 15 ...
##  $ Draws    : num  5 6 7 7 9 6 7 11 11 4 ...
##  $ Loss     : num  6 6 6 7 8 11 12 12 14 19 ...
##  $ Aggregate: Factor w/ 19 levels &quot;101-50&quot;,&quot;102-37&quot;,..: 2 1 19 18 16 15 17 13 12 11 ...
##  $ Points   : int  86 84 82 79 72 69 64 56 50 49 ...
</code></pre>

<pre><code class="r">match(data_5$Teams, data_4$Teams)
</code></pre>

<pre><code>##  [1]  3  1  4  7  6  2  8 12  9 11  5 13 17 NA 10 14 15 16 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(data_4$Teams, data_5$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Manchester City&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Chelsea&quot;,&quot;Manchester City&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)
</code></pre>

<pre><code class="r">#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.2000000 0.1111111 1.0000000 0.1428571 0.1428571
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1    Var2  Distance
## 1   Manchester City Chelsea 0.2000000
## 2         Liverpool Chelsea 0.1111111
## 3           Chelsea Chelsea 1.0000000
## 4           Arsenal Chelsea 0.1428571
## 5           Everton Chelsea 0.1428571
## 6 Tottenham Hotspur Chelsea 0.1176471
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.7))
</code></pre>

<pre><code>## [1] 20
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.7)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.7, drop = TRUE)

head(matches2)
</code></pre>

<pre><code>##                 Var1              Var2  Distance
## 3            Chelsea           Chelsea 1.0000000
## 21   Manchester City   Manchester City 1.0000000
## 27 Manchester United   Manchester City 0.7647059
## 44           Arsenal           Arsenal 1.0000000
## 61   Manchester City Manchester United 0.7647059
## 67 Manchester United Manchester United 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                    Var1                 Var2  Distance
## 1               Chelsea              Chelsea 1.0000000
## 2       Manchester City      Manchester City 1.0000000
## 4               Arsenal              Arsenal 1.0000000
## 6     Manchester United    Manchester United 1.0000000
## 7     Tottenham Hotspur    Tottenham Hotspur 1.0000000
## 8             Liverpool            Liverpool 1.0000000
## 9           Southampton          Southampton 1.0000000
## 10         Swansea City         Swansea City 1.0000000
## 11           Stoke City           Stoke City 1.0000000
## 12       Crystal Palace       Crystal Palace 1.0000000
## 13              Everton              Everton 1.0000000
## 14      West Ham United      West Ham United 1.0000000
## 15 West Bromwich Albion West Bromwich Albion 1.0000000
## 17     Newcastle United     Newcastle United 1.0000000
## 18           Sunderland           Sunderland 1.0000000
## 19          Aston Villa          Aston Villa 1.0000000
## 20            Hull City            Hull City 1.0000000
## 3     Manchester United      Manchester City 0.7647059
## 5       Manchester City    Manchester United 0.7647059
## 16      Manchester City       Leicester City 0.7333333
</code></pre>

<pre><code class="r">#####Changing the names#####
data_5$Teams[data_5$Teams == &quot;West Bromwich Albi&quot;] &lt;- data_3$Teams[8]


data_5[ ,c(3:6)] &lt;- apply(data_5[ ,c(3:6)], 2, as.numeric)
str(data_5)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Chelsea&quot; &quot;Manchester City&quot; &quot;Arsenal&quot; &quot;Manchester United&quot; ...
##  $ Games    : num  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : num  26 24 22 20 19 18 18 16 15 13 ...
##  $ Draws    : num  9 7 9 10 7 8 6 8 9 9 ...
##  $ Loss     : num  3 7 7 8 12 12 14 14 14 16 ...
##  $ Aggregate: Factor w/ 20 levels &quot;28-53&quot;,&quot;31-53&quot;,..: 19 20 18 17 16 14 15 9 12 11 ...
##  $ Points   : int  87 79 75 70 64 62 60 56 54 48 ...
</code></pre>

<pre><code class="r">match(data_5$Teams, data_9$Teams)
</code></pre>

<pre><code>##  [1] 10  4  2  5  3  8  6 12  9 15 11  7 14  1 NA 17 20 18 NA NA
</code></pre>

<pre><code class="r">#####Manipulating imported data (data_6) in order to have the same taxonomy with previous seasons#####

head(data_6)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1  Manchester United    38   28     6    4     68-24     90 NA  NA
## 2     2          Liverpool    38   25    11    2     77-27     86 NA  NA
## 3     3            Chelsea    38   25     8    5     68-24     83 NA  NA
## 4     4            Arsenal    38   20    12    6     68-37     72 NA  NA
## 5     5            Everton    38   17    12    9     55-37     63 NA  NA
## 6     6        Aston Villa    38   17    11   10     54-48     62 NA  NA
##   X.2 X.3                    X.4   X.5 X.6
## 1  NA  NA English Premier League 2008/   9
## 2  NA  NA                               NA
## 3  NA  NA                               NA
## 4  NA  NA                               NA
## 5  NA  NA                               NA
## 6  NA  NA                               NA
</code></pre>

<pre><code class="r">data_6$Team2 &lt;-  tolower(data_6$Teams)


data_6$Team3 &lt;- sapply(data_6$Team2, simpleCap)

data_6$Team4 &lt;- as.factor(data_6$Team3)

data_6$Team5 &lt;- alltrim(data_6$Team4)
head(data_6)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1  Manchester United    38   28     6    4     68-24     90 NA  NA
## 2     2          Liverpool    38   25    11    2     77-27     86 NA  NA
## 3     3            Chelsea    38   25     8    5     68-24     83 NA  NA
## 4     4            Arsenal    38   20    12    6     68-37     72 NA  NA
## 5     5            Everton    38   17    12    9     55-37     63 NA  NA
## 6     6        Aston Villa    38   17    11   10     54-48     62 NA  NA
##   X.2 X.3                    X.4   X.5 X.6              Team2
## 1  NA  NA English Premier League 2008/   9  manchester united
## 2  NA  NA                               NA          liverpool
## 3  NA  NA                               NA            chelsea
## 4  NA  NA                               NA            arsenal
## 5  NA  NA                               NA            everton
## 6  NA  NA                               NA        aston villa
##                Team3              Team4             Team5
## 1  Manchester United  Manchester United Manchester United
## 2          Liverpool          Liverpool         Liverpool
## 3            Chelsea            Chelsea           Chelsea
## 4            Arsenal            Arsenal           Arsenal
## 5            Everton            Everton           Everton
## 6        Aston Villa        Aston Villa       Aston Villa
</code></pre>

<pre><code class="r">data_6$Team5 &lt;-as.character(data_6$Team4)
rownames(data_6) &lt;- 1:nrow(data_6)

match(data_6$Teams, data_1$Teams)
</code></pre>

<pre><code>##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">data_6$Teams2 &lt;- as.character(data_6$Teams)
data_6$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot; Manchester United&quot; &quot; Liverpool&quot;
</code></pre>

<pre><code class="r">data_6$Teams2 &lt;- alltrim(data_6$Teams2)
data_6$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Manchester United&quot; &quot;Liverpool&quot;
</code></pre>

<pre><code class="r">names(data_6)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;X&quot;         &quot;X.1&quot;      
## [11] &quot;X.2&quot;       &quot;X.3&quot;       &quot;X.4&quot;       &quot;X.5&quot;       &quot;X.6&quot;      
## [16] &quot;Team2&quot;     &quot;Team3&quot;     &quot;Team4&quot;     &quot;Team5&quot;     &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_6 &lt;- data_6[c(1, 20, 3:8)]

str(data_6)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams2   : chr  &quot;Manchester United&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 25 25 20 17 17 14 14 14 15 ...
##  $ Draws    : int  6 11 8 12 12 11 11 9 9 5 ...
##  $ Loss     : int  4 2 5 6 9 10 13 15 15 18 ...
##  $ Aggregate: Factor w/ 19 levels &quot;28-57&quot;,&quot;34-45&quot;,..: 17 19 17 18 15 14 7 13 12 16 ...
##  $ Points   : int  90 86 83 72 63 62 53 51 51 50 ...
</code></pre>

<pre><code class="r">head(data_6)
</code></pre>

<pre><code>##   Index            Teams2 Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     6    4     68-24     90
## 2     2         Liverpool    38   25    11    2     77-27     86
## 3     3           Chelsea    38   25     8    5     68-24     83
## 4     4           Arsenal    38   20    12    6     68-37     72
## 5     5           Everton    38   17    12    9     55-37     63
## 6     6       Aston Villa    38   17    11   10     54-48     62
</code></pre>

<pre><code class="r">names(data_6)[2] &lt;-&quot;Teams&quot;
head(data_6)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     6    4     68-24     90
## 2     2         Liverpool    38   25    11    2     77-27     86
## 3     3           Chelsea    38   25     8    5     68-24     83
## 4     4           Arsenal    38   20    12    6     68-37     72
## 5     5           Everton    38   17    12    9     55-37     63
## 6     6       Aston Villa    38   17    11   10     54-48     62
</code></pre>

<pre><code class="r">match(data_1$Teams, data_6$Teams)
</code></pre>

<pre><code>##  [1]  1  3 10  4  8  2  5  7  6 16 NA 18 12 13 15 11 NA NA NA  9
</code></pre>

<pre><code class="r">str(data_6)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester United&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 25 25 20 17 17 14 14 14 15 ...
##  $ Draws    : int  6 11 8 12 12 11 11 9 9 5 ...
##  $ Loss     : int  4 2 5 6 9 10 13 15 15 18 ...
##  $ Aggregate: Factor w/ 19 levels &quot;28-57&quot;,&quot;34-45&quot;,..: 17 19 17 18 15 14 7 13 12 16 ...
##  $ Points   : int  90 86 83 72 63 62 53 51 51 50 ...
</code></pre>

<pre><code class="r">match(data_6$Teams, data_1$Teams)
</code></pre>

<pre><code>##  [1]  1  6  2  4  7  9  8  5 20  3 16 13 14 NA 15 10 NA 12 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(data_1$Teams, data_6$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Manchester United&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Manchester United&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)
</code></pre>

<pre><code class="r">#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00000000 0.17647059 0.76470588 0.17647059 0.05882353
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1              Var2   Distance
## 1 Manchester United Manchester United 1.00000000
## 2           Chelsea Manchester United 0.17647059
## 3   Manchester City Manchester United 0.76470588
## 4           Arsenal Manchester United 0.17647059
## 5 Tottenham Hotspur Manchester United 0.05882353
## 6         Liverpool Manchester United 0.11764706
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 25
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the team which have to change due to taxonomy is###
###West Bromwich Albi###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                 Var1              Var2  Distance
## 1  Manchester United Manchester United 1.0000000
## 3    Manchester City Manchester United 0.7647059
## 12  Newcastle United Manchester United 0.5882353
## 26         Liverpool         Liverpool 1.0000000
## 42           Chelsea           Chelsea 1.0000000
## 64           Arsenal           Arsenal 1.0000000
</code></pre>

<pre><code class="r">head(data_6)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     6    4     68-24     90
## 2     2         Liverpool    38   25    11    2     77-27     86
## 3     3           Chelsea    38   25     8    5     68-24     83
## 4     4           Arsenal    38   20    12    6     68-37     72
## 5     5           Everton    38   17    12    9     55-37     63
## 6     6       Aston Villa    38   17    11   10     54-48     62
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the previous seasons####
head(data_6)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     6    4     68-24     90
## 2     2         Liverpool    38   25    11    2     77-27     86
## 3     3           Chelsea    38   25     8    5     68-24     83
## 4     4           Arsenal    38   20    12    6     68-37     72
## 5     5           Everton    38   17    12    9     55-37     63
## 6     6       Aston Villa    38   17    11   10     54-48     62
</code></pre>

<pre><code class="r">head(data_1)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   23    11    4     78-37     80
## 2     2           Chelsea    38   21     8    9     69-33     71
## 3     3   Manchester City    38   21     8    9     60-33     71
## 4     4           Arsenal    38   19    11    8     72-43     68
## 5     5 Tottenham Hotspur    38   16    14    8     55-46     62
## 6     6         Liverpool    38   17     7   14     59-44     58
</code></pre>

<pre><code class="r">head(matches2)
</code></pre>

<pre><code>##                 Var1              Var2  Distance
## 1  Manchester United Manchester United 1.0000000
## 3    Manchester City Manchester United 0.7647059
## 12  Newcastle United Manchester United 0.5882353
## 26         Liverpool         Liverpool 1.0000000
## 42           Chelsea           Chelsea 1.0000000
## 64           Arsenal           Arsenal 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                       Var1               Var2  Distance
## 1        Manchester United  Manchester United 1.0000000
## 4                Liverpool          Liverpool 1.0000000
## 5                  Chelsea            Chelsea 1.0000000
## 6                  Arsenal            Arsenal 1.0000000
## 7                  Everton            Everton 1.0000000
## 8              Aston Villa        Aston Villa 1.0000000
## 9                   Fulham             Fulham 1.0000000
## 10       Tottenham Hotspur  Tottenham Hotspur 1.0000000
## 12         West Ham United    West Ham United 1.0000000
## 14         Manchester City    Manchester City 1.0000000
## 15          Wigan Athletic     Wigan Athletic 1.0000000
## 16              Stoke City         Stoke City 1.0000000
## 17        Bolton Wanderers   Bolton Wanderers 1.0000000
## 19        Blackburn Rovers   Blackburn Rovers 1.0000000
## 20              Sunderland         Sunderland 1.0000000
## 23        Newcastle United   Newcastle United 1.0000000
## 25    West Bromwich Albion West Bromwich Albi 0.9000000
## 2          Manchester City  Manchester United 0.7647059
## 13       Manchester United    Manchester City 0.7647059
## 18 Wolverhampton Wanderers   Bolton Wanderers 0.6521739
## 3         Newcastle United  Manchester United 0.5882353
## 22       Manchester United   Newcastle United 0.5882353
## 11        Newcastle United    West Ham United 0.5000000
## 21              Stoke City          Hull City 0.5000000
## 24         West Ham United   Newcastle United 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
data_6$Teams[data_6$Teams == &quot;West Bromwich Albi&quot;] &lt;- data_3$Teams[8]

head(data_6)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1 Manchester United    38   28     6    4     68-24     90
## 2     2         Liverpool    38   25    11    2     77-27     86
## 3     3           Chelsea    38   25     8    5     68-24     83
## 4     4           Arsenal    38   20    12    6     68-37     72
## 5     5           Everton    38   17    12    9     55-37     63
## 6     6       Aston Villa    38   17    11   10     54-48     62
</code></pre>

<pre><code class="r">str(data_6)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester United&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  28 25 25 20 17 17 14 14 14 15 ...
##  $ Draws    : int  6 11 8 12 12 11 11 9 9 5 ...
##  $ Loss     : int  4 2 5 6 9 10 13 15 15 18 ...
##  $ Aggregate: Factor w/ 19 levels &quot;28-57&quot;,&quot;34-45&quot;,..: 17 19 17 18 15 14 7 13 12 16 ...
##  $ Points   : int  90 86 83 72 63 62 53 51 51 50 ...
</code></pre>

<pre><code class="r">data_6[ ,c(3:6)] &lt;- apply(data_6[ ,c(3:6)], 2, as.numeric)
match(data_6$Teams, data_1$Teams)
</code></pre>

<pre><code>##  [1]  1  6  2  4  7  9  8  5 20  3 16 13 14 NA 15 10 NA 12 NA 11
</code></pre>

<pre><code class="r">#####Manipulating imported data (data_7) in order to have the same taxonomy with previous seasons#####

head(data_7)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1            Chelsea    38   27     5    6    103-32     86 NA  NA
## 2     2  Manchester United    38   27     4    7     86-28     85 NA  NA
## 3     3            Arsenal    38   23     6    9     83-41     75 NA  NA
## 4     4  Tottenham Hotspur    38   21     7   10     67-41     70 NA  NA
## 5     5    Manchester City    38   18    13    7     73-45     67 NA  NA
## 6     6        Aston Villa    38   17    13    8     52-39     64 NA  NA
##   X.2 X.3                    X.4    X.5 X.6
## 1  NA  NA English Premier League 2009/1   0
## 2  NA  NA                                NA
## 3  NA  NA                                NA
## 4  NA  NA                                NA
## 5  NA  NA                                NA
## 6  NA  NA                                NA
</code></pre>

<pre><code class="r">data_7$Team2 &lt;-  tolower(data_7$Teams)


data_7$Team3 &lt;- sapply(data_7$Team2, simpleCap)

data_7$Team4 &lt;- as.factor(data_7$Team3)

data_7$Team5 &lt;- alltrim(data_7$Team4)
head(data_7)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points  X X.1
## 1     1            Chelsea    38   27     5    6    103-32     86 NA  NA
## 2     2  Manchester United    38   27     4    7     86-28     85 NA  NA
## 3     3            Arsenal    38   23     6    9     83-41     75 NA  NA
## 4     4  Tottenham Hotspur    38   21     7   10     67-41     70 NA  NA
## 5     5    Manchester City    38   18    13    7     73-45     67 NA  NA
## 6     6        Aston Villa    38   17    13    8     52-39     64 NA  NA
##   X.2 X.3                    X.4    X.5 X.6              Team2
## 1  NA  NA English Premier League 2009/1   0            chelsea
## 2  NA  NA                                NA  manchester united
## 3  NA  NA                                NA            arsenal
## 4  NA  NA                                NA  tottenham hotspur
## 5  NA  NA                                NA    manchester city
## 6  NA  NA                                NA        aston villa
##                Team3              Team4             Team5
## 1            Chelsea            Chelsea           Chelsea
## 2  Manchester United  Manchester United Manchester United
## 3            Arsenal            Arsenal           Arsenal
## 4  Tottenham Hotspur  Tottenham Hotspur Tottenham Hotspur
## 5    Manchester City    Manchester City   Manchester City
## 6        Aston Villa        Aston Villa       Aston Villa
</code></pre>

<pre><code class="r">data_7$Team5 &lt;-as.character(data_7$Team4)
rownames(data_7) &lt;- 1:nrow(data_7)

match(data_7$Teams, data_6$Teams)
</code></pre>

<pre><code>##  [1] NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">data_7$Teams2 &lt;- as.character(data_7$Teams)
data_7$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot; Chelsea&quot;           &quot; Manchester United&quot;
</code></pre>

<pre><code class="r">data_7$Teams2 &lt;- alltrim(data_7$Teams2)
data_7$Teams2[1:2]
</code></pre>

<pre><code>## [1] &quot;Chelsea&quot;           &quot;Manchester United&quot;
</code></pre>

<pre><code class="r">names(data_7)
</code></pre>

<pre><code>##  [1] &quot;Index&quot;     &quot;Teams&quot;     &quot;Games&quot;     &quot;Wins&quot;      &quot;Draws&quot;    
##  [6] &quot;Loss&quot;      &quot;Aggregate&quot; &quot;Points&quot;    &quot;X&quot;         &quot;X.1&quot;      
## [11] &quot;X.2&quot;       &quot;X.3&quot;       &quot;X.4&quot;       &quot;X.5&quot;       &quot;X.6&quot;      
## [16] &quot;Team2&quot;     &quot;Team3&quot;     &quot;Team4&quot;     &quot;Team5&quot;     &quot;Teams2&quot;
</code></pre>

<pre><code class="r">data_7 &lt;- data_7[c(1, 20, 3:8)]

str(data_7)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams2   : chr  &quot;Chelsea&quot; &quot;Manchester United&quot; &quot;Arsenal&quot; &quot;Tottenham Hotspur&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  27 27 23 21 18 17 18 16 13 13 ...
##  $ Draws    : int  5 4 6 7 13 13 9 13 11 11 ...
##  $ Loss     : int  6 7 9 10 7 8 11 9 14 14 ...
##  $ Aggregate: Factor w/ 20 levels &quot;103-32&quot;,&quot;32-56&quot;,..: 1 20 19 17 18 14 16 15 7 9 ...
##  $ Points   : int  86 85 75 70 67 64 63 61 50 50 ...
</code></pre>

<pre><code class="r">head(data_7)
</code></pre>

<pre><code>##   Index            Teams2 Games Wins Draws Loss Aggregate Points
## 1     1           Chelsea    38   27     5    6    103-32     86
## 2     2 Manchester United    38   27     4    7     86-28     85
## 3     3           Arsenal    38   23     6    9     83-41     75
## 4     4 Tottenham Hotspur    38   21     7   10     67-41     70
## 5     5   Manchester City    38   18    13    7     73-45     67
## 6     6       Aston Villa    38   17    13    8     52-39     64
</code></pre>

<pre><code class="r">names(data_7)[2] &lt;-&quot;Teams&quot;
head(data_7)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1           Chelsea    38   27     5    6    103-32     86
## 2     2 Manchester United    38   27     4    7     86-28     85
## 3     3           Arsenal    38   23     6    9     83-41     75
## 4     4 Tottenham Hotspur    38   21     7   10     67-41     70
## 5     5   Manchester City    38   18    13    7     73-45     67
## 6     6       Aston Villa    38   17    13    8     52-39     64
</code></pre>

<pre><code class="r">match(data_6$Teams, data_7$Teams)
</code></pre>

<pre><code>##  [1]  2  7  1  3  8  6 12  4 17  5 16 11 14 20 10 13 19 NA NA NA
</code></pre>

<pre><code class="r">str(data_7)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Chelsea&quot; &quot;Manchester United&quot; &quot;Arsenal&quot; &quot;Tottenham Hotspur&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  27 27 23 21 18 17 18 16 13 13 ...
##  $ Draws    : int  5 4 6 7 13 13 9 13 11 11 ...
##  $ Loss     : int  6 7 9 10 7 8 11 9 14 14 ...
##  $ Aggregate: Factor w/ 20 levels &quot;103-32&quot;,&quot;32-56&quot;,..: 1 20 19 17 18 14 16 15 7 9 ...
##  $ Points   : int  86 85 75 70 67 64 63 61 50 50 ...
</code></pre>

<pre><code class="r">str(data_6)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Manchester United&quot; &quot;Liverpool&quot; &quot;Chelsea&quot; &quot;Arsenal&quot; ...
##  $ Games    : num  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : num  28 25 25 20 17 17 14 14 14 15 ...
##  $ Draws    : num  6 11 8 12 12 11 11 9 9 5 ...
##  $ Loss     : num  4 2 5 6 9 10 13 15 15 18 ...
##  $ Aggregate: Factor w/ 19 levels &quot;28-57&quot;,&quot;34-45&quot;,..: 17 19 17 18 15 14 7 13 12 16 ...
##  $ Points   : int  90 86 83 72 63 62 53 51 51 50 ...
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_8) in order to have the same taxonomy with previous seasons#####

head(data_8)
</code></pre>

<pre><code>##    N            Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA            &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1       LEICESTER    38  23    12     3    68    36   12     6     1
## 3  2         ARSENAL    38  20    11     7    65    36   12     4     3
## 4  3       TOTTENHAM    38  19    13     6    69    35   10     6     3
## 5  4 MANCHESTER CITY    38  19     9    10    71    41   12     2     5
## 6  5  MANCHESTER UTD    38  19     9    10    49    35   12     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      35    18   11     6     2      33    18  81
## 3      31    11    8     7     4      34    25  71
## 4      35    15    9     7     3      34    20  70
## 5      47    21    7     7     5      24    20  66
## 6      27     9    7     4     8      22    26  66
</code></pre>

<pre><code class="r">data_8$Team2 &lt;-  tolower(data_8$Team)


data_8$Team3 &lt;- sapply(data_8$Team2, simpleCap)

data_8 &lt;- data_8[-1, ]
data_8$Team4 &lt;- as.factor(data_8$Team3)

data_8$Team5 &lt;- alltrim(data_8$Team4)
head(data_8)
</code></pre>

<pre><code>##   N            Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 2 1       LEICESTER    38  23    12     3    68    36   12     6     1
## 3 2         ARSENAL    38  20    11     7    65    36   12     4     3
## 4 3       TOTTENHAM    38  19    13     6    69    35   10     6     3
## 5 4 MANCHESTER CITY    38  19     9    10    71    41   12     2     5
## 6 5  MANCHESTER UTD    38  19     9    10    49    35   12     5     2
## 7 6     SOUTHAMPTON    38  18     9    11    59    41   11     3     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts           Team2
## 2      35    18   11     6     2      33    18  81       leicester
## 3      31    11    8     7     4      34    25  71         arsenal
## 4      35    15    9     7     3      34    20  70       tottenham
## 5      47    21    7     7     5      24    20  66 manchester city
## 6      27     9    7     4     8      22    26  66  manchester utd
## 7      39    22    7     6     6      20    19  63     southampton
##             Team3           Team4           Team5
## 2       Leicester       Leicester       Leicester
## 3         Arsenal         Arsenal         Arsenal
## 4       Tottenham       Tottenham       Tottenham
## 5 Manchester City Manchester City Manchester City
## 6  Manchester Utd  Manchester Utd  Manchester Utd
## 7     Southampton     Southampton     Southampton
</code></pre>

<pre><code class="r">data_8$Team5 &lt;-as.character(data_8$Team4)
rownames(data_8) &lt;- 1:nrow(data_8)

match(data_7$Teams, data_8$Team5)
</code></pre>

<pre><code>##  [1] 10 NA  2 NA  4 20  8 11 NA NA  9 NA 17 NA NA NA NA NA NA NA
</code></pre>

<pre><code class="r">nchar(data_8$Team5[1])
</code></pre>

<pre><code>## [1] 9
</code></pre>

<pre><code class="r">data_8$Team2 &lt;- as.character(data_8$Team)
data_8$Team2[1:2]
</code></pre>

<pre><code>## [1] &quot;LEICESTER&quot; &quot;ARSENAL&quot;
</code></pre>

<pre><code class="r">data_8$Team2 &lt;- alltrim(data_8$Team5)
data_8$Team2[1:2]
</code></pre>

<pre><code>## [1] &quot;Leicester&quot; &quot;Arsenal&quot;
</code></pre>

<pre><code class="r">match(data_8$Team2, data_5$Teams)
</code></pre>

<pre><code>##  [1] NA  3 NA  2 NA  7 NA  6  9  1 11 NA NA NA 10 NA 16 NA NA 17
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(data_8$Team2, data_5$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Leicester&quot;,&quot;Arsenal&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Chelsea&quot;,&quot;Manchester City&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.2222222 0.1428571 0.1111111 0.2000000 0.2142857
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##              Var1    Var2   Distance
## 1       Leicester Chelsea 0.22222222
## 2         Arsenal Chelsea 0.14285714
## 3       Tottenham Chelsea 0.11111111
## 4 Manchester City Chelsea 0.20000000
## 5  Manchester Utd Chelsea 0.21428571
## 6     Southampton Chelsea 0.09090909
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Manchester Utd and Tottenham###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches)
</code></pre>

<pre><code>##              Var1    Var2   Distance
## 1       Leicester Chelsea 0.22222222
## 2         Arsenal Chelsea 0.14285714
## 3       Tottenham Chelsea 0.11111111
## 4 Manchester City Chelsea 0.20000000
## 5  Manchester Utd Chelsea 0.21428571
## 6     Southampton Chelsea 0.09090909
</code></pre>

<pre><code class="r">head(data_8)
</code></pre>

<pre><code>##   N            Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1       LEICESTER    38  23    12     3    68    36   12     6     1
## 2 2         ARSENAL    38  20    11     7    65    36   12     4     3
## 3 3       TOTTENHAM    38  19    13     6    69    35   10     6     3
## 4 4 MANCHESTER CITY    38  19     9    10    71    41   12     2     5
## 5 5  MANCHESTER UTD    38  19     9    10    49    35   12     5     2
## 6 6     SOUTHAMPTON    38  18     9    11    59    41   11     3     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts           Team2
## 1      35    18   11     6     2      33    18  81       Leicester
## 2      31    11    8     7     4      34    25  71         Arsenal
## 3      35    15    9     7     3      34    20  70       Tottenham
## 4      47    21    7     7     5      24    20  66 Manchester City
## 5      27     9    7     4     8      22    26  66  Manchester Utd
## 6      39    22    7     6     6      20    19  63     Southampton
##             Team3           Team4           Team5
## 1       Leicester       Leicester       Leicester
## 2         Arsenal         Arsenal         Arsenal
## 3       Tottenham       Tottenham       Tottenham
## 4 Manchester City Manchester City Manchester City
## 5  Manchester Utd  Manchester Utd  Manchester Utd
## 6     Southampton     Southampton     Southampton
</code></pre>

<pre><code class="r">head(matches2)
</code></pre>

<pre><code>##               Var1              Var2  Distance
## 10         Chelsea           Chelsea 1.0000000
## 24 Manchester City   Manchester City 1.0000000
## 25  Manchester Utd   Manchester City 0.8000000
## 42         Arsenal           Arsenal 1.0000000
## 64 Manchester City Manchester United 0.7647059
## 65  Manchester Utd Manchester United 0.8235294
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##               Var1              Var2  Distance
## 1          Chelsea           Chelsea 1.0000000
## 2  Manchester City   Manchester City 1.0000000
## 4          Arsenal           Arsenal 1.0000000
## 8        Liverpool         Liverpool 1.0000000
## 9      Southampton       Southampton 1.0000000
## 13      Stoke City        Stoke City 1.0000000
## 14  Crystal Palace    Crystal Palace 1.0000000
## 15         Everton           Everton 1.0000000
## 21      Sunderland        Sunderland 1.0000000
## 22     Aston Villa       Aston Villa 1.0000000
## 6   Manchester Utd Manchester United 0.8235294
## 3   Manchester Utd   Manchester City 0.8000000
## 5  Manchester City Manchester United 0.7647059
## 18 Manchester City    Leicester City 0.7333333
## 17       Leicester    Leicester City 0.6428571
## 11      Stoke City      Swansea City 0.5833333
## 12         Swansea      Swansea City 0.5833333
## 20       Newcastle  Newcastle United 0.5625000
## 10 Manchester City      Swansea City 0.5333333
## 16        West Ham   West Ham United 0.5333333
## 7        Tottenham Tottenham Hotspur 0.5294118
## 19  Manchester Utd    Leicester City 0.5000000
## 23      Stoke City         Hull City 0.5000000
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the previous seasons####
head(data_7)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1           Chelsea    38   27     5    6    103-32     86
## 2     2 Manchester United    38   27     4    7     86-28     85
## 3     3           Arsenal    38   23     6    9     83-41     75
## 4     4 Tottenham Hotspur    38   21     7   10     67-41     70
## 5     5   Manchester City    38   18    13    7     73-45     67
## 6     6       Aston Villa    38   17    13    8     52-39     64
</code></pre>

<pre><code class="r">head(data_8)
</code></pre>

<pre><code>##   N            Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1       LEICESTER    38  23    12     3    68    36   12     6     1
## 2 2         ARSENAL    38  20    11     7    65    36   12     4     3
## 3 3       TOTTENHAM    38  19    13     6    69    35   10     6     3
## 4 4 MANCHESTER CITY    38  19     9    10    71    41   12     2     5
## 5 5  MANCHESTER UTD    38  19     9    10    49    35   12     5     2
## 6 6     SOUTHAMPTON    38  18     9    11    59    41   11     3     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts           Team2
## 1      35    18   11     6     2      33    18  81       Leicester
## 2      31    11    8     7     4      34    25  71         Arsenal
## 3      35    15    9     7     3      34    20  70       Tottenham
## 4      47    21    7     7     5      24    20  66 Manchester City
## 5      27     9    7     4     8      22    26  66  Manchester Utd
## 6      39    22    7     6     6      20    19  63     Southampton
##             Team3           Team4           Team5
## 1       Leicester       Leicester       Leicester
## 2         Arsenal         Arsenal         Arsenal
## 3       Tottenham       Tottenham       Tottenham
## 4 Manchester City Manchester City Manchester City
## 5  Manchester Utd  Manchester Utd  Manchester Utd
## 6     Southampton     Southampton     Southampton
</code></pre>

<pre><code class="r">names(data_8)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">data_9 &lt;- data_8[c(1, 20, 3:8, 19)]

str(data_9)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team2: chr  &quot;Leicester&quot; &quot;Arsenal&quot; &quot;Tottenham&quot; &quot;Manchester City&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 7 7 6 5 5 4 3 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 3 2 4 8 8 8 5 3 8 5 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 13 12 1 1 2 14 1 5 3 ...
##  $ Goals: Factor w/ 17 levels &quot;27&quot;,&quot;34&quot;,&quot;39&quot;,..: 14 13 15 16 10 11 13 12 5 11 ...
##  $ NA..3: Factor w/ 14 levels &quot;35&quot;,&quot;36&quot;,&quot;41&quot;,..: 2 2 1 3 1 3 6 5 9 8 ...
##  $ Pts  : num  81 71 70 66 66 63 62 60 51 50 ...
</code></pre>

<pre><code class="r">head(data_9)
</code></pre>

<pre><code>##   N           Team2 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1       Leicester    38  23    12     3    68    36  81
## 2 2         Arsenal    38  20    11     7    65    36  71
## 3 3       Tottenham    38  19    13     6    69    35  70
## 4 4 Manchester City    38  19     9    10    71    41  66
## 5 5  Manchester Utd    38  19     9    10    49    35  66
## 6 6     Southampton    38  18     9    11    59    41  63
</code></pre>

<pre><code class="r">head(data_7)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1           Chelsea    38   27     5    6    103-32     86
## 2     2 Manchester United    38   27     4    7     86-28     85
## 3     3           Arsenal    38   23     6    9     83-41     75
## 4     4 Tottenham Hotspur    38   21     7   10     67-41     70
## 5     5   Manchester City    38   18    13    7     73-45     67
## 6     6       Aston Villa    38   17    13    8     52-39     64
</code></pre>

<pre><code class="r">str(data_7)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : int  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Chelsea&quot; &quot;Manchester United&quot; &quot;Arsenal&quot; &quot;Tottenham Hotspur&quot; ...
##  $ Games    : int  38 38 38 38 38 38 38 38 38 38 ...
##  $ Wins     : int  27 27 23 21 18 17 18 16 13 13 ...
##  $ Draws    : int  5 4 6 7 13 13 9 13 11 11 ...
##  $ Loss     : int  6 7 9 10 7 8 11 9 14 14 ...
##  $ Aggregate: Factor w/ 20 levels &quot;103-32&quot;,&quot;32-56&quot;,..: 1 20 19 17 18 14 16 15 7 9 ...
##  $ Points   : int  86 85 75 70 67 64 63 61 50 50 ...
</code></pre>

<pre><code class="r">data_9$Aggregate &lt;- paste(data_9$Goals, data_9$NA..3, sep = &quot;-&quot;)
head(data_9)
</code></pre>

<pre><code>##   N           Team2 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1       Leicester    38  23    12     3    68    36  81     68-36
## 2 2         Arsenal    38  20    11     7    65    36  71     65-36
## 3 3       Tottenham    38  19    13     6    69    35  70     69-35
## 4 4 Manchester City    38  19     9    10    71    41  66     71-41
## 5 5  Manchester Utd    38  19     9    10    49    35  66     49-35
## 6 6     Southampton    38  18     9    11    59    41  63     59-41
</code></pre>

<pre><code class="r">data_9 &lt;- data_9[ ,c(1:6, 10, 9)]
head(data_9)
</code></pre>

<pre><code>##   N           Team2 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1       Leicester    38  23    12     3     68-36  81
## 2 2         Arsenal    38  20    11     7     65-36  71
## 3 3       Tottenham    38  19    13     6     69-35  70
## 4 4 Manchester City    38  19     9    10     71-41  66
## 5 5  Manchester Utd    38  19     9    10     49-35  66
## 6 6     Southampton    38  18     9    11     59-41  63
</code></pre>

<pre><code class="r">names(data_9) &lt;- names(data_1)
head(data_9)
</code></pre>

<pre><code>##   Index           Teams Games Wins Draws Loss Aggregate Points
## 1     1       Leicester    38   23    12    3     68-36     81
## 2     2         Arsenal    38   20    11    7     65-36     71
## 3     3       Tottenham    38   19    13    6     69-35     70
## 4     4 Manchester City    38   19     9   10     71-41     66
## 5     5  Manchester Utd    38   19     9   10     49-35     66
## 6     6     Southampton    38   18     9   11     59-41     63
</code></pre>

<pre><code class="r">str(data_9)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Leicester&quot; &quot;Arsenal&quot; &quot;Tottenham&quot; &quot;Manchester City&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 7 7 6 5 5 4 3 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 3 2 4 8 8 8 5 3 8 5 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 13 12 1 1 2 14 1 5 3 ...
##  $ Aggregate: chr  &quot;68-36&quot; &quot;65-36&quot; &quot;69-35&quot; &quot;71-41&quot; ...
##  $ Points   : num  81 71 70 66 66 63 62 60 51 50 ...
</code></pre>

<pre><code class="r">#####Changing the names#####
data_9$Teams[data_9$Teams == &quot;Manchester Utd&quot;] &lt;- data_7$Teams[2]
data_9$Teams[data_9$Teams == &quot;Tottenham&quot;] &lt;- data_7$Teams[4]
data_9$Teams[data_9$Teams == &quot;West Ham&quot;] &lt;- data_7$Teams[17]
data_9$Teams[data_9$Teams == &quot;Leicester&quot;] &lt;- data_5$Teams[14]
data_9$Teams[data_9$Teams == &quot;Swansea&quot;] &lt;- data_5$Teams[8]
data_9$Teams[data_9$Teams == &quot;Newcastle&quot;] &lt;- data_5$Teams[18]
data_9$Teams[data_9$Teams == &quot;West Brom&quot;] &lt;- data_5$Teams[13]

data_9[ ,c(3:6)] &lt;- apply(data_9[ ,c(3:6)], 2, as.numeric)
str(data_5$Teams)
</code></pre>

<pre><code>##  chr [1:20] &quot;Chelsea&quot; &quot;Manchester City&quot; &quot;Arsenal&quot; ...
</code></pre>

<pre><code class="r">data_5$Teams
</code></pre>

<pre><code>##  [1] &quot;Chelsea&quot;              &quot;Manchester City&quot;      &quot;Arsenal&quot;             
##  [4] &quot;Manchester United&quot;    &quot;Tottenham Hotspur&quot;    &quot;Liverpool&quot;           
##  [7] &quot;Southampton&quot;          &quot;Swansea City&quot;         &quot;Stoke City&quot;          
## [10] &quot;Crystal Palace&quot;       &quot;Everton&quot;              &quot;West Ham United&quot;     
## [13] &quot;West Bromwich Albion&quot; &quot;Leicester City&quot;       &quot;Newcastle United&quot;    
## [16] &quot;Sunderland&quot;           &quot;Aston Villa&quot;          &quot;Hull City&quot;           
## [19] &quot;Burnley&quot;              &quot;Queens Park Rangers&quot;
</code></pre>

<pre><code class="r">match(data_9$Teams, data_5$Teams)
</code></pre>

<pre><code>##  [1] 14  3  5  2  4  7 12  6  9  1 11  8 NA 13 10 NA 16 18 NA 17
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_GL09)#####
####GL09 = German League season 2008-2009####

library(dplyr)

head(data_GL09)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1     WOLFSBURG    34  21     6     7    80    41   16     1     0
## 3  2 BAYERN MUNICH    34  20     7     7    71    42   12     2     3
## 4  3     STUTTGART    34  19     7     8    63    43   12     3     2
## 5  4 HERTHA BERLIN    34  19     6     9    48    41   12     3     2
## 6  5     HAMBURGER    34  19     4    11    49    47   13     2     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      51    13    5     5     7      29    28  69
## 3      45    23    8     5     4      26    19  67
## 4      34    14    7     4     6      29    29  64
## 5      29    14    7     3     7      19    27  63
## 6      27    13    6     2     9      22    34  61
</code></pre>

<pre><code class="r">data_GL09 &lt;- data_GL09[-1 , ]

####Converting teams names to lower case
data_GL09$Team2 &lt;-  tolower(data_GL09$Team)

####Converting the starting letter of the teams names to upper case 
data_GL09$Team3 &lt;- sapply(data_GL09$Team2, simpleCap)

data_GL09$Team4 &lt;- as.factor(data_GL09$Team3)

data_GL09$Team5 &lt;-as.character(data_GL09$Team4)
rownames(data_GL09) &lt;- 1:nrow(data_GL09)
head(data_GL09)
</code></pre>

<pre><code>##   N              Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1         WOLFSBURG    34  21     6     7    80    41   16     1     0
## 2 2     BAYERN MUNICH    34  20     7     7    71    42   12     2     3
## 3 3         STUTTGART    34  19     7     8    63    43   12     3     2
## 4 4     HERTHA BERLIN    34  19     6     9    48    41   12     3     2
## 5 5         HAMBURGER    34  19     4    11    49    47   13     2     2
## 6 6 BORUSSIA DORTMUND    34  15    14     5    60    37    8     9     0
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts             Team2
## 1      51    13    5     5     7      29    28  69         wolfsburg
## 2      45    23    8     5     4      26    19  67     bayern munich
## 3      34    14    7     4     6      29    29  64         stuttgart
## 4      29    14    7     3     7      19    27  63     hertha berlin
## 5      27    13    6     2     9      22    34  61         hamburger
## 6      34    11    7     5     5      26    26  59 borussia dortmund
##               Team3             Team4             Team5
## 1         Wolfsburg         Wolfsburg         Wolfsburg
## 2     Bayern Munich     Bayern Munich     Bayern Munich
## 3         Stuttgart         Stuttgart         Stuttgart
## 4     Hertha Berlin     Hertha Berlin     Hertha Berlin
## 5         Hamburger         Hamburger         Hamburger
## 6 Borussia Dortmund Borussia Dortmund Borussia Dortmund
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL09)
</code></pre>

<pre><code>##   N              Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1         WOLFSBURG    34  21     6     7    80    41   16     1     0
## 2 2     BAYERN MUNICH    34  20     7     7    71    42   12     2     3
## 3 3         STUTTGART    34  19     7     8    63    43   12     3     2
## 4 4     HERTHA BERLIN    34  19     6     9    48    41   12     3     2
## 5 5         HAMBURGER    34  19     4    11    49    47   13     2     2
## 6 6 BORUSSIA DORTMUND    34  15    14     5    60    37    8     9     0
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts             Team2
## 1      51    13    5     5     7      29    28  69         wolfsburg
## 2      45    23    8     5     4      26    19  67     bayern munich
## 3      34    14    7     4     6      29    29  64         stuttgart
## 4      29    14    7     3     7      19    27  63     hertha berlin
## 5      27    13    6     2     9      22    34  61         hamburger
## 6      34    11    7     5     5      26    26  59 borussia dortmund
##               Team3             Team4             Team5
## 1         Wolfsburg         Wolfsburg         Wolfsburg
## 2     Bayern Munich     Bayern Munich     Bayern Munich
## 3         Stuttgart         Stuttgart         Stuttgart
## 4     Hertha Berlin     Hertha Berlin     Hertha Berlin
## 5         Hamburger         Hamburger         Hamburger
## 6 Borussia Dortmund Borussia Dortmund Borussia Dortmund
</code></pre>

<pre><code class="r">names(data_GL09)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df &lt;- data_GL09[c(1, 23, 3:8, 19)]

str(df)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Wolfsburg&quot; &quot;Bayern Munich&quot; &quot;Stuttgart&quot; &quot;Hertha Berlin&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 6 6 6 5 5 4 4 3 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;14&quot;,..: 7 8 8 7 5 3 1 9 8 10 ...
##  $ NA..2: Factor w/ 14 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 11 12 13 1 10 13 2 3 3 ...
##  $ Goals: Factor w/ 14 levels &quot;29&quot;,&quot;30&quot;,&quot;35&quot;,..: 13 12 10 6 7 9 10 5 8 11 ...
##  $ NA..3: Factor w/ 17 levels &quot;35&quot;,&quot;37&quot;,&quot;41&quot;,..: 3 4 5 3 7 2 8 1 6 9 ...
##  $ Pts  : num  69 67 64 63 61 59 55 50 49 45 ...
</code></pre>

<pre><code class="r">head(df)
</code></pre>

<pre><code>##   N             Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1         Wolfsburg    34  21     6     7    80    41  69
## 2 2     Bayern Munich    34  20     7     7    71    42  67
## 3 3         Stuttgart    34  19     7     8    63    43  64
## 4 4     Hertha Berlin    34  19     6     9    48    41  63
## 5 5         Hamburger    34  19     4    11    49    47  61
## 6 6 Borussia Dortmund    34  15    14     5    60    37  59
</code></pre>

<pre><code class="r">#####Changing the names#####

df$Aggregate &lt;- paste(df$Goals, df$NA..3, sep = &quot;-&quot;)
head(df)
</code></pre>

<pre><code>##   N             Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1         Wolfsburg    34  21     6     7    80    41  69     80-41
## 2 2     Bayern Munich    34  20     7     7    71    42  67     71-42
## 3 3         Stuttgart    34  19     7     8    63    43  64     63-43
## 4 4     Hertha Berlin    34  19     6     9    48    41  63     48-41
## 5 5         Hamburger    34  19     4    11    49    47  61     49-47
## 6 6 Borussia Dortmund    34  15    14     5    60    37  59     60-37
</code></pre>

<pre><code class="r">df &lt;- df[ ,c(1:6, 10, 9)]
head(df)
</code></pre>

<pre><code>##   N             Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1         Wolfsburg    34  21     6     7     80-41  69
## 2 2     Bayern Munich    34  20     7     7     71-42  67
## 3 3         Stuttgart    34  19     7     8     63-43  64
## 4 4     Hertha Berlin    34  19     6     9     48-41  63
## 5 5         Hamburger    34  19     4    11     49-47  61
## 6 6 Borussia Dortmund    34  15    14     5     60-37  59
</code></pre>

<pre><code class="r">names(df) &lt;- names(data_9)
head(df)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1         Wolfsburg    34   21     6    7     80-41     69
## 2     2     Bayern Munich    34   20     7    7     71-42     67
## 3     3         Stuttgart    34   19     7    8     63-43     64
## 4     4     Hertha Berlin    34   19     6    9     48-41     63
## 5     5         Hamburger    34   19     4   11     49-47     61
## 6     6 Borussia Dortmund    34   15    14    5     60-37     59
</code></pre>

<pre><code class="r">str(df)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Wolfsburg&quot; &quot;Bayern Munich&quot; &quot;Stuttgart&quot; &quot;Hertha Berlin&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 6 6 6 5 5 4 4 3 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;14&quot;,..: 7 8 8 7 5 3 1 9 8 10 ...
##  $ Loss     : Factor w/ 14 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 11 12 13 1 10 13 2 3 3 ...
##  $ Aggregate: chr  &quot;80-41&quot; &quot;71-42&quot; &quot;63-43&quot; &quot;48-41&quot; ...
##  $ Points   : num  69 67 64 63 61 59 55 50 49 45 ...
</code></pre>

<pre><code class="r">df[ ,c(3:6)] &lt;- apply(df[ ,c(3:6)], 2, as.numeric)

#####Manipulating the upper case issue in imported data (data_GL10)#####

library(dplyr)

head(data_GL10)
</code></pre>

<pre><code>##    N              Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA              &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1     BAYERN MUNICH    34  20    10     4    72    31   12     4     1
## 3  2           SCHALKE    34  19     8     7    53    31   11     2     4
## 4  3     WERDER BREMEN    34  17    10     7    71    40    8     6     3
## 5  4        LEVERKUSEN    34  15    14     5    65    38   11     5     1
## 6  5 BORUSSIA DORTMUND    34  16     9     9    54    42   10     4     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      39    13    8     6     3      33    18  70
## 3      29    15    8     6     3      24    16  65
## 4      34    21    9     4     4      37    19  61
## 5      37    14    4     9     4      28    24  59
## 6      29    14    6     5     6      25    28  57
</code></pre>

<pre><code class="r">data_GL10 &lt;- data_GL10[-1 , ]

####Converting teams names to lower case
data_GL10$Team2 &lt;-  tolower(data_GL10$Team)

####Converting the starting letter of the teams names to upper case 
data_GL10$Team3 &lt;- sapply(data_GL10$Team2, simpleCap)

data_GL10$Team4 &lt;- as.factor(data_GL10$Team3)

data_GL10$Team5 &lt;-as.character(data_GL10$Team4)
rownames(data_GL10) &lt;- 1:nrow(data_GL10)
head(data_GL10)
</code></pre>

<pre><code>##   N              Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1     BAYERN MUNICH    34  20    10     4    72    31   12     4     1
## 2 2           SCHALKE    34  19     8     7    53    31   11     2     4
## 3 3     WERDER BREMEN    34  17    10     7    71    40    8     6     3
## 4 4        LEVERKUSEN    34  15    14     5    65    38   11     5     1
## 5 5 BORUSSIA DORTMUND    34  16     9     9    54    42   10     4     3
## 6 6         STUTTGART    34  15    10     9    51    41    8     5     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts             Team2
## 1      39    13    8     6     3      33    18  70     bayern munich
## 2      29    15    8     6     3      24    16  65           schalke
## 3      34    21    9     4     4      37    19  61     werder bremen
## 4      37    14    4     9     4      28    24  59        leverkusen
## 5      29    14    6     5     6      25    28  57 borussia dortmund
## 6      28    21    7     5     5      23    20  55         stuttgart
##               Team3             Team4             Team5
## 1     Bayern Munich     Bayern Munich     Bayern Munich
## 2           Schalke           Schalke           Schalke
## 3     Werder Bremen     Werder Bremen     Werder Bremen
## 4        Leverkusen        Leverkusen        Leverkusen
## 5 Borussia Dortmund Borussia Dortmund Borussia Dortmund
## 6         Stuttgart         Stuttgart         Stuttgart
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL10)
</code></pre>

<pre><code>##   N              Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1     BAYERN MUNICH    34  20    10     4    72    31   12     4     1
## 2 2           SCHALKE    34  19     8     7    53    31   11     2     4
## 3 3     WERDER BREMEN    34  17    10     7    71    40    8     6     3
## 4 4        LEVERKUSEN    34  15    14     5    65    38   11     5     1
## 5 5 BORUSSIA DORTMUND    34  16     9     9    54    42   10     4     3
## 6 6         STUTTGART    34  15    10     9    51    41    8     5     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts             Team2
## 1      39    13    8     6     3      33    18  70     bayern munich
## 2      29    15    8     6     3      24    16  65           schalke
## 3      34    21    9     4     4      37    19  61     werder bremen
## 4      37    14    4     9     4      28    24  59        leverkusen
## 5      29    14    6     5     6      25    28  57 borussia dortmund
## 6      28    21    7     5     5      23    20  55         stuttgart
##               Team3             Team4             Team5
## 1     Bayern Munich     Bayern Munich     Bayern Munich
## 2           Schalke           Schalke           Schalke
## 3     Werder Bremen     Werder Bremen     Werder Bremen
## 4        Leverkusen        Leverkusen        Leverkusen
## 5 Borussia Dortmund Borussia Dortmund Borussia Dortmund
## 6         Stuttgart         Stuttgart         Stuttgart
</code></pre>

<pre><code class="r">names(data_GL10)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df3 &lt;- data_GL10[c(1, 23, 3:8, 19)]

str(df3)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Bayern Munich&quot; &quot;Schalke&quot; &quot;Werder Bremen&quot; &quot;Leverkusen&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 9 8 6 7 6 4 5 3 3 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 1 7 1 4 8 1 3 7 2 1 ...
##  $ NA..2: Factor w/ 14 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 9 11 11 10 13 13 12 2 1 2 ...
##  $ Goals: Factor w/ 17 levels &quot;32&quot;,&quot;33&quot;,&quot;34&quot;,..: 16 10 15 14 11 9 12 13 5 8 ...
##  $ NA..3: Factor w/ 13 levels &quot;31&quot;,&quot;38&quot;,&quot;40&quot;,..: 1 1 3 2 5 4 4 8 5 6 ...
##  $ Pts  : num  70 65 61 59 57 55 52 50 47 46 ...
</code></pre>

<pre><code class="r">head(df3)
</code></pre>

<pre><code>##   N             Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1     Bayern Munich    34  20    10     4    72    31  70
## 2 2           Schalke    34  19     8     7    53    31  65
## 3 3     Werder Bremen    34  17    10     7    71    40  61
## 4 4        Leverkusen    34  15    14     5    65    38  59
## 5 5 Borussia Dortmund    34  16     9     9    54    42  57
## 6 6         Stuttgart    34  15    10     9    51    41  55
</code></pre>

<pre><code class="r">#####Changing the names#####

df3$Aggregate &lt;- paste(df3$Goals, df3$NA..3, sep = &quot;-&quot;)
head(df3)
</code></pre>

<pre><code>##   N             Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1     Bayern Munich    34  20    10     4    72    31  70     72-31
## 2 2           Schalke    34  19     8     7    53    31  65     53-31
## 3 3     Werder Bremen    34  17    10     7    71    40  61     71-40
## 4 4        Leverkusen    34  15    14     5    65    38  59     65-38
## 5 5 Borussia Dortmund    34  16     9     9    54    42  57     54-42
## 6 6         Stuttgart    34  15    10     9    51    41  55     51-41
</code></pre>

<pre><code class="r">df3 &lt;- df3[ ,c(1:6, 10, 9)]
head(df3)
</code></pre>

<pre><code>##   N             Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1     Bayern Munich    34  20    10     4     72-31  70
## 2 2           Schalke    34  19     8     7     53-31  65
## 3 3     Werder Bremen    34  17    10     7     71-40  61
## 4 4        Leverkusen    34  15    14     5     65-38  59
## 5 5 Borussia Dortmund    34  16     9     9     54-42  57
## 6 6         Stuttgart    34  15    10     9     51-41  55
</code></pre>

<pre><code class="r">names(df3) &lt;- names(data_9)
head(df3)
</code></pre>

<pre><code>##   Index             Teams Games Wins Draws Loss Aggregate Points
## 1     1     Bayern Munich    34   20    10    4     72-31     70
## 2     2           Schalke    34   19     8    7     53-31     65
## 3     3     Werder Bremen    34   17    10    7     71-40     61
## 4     4        Leverkusen    34   15    14    5     65-38     59
## 5     5 Borussia Dortmund    34   16     9    9     54-42     57
## 6     6         Stuttgart    34   15    10    9     51-41     55
</code></pre>

<pre><code class="r">str(df3)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Bayern Munich&quot; &quot;Schalke&quot; &quot;Werder Bremen&quot; &quot;Leverkusen&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 9 8 6 7 6 4 5 3 3 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 1 7 1 4 8 1 3 7 2 1 ...
##  $ Loss     : Factor w/ 14 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 9 11 11 10 13 13 12 2 1 2 ...
##  $ Aggregate: chr  &quot;72-31&quot; &quot;53-31&quot; &quot;71-40&quot; &quot;65-38&quot; ...
##  $ Points   : num  70 65 61 59 57 55 52 50 47 46 ...
</code></pre>

<pre><code class="r">df3[ ,c(3:6)] &lt;- apply(df3[ ,c(3:6)], 2, as.numeric)

match(df$Teams, df3$Teams)
</code></pre>

<pre><code>##  [1]  8  1  6 NA  7  5 11  2  4  3 15 13 10 17 12 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df$Teams, df3$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Wolfsburg&quot;,&quot;Bayern Munich&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.07692308 1.00000000 0.00000000 0.07692308 0.15384615
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1          Var2   Distance
## 1         Wolfsburg Bayern Munich 0.07692308
## 2     Bayern Munich Bayern Munich 1.00000000
## 3         Stuttgart Bayern Munich 0.00000000
## 4     Hertha Berlin Bayern Munich 0.07692308
## 5         Hamburger Bayern Munich 0.15384615
## 6 Borussia Dortmund Bayern Munich 0.11764706
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 14
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.4)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.4, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Hertha and Hertha Berlin###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                 Var1              Var2 Distance
## 2      Bayern Munich     Bayern Munich        1
## 26           Schalke           Schalke        1
## 46     Werder Bremen     Werder Bremen        1
## 63        Leverkusen        Leverkusen        1
## 78 Borussia Dortmund Borussia Dortmund        1
## 93         Stuttgart         Stuttgart        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1              Var2  Distance
## 1      Bayern Munich     Bayern Munich 1.0000000
## 2            Schalke           Schalke 1.0000000
## 3      Werder Bremen     Werder Bremen 1.0000000
## 4         Leverkusen        Leverkusen 1.0000000
## 5  Borussia Dortmund Borussia Dortmund 1.0000000
## 6          Stuttgart         Stuttgart 1.0000000
## 7          Hamburger         Hamburger 1.0000000
## 10         Wolfsburg         Wolfsburg 1.0000000
## 11      Eintracht F.      Eintracht F. 1.0000000
## 12        Hoffenheim        Hoffenheim 1.0000000
## 13   Monchengladbach   Monchengladbach 1.0000000
## 14              Koln              Koln 1.0000000
## 17          Hannover          Hannover 1.0000000
## 18            Bochum            Bochum 1.0000000
## 19     Hertha Berlin            Hertha 0.4615385
## 8           Hannover         Hamburger 0.4444444
## 15         Wolfsburg          Freiburg 0.4444444
## 16         Hamburger          Hannover 0.4444444
## 9         Karlsruher         Hamburger 0.4000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df3$Teams[df3$Teams == &quot;Hertha&quot;] &lt;- df$Teams[df$Teams == &quot;Hertha Berlin&quot;]

###Checking match funtion after the correction
match(df$Teams, df3$Teams)
</code></pre>

<pre><code>##  [1]  8  1  6 18  7  5 11  2  4  3 15 13 10 17 12 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2008-2009: https://en.wikipedia.org/wiki/2008-09_Bundesliga##

#####Manipulating the upper case issue in imported data (data_GL11)#####

library(dplyr)

head(data_GL11)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BORUSSIA D.    34  23     6     5    67    22   12     4     1
## 3  2    LEVERKUSEN    34  20     8     6    64    44    9     5     3
## 4  3 BAYERN MUNICH    34  19     8     7    81    40   13     2     2
## 5  4      HANNOVER    34  19     3    12    49    45   12     1     4
## 6  5         MAINZ    34  18     4    12    52    39    8     2     7
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      35     8   11     2     4      32    14  75
## 3      33    24   11     3     3      31    20  68
## 4      48    13    6     6     5      33    27  65
## 5      32    17    7     2     8      17    28  60
## 6      22    16   10     2     5      30    23  58
</code></pre>

<pre><code class="r">data_GL11 &lt;- data_GL11[-1 , ]

####Converting teams names to lower case
data_GL11$Team2 &lt;-  tolower(data_GL11$Team)

####Converting the starting letter of the teams names to upper case 
data_GL11$Team3 &lt;- sapply(data_GL11$Team2, simpleCap)

data_GL11$Team4 &lt;- as.factor(data_GL11$Team3)

data_GL11$Team5 &lt;-as.character(data_GL11$Team4)
rownames(data_GL11) &lt;- 1:nrow(data_GL11)
head(data_GL11)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1   BORUSSIA D.    34  23     6     5    67    22   12     4     1
## 2 2    LEVERKUSEN    34  20     8     6    64    44    9     5     3
## 3 3 BAYERN MUNICH    34  19     8     7    81    40   13     2     2
## 4 4      HANNOVER    34  19     3    12    49    45   12     1     4
## 5 5         MAINZ    34  18     4    12    52    39    8     2     7
## 6 6      NURNBERG    34  13     8    13    47    45    9     2     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      35     8   11     2     4      32    14  75   borussia d.
## 2      33    24   11     3     3      31    20  68    leverkusen
## 3      48    13    6     6     5      33    27  65 bayern munich
## 4      32    17    7     2     8      17    28  60      hannover
## 5      22    16   10     2     5      30    23  58         mainz
## 6      28    19    4     6     7      19    26  47      nurnberg
##           Team3         Team4         Team5
## 1   Borussia D.   Borussia D.   Borussia D.
## 2    Leverkusen    Leverkusen    Leverkusen
## 3 Bayern Munich Bayern Munich Bayern Munich
## 4      Hannover      Hannover      Hannover
## 5         Mainz         Mainz         Mainz
## 6      Nurnberg      Nurnberg      Nurnberg
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL11)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1   BORUSSIA D.    34  23     6     5    67    22   12     4     1
## 2 2    LEVERKUSEN    34  20     8     6    64    44    9     5     3
## 3 3 BAYERN MUNICH    34  19     8     7    81    40   13     2     2
## 4 4      HANNOVER    34  19     3    12    49    45   12     1     4
## 5 5         MAINZ    34  18     4    12    52    39    8     2     7
## 6 6      NURNBERG    34  13     8    13    47    45    9     2     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      35     8   11     2     4      32    14  75   borussia d.
## 2      33    24   11     3     3      31    20  68    leverkusen
## 3      48    13    6     6     5      33    27  65 bayern munich
## 4      32    17    7     2     8      17    28  60      hannover
## 5      22    16   10     2     5      30    23  58         mainz
## 6      28    19    4     6     7      19    26  47      nurnberg
##           Team3         Team4         Team5
## 1   Borussia D.   Borussia D.   Borussia D.
## 2    Leverkusen    Leverkusen    Leverkusen
## 3 Bayern Munich Bayern Munich Bayern Munich
## 4      Hannover      Hannover      Hannover
## 5         Mainz         Mainz         Mainz
## 6      Nurnberg      Nurnberg      Nurnberg
</code></pre>

<pre><code class="r">names(data_GL11)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df4 &lt;- data_GL11[c(1, 23, 3:8, 19)]

str(df4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Borussia D.&quot; &quot;Leverkusen&quot; &quot;Bayern Munich&quot; &quot;Hannover&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 6 6 5 4 4 3 4 4 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;3&quot;,..: 6 8 8 3 4 8 7 9 5 5 ...
##  $ NA..2: Factor w/ 10 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 7 8 9 1 1 2 3 2 4 4 ...
##  $ Goals: Factor w/ 16 levels &quot;31&quot;,&quot;35&quot;,&quot;38&quot;,..: 14 13 15 9 11 7 8 6 4 7 ...
##  $ NA..3: Factor w/ 16 levels &quot;22&quot;,&quot;39&quot;,&quot;40&quot;,..: 1 4 3 5 2 5 9 10 8 13 ...
##  $ Pts  : num  75 68 65 60 58 47 46 45 44 44 ...
</code></pre>

<pre><code class="r">head(df4)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Borussia D.    34  23     6     5    67    22  75
## 2 2    Leverkusen    34  20     8     6    64    44  68
## 3 3 Bayern Munich    34  19     8     7    81    40  65
## 4 4      Hannover    34  19     3    12    49    45  60
## 5 5         Mainz    34  18     4    12    52    39  58
## 6 6      Nurnberg    34  13     8    13    47    45  47
</code></pre>

<pre><code class="r">#####Changing the names#####

df4$Aggregate &lt;- paste(df4$Goals, df4$NA..3, sep = &quot;-&quot;)
head(df4)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Borussia D.    34  23     6     5    67    22  75     67-22
## 2 2    Leverkusen    34  20     8     6    64    44  68     64-44
## 3 3 Bayern Munich    34  19     8     7    81    40  65     81-40
## 4 4      Hannover    34  19     3    12    49    45  60     49-45
## 5 5         Mainz    34  18     4    12    52    39  58     52-39
## 6 6      Nurnberg    34  13     8    13    47    45  47     47-45
</code></pre>

<pre><code class="r">df4 &lt;- df4[ ,c(1:6, 10, 9)]
head(df4)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Borussia D.    34  23     6     5     67-22  75
## 2 2    Leverkusen    34  20     8     6     64-44  68
## 3 3 Bayern Munich    34  19     8     7     81-40  65
## 4 4      Hannover    34  19     3    12     49-45  60
## 5 5         Mainz    34  18     4    12     52-39  58
## 6 6      Nurnberg    34  13     8    13     47-45  47
</code></pre>

<pre><code class="r">names(df4) &lt;- names(data_9)
head(df4)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1   Borussia D.    34   23     6    5     67-22     75
## 2     2    Leverkusen    34   20     8    6     64-44     68
## 3     3 Bayern Munich    34   19     8    7     81-40     65
## 4     4      Hannover    34   19     3   12     49-45     60
## 5     5         Mainz    34   18     4   12     52-39     58
## 6     6      Nurnberg    34   13     8   13     47-45     47
</code></pre>

<pre><code class="r">str(df4)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Borussia D.&quot; &quot;Leverkusen&quot; &quot;Bayern Munich&quot; &quot;Hannover&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 6 6 5 4 4 3 4 4 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;3&quot;,..: 6 8 8 3 4 8 7 9 5 5 ...
##  $ Loss     : Factor w/ 10 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 7 8 9 1 1 2 3 2 4 4 ...
##  $ Aggregate: chr  &quot;67-22&quot; &quot;64-44&quot; &quot;81-40&quot; &quot;49-45&quot; ...
##  $ Points   : num  75 68 65 60 58 47 46 45 44 44 ...
</code></pre>

<pre><code class="r">df4[ ,c(3:6)] &lt;- apply(df4[ ,c(3:6)], 2, as.numeric)

match(df3$Teams, df4$Teams)
</code></pre>

<pre><code>##  [1]  3 14 13  2 NA 12  8 15  5 17 11 NA 10  9  4  6 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df3$Teams, df4$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Borussia D.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.15384615 0.09090909 0.07692308 0.00000000 0.58823529
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1        Var2   Distance
## 1     Bayern Munich Borussia D. 0.15384615
## 2           Schalke Borussia D. 0.09090909
## 3     Werder Bremen Borussia D. 0.07692308
## 4        Leverkusen Borussia D. 0.00000000
## 5 Borussia Dortmund Borussia D. 0.58823529
## 6         Stuttgart Borussia D. 0.18181818
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Borusia Dortmund and Borussia D.###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                  Var1          Var2  Distance
## 5   Borussia Dortmund   Borussia D. 0.5882353
## 22         Leverkusen    Leverkusen 1.0000000
## 37      Bayern Munich Bayern Munich 1.0000000
## 69           Hannover      Hannover 1.0000000
## 81              Mainz         Mainz 1.0000000
## 106          Nurnberg      Nurnberg 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 2         Leverkusen    Leverkusen 1.0000000
## 3      Bayern Munich Bayern Munich 1.0000000
## 4           Hannover      Hannover 1.0000000
## 5              Mainz         Mainz 1.0000000
## 6           Nurnberg      Nurnberg 1.0000000
## 7          Hamburger     Hamburger 1.0000000
## 8           Freiburg      Freiburg 1.0000000
## 9               Koln          Koln 1.0000000
## 10        Hoffenheim    Hoffenheim 1.0000000
## 11         Stuttgart     Stuttgart 1.0000000
## 12     Werder Bremen Werder Bremen 1.0000000
## 13           Schalke       Schalke 1.0000000
## 14         Wolfsburg     Wolfsburg 1.0000000
## 16      Eintracht F.  Eintracht F. 1.0000000
## 15   Monchengladbach  Monchenglad. 0.7333333
## 1  Borussia Dortmund   Borussia D. 0.5882353
</code></pre>

<pre><code class="r">#####Changing the names#####
df4$Teams[df4$Teams == &quot;Monchenglad.&quot;] &lt;- df3$Teams[df3$Teams == &quot;Monchengladbach&quot;]
df4$Teams[df4$Teams == &quot;Borussia D.&quot;] &lt;- df3$Teams[df3$Teams == &quot;Borussia Dortmund&quot;]

###Checking match funtion after the correction
match(df3$Teams, df4$Teams)
</code></pre>

<pre><code>##  [1]  3 14 13  2  1 12  8 15  5 17 11 16 10  9  4  6 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2009-2010: https://en.wikipedia.org/wiki/2009-10_Bundesliga##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_GL12)#####

library(dplyr)

head(data_GL12)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BORUSSIA D.    34  25     6     3    80    25   14     2     1
## 3  2 BAYERN MUNICH    34  23     4     7    77    22   14     1     2
## 4  3       SCHALKE    34  20     4    10    74    44   13     1     3
## 5  4  MONCHENGLAD.    34  17     9     8    49    24    9     7     1
## 6  5    LEVERKUSEN    34  15     9    10    52    44    8     4     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      44    12   11     4     2      36    13  81
## 3      49     6    9     3     5      28    16  73
## 4      47    14    7     3     7      27    30  64
## 5      29    10    8     2     7      20    14  60
## 6      28    24    7     5     5      24    20  54
</code></pre>

<pre><code class="r">data_GL12 &lt;- data_GL12[-1 , ]

####Converting teams names to lower case
data_GL12$Team2 &lt;-  tolower(data_GL12$Team)

####Converting the starting letter of the teams names to upper case 
data_GL12$Team3 &lt;- sapply(data_GL12$Team2, simpleCap)

data_GL12$Team4 &lt;- as.factor(data_GL12$Team3)

data_GL12$Team5 &lt;-as.character(data_GL12$Team4)
rownames(data_GL12) &lt;- 1:nrow(data_GL12)
head(data_GL12)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1   BORUSSIA D.    34  25     6     3    80    25   14     2     1
## 2 2 BAYERN MUNICH    34  23     4     7    77    22   14     1     2
## 3 3       SCHALKE    34  20     4    10    74    44   13     1     3
## 4 4  MONCHENGLAD.    34  17     9     8    49    24    9     7     1
## 5 5    LEVERKUSEN    34  15     9    10    52    44    8     4     5
## 6 6     STUTTGART    34  15     8    11    63    46   10     3     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      44    12   11     4     2      36    13  81   borussia d.
## 2      49     6    9     3     5      28    16  73 bayern munich
## 3      47    14    7     3     7      27    30  64       schalke
## 4      29    10    8     2     7      20    14  60  monchenglad.
## 5      28    24    7     5     5      24    20  54    leverkusen
## 6      36    17    5     5     7      27    29  53     stuttgart
##           Team3         Team4         Team5
## 1   Borussia D.   Borussia D.   Borussia D.
## 2 Bayern Munich Bayern Munich Bayern Munich
## 3       Schalke       Schalke       Schalke
## 4  Monchenglad.  Monchenglad.  Monchenglad.
## 5    Leverkusen    Leverkusen    Leverkusen
## 6     Stuttgart     Stuttgart     Stuttgart
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL12)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1   BORUSSIA D.    34  25     6     3    80    25   14     2     1
## 2 2 BAYERN MUNICH    34  23     4     7    77    22   14     1     2
## 3 3       SCHALKE    34  20     4    10    74    44   13     1     3
## 4 4  MONCHENGLAD.    34  17     9     8    49    24    9     7     1
## 5 5    LEVERKUSEN    34  15     9    10    52    44    8     4     5
## 6 6     STUTTGART    34  15     8    11    63    46   10     3     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      44    12   11     4     2      36    13  81   borussia d.
## 2      49     6    9     3     5      28    16  73 bayern munich
## 3      47    14    7     3     7      27    30  64       schalke
## 4      29    10    8     2     7      20    14  60  monchenglad.
## 5      28    24    7     5     5      24    20  54    leverkusen
## 6      36    17    5     5     7      27    29  53     stuttgart
##           Team3         Team4         Team5
## 1   Borussia D.   Borussia D.   Borussia D.
## 2 Bayern Munich Bayern Munich Bayern Munich
## 3       Schalke       Schalke       Schalke
## 4  Monchenglad.  Monchenglad.  Monchenglad.
## 5    Leverkusen    Leverkusen    Leverkusen
## 6     Stuttgart     Stuttgart     Stuttgart
</code></pre>

<pre><code class="r">names(data_GL12)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df5 &lt;- data_GL12[c(1, 23, 3:8, 19)]

str(df5)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Borussia D.&quot; &quot;Bayern Munich&quot; &quot;Schalke&quot; &quot;Monchenglad.&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 5 5 3 4 2 3 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 5 5 9 9 8 3 6 9 7 ...
##  $ NA..2: Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 11 1 12 1 2 1 6 5 6 ...
##  $ Goals: Factor w/ 15 levels &quot;24&quot;,&quot;35&quot;,&quot;36&quot;,..: 14 13 12 9 10 11 6 8 9 4 ...
##  $ NA..3: Factor w/ 17 levels &quot;22&quot;,&quot;24&quot;,&quot;25&quot;,..: 3 1 4 2 4 6 5 13 12 8 ...
##  $ Pts  : num  81 73 64 60 54 53 48 44 42 42 ...
</code></pre>

<pre><code class="r">head(df5)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Borussia D.    34  25     6     3    80    25  81
## 2 2 Bayern Munich    34  23     4     7    77    22  73
## 3 3       Schalke    34  20     4    10    74    44  64
## 4 4  Monchenglad.    34  17     9     8    49    24  60
## 5 5    Leverkusen    34  15     9    10    52    44  54
## 6 6     Stuttgart    34  15     8    11    63    46  53
</code></pre>

<pre><code class="r">#####Changing the names#####

df5$Aggregate &lt;- paste(df5$Goals, df5$NA..3, sep = &quot;-&quot;)
head(df5)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Borussia D.    34  25     6     3    80    25  81     80-25
## 2 2 Bayern Munich    34  23     4     7    77    22  73     77-22
## 3 3       Schalke    34  20     4    10    74    44  64     74-44
## 4 4  Monchenglad.    34  17     9     8    49    24  60     49-24
## 5 5    Leverkusen    34  15     9    10    52    44  54     52-44
## 6 6     Stuttgart    34  15     8    11    63    46  53     63-46
</code></pre>

<pre><code class="r">df5 &lt;- df5[ ,c(1:6, 10, 9)]
head(df5)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Borussia D.    34  25     6     3     80-25  81
## 2 2 Bayern Munich    34  23     4     7     77-22  73
## 3 3       Schalke    34  20     4    10     74-44  64
## 4 4  Monchenglad.    34  17     9     8     49-24  60
## 5 5    Leverkusen    34  15     9    10     52-44  54
## 6 6     Stuttgart    34  15     8    11     63-46  53
</code></pre>

<pre><code class="r">names(df5) &lt;- names(data_9)
head(df5)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1   Borussia D.    34   25     6    3     80-25     81
## 2     2 Bayern Munich    34   23     4    7     77-22     73
## 3     3       Schalke    34   20     4   10     74-44     64
## 4     4  Monchenglad.    34   17     9    8     49-24     60
## 5     5    Leverkusen    34   15     9   10     52-44     54
## 6     6     Stuttgart    34   15     8   11     63-46     53
</code></pre>

<pre><code class="r">str(df5)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Borussia D.&quot; &quot;Bayern Munich&quot; &quot;Schalke&quot; &quot;Monchenglad.&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 5 5 3 4 2 3 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 5 5 9 9 8 3 6 9 7 ...
##  $ Loss     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 11 1 12 1 2 1 6 5 6 ...
##  $ Aggregate: chr  &quot;80-25&quot; &quot;77-22&quot; &quot;74-44&quot; &quot;49-24&quot; ...
##  $ Points   : num  81 73 64 60 54 53 48 44 42 42 ...
</code></pre>

<pre><code class="r">df5[ ,c(3:6)] &lt;- apply(df5[ ,c(3:6)], 2, as.numeric)

match(df4$Teams, df5$Teams)
</code></pre>

<pre><code>##  [1] NA  5  2  7 13 10 18 15 12 17 11  6  9  3  8 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df4$Teams, df5$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Borussia Dortmund&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Borussia D.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.58823529 0.00000000 0.15384615 0.00000000 0.09090909
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1        Var2   Distance
## 1 Borussia Dortmund Borussia D. 0.58823529
## 2        Leverkusen Borussia D. 0.00000000
## 3     Bayern Munich Borussia D. 0.15384615
## 4          Hannover Borussia D. 0.00000000
## 5             Mainz Borussia D. 0.09090909
## 6          Nurnberg Borussia D. 0.09090909
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 19
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Borusia Dortmund and Borussia D.###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                  Var1          Var2  Distance
## 1   Borussia Dortmund   Borussia D. 0.5882353
## 21      Bayern Munich Bayern Munich 1.0000000
## 50            Schalke       Schalke 1.0000000
## 70    Monchengladbach  Monchenglad. 0.7333333
## 74         Leverkusen    Leverkusen 1.0000000
## 102         Stuttgart     Stuttgart 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1           Var2  Distance
## 2      Bayern Munich  Bayern Munich 1.0000000
## 3            Schalke        Schalke 1.0000000
## 5         Leverkusen     Leverkusen 1.0000000
## 6          Stuttgart      Stuttgart 1.0000000
## 7           Hannover       Hannover 1.0000000
## 8          Wolfsburg      Wolfsburg 1.0000000
## 9      Werder Bremen  Werder Bremen 1.0000000
## 10          Nurnberg       Nurnberg 1.0000000
## 11        Hoffenheim     Hoffenheim 1.0000000
## 12          Freiburg       Freiburg 1.0000000
## 13             Mainz          Mainz 1.0000000
## 17         Hamburger      Hamburger 1.0000000
## 18              Koln           Koln 1.0000000
## 19    Kaiserslautern Kaiserslautern 1.0000000
## 4    Monchengladbach   Monchenglad. 0.7333333
## 1  Borussia Dortmund    Borussia D. 0.5882353
## 16         Wolfsburg       Augsburg 0.5555556
## 14          Nurnberg       Augsburg 0.5000000
## 15          Freiburg       Augsburg 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df5$Teams[df5$Teams == &quot;Monchenglad.&quot;] &lt;- df4$Teams[df4$Teams == &quot;Monchengladbach&quot;]
df5$Teams[df5$Teams == &quot;Borussia D.&quot;] &lt;- df4$Teams[df4$Teams == &quot;Borussia Dortmund&quot;]

###Checking match funtion after the correction
match(df4$Teams, df5$Teams)
</code></pre>

<pre><code>##  [1]  1  5  2  7 13 10 18 15 12 17 11  6  9  3  8  4 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2010-2011: https://en.wikipedia.org/wiki/2010-11_Bundesliga##

#####Manipulating the upper case issue in imported data (data_GL13)#####

#library(dplyr)

head(data_GL13)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 BAYERN MUNICH    34  29     4     1    98    18   14     2     1
## 3  2   BORUSSIA D.    34  19     9     6    81    42   10     3     4
## 4  3    LEVERKUSEN    34  19     8     7    65    39   12     3     2
## 5  4       SCHALKE    34  16     7    11    58    50   10     3     4
## 6  5      FREIBURG    34  14     9    11    45    40    8     4     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      56    11   15     2     0      42     7  91
## 3      40    19    9     6     2      41    23  66
## 4      36    15    7     5     5      29    24  65
## 5      35    22    6     4     7      23    28  55
## 6      25    18    6     5     6      20    22  51
</code></pre>

<pre><code class="r">data_GL13 &lt;- data_GL13[-1 , ]

####Converting teams names to lower case
data_GL13$Team2 &lt;-  tolower(data_GL13$Team)

####Converting the starting letter of the teams names to upper case 
data_GL13$Team3 &lt;- sapply(data_GL13$Team2, simpleCap)

data_GL13$Team4 &lt;- as.factor(data_GL13$Team3)

data_GL13$Team5 &lt;-as.character(data_GL13$Team4)
rownames(data_GL13) &lt;- 1:nrow(data_GL13)
head(data_GL13)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  29     4     1    98    18   14     2     1
## 2 2   BORUSSIA D.    34  19     9     6    81    42   10     3     4
## 3 3    LEVERKUSEN    34  19     8     7    65    39   12     3     2
## 4 4       SCHALKE    34  16     7    11    58    50   10     3     4
## 5 5      FREIBURG    34  14     9    11    45    40    8     4     5
## 6 6  EINTRACHT F.    34  14     9    11    49    46    9     4     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      56    11   15     2     0      42     7  91 bayern munich
## 2      40    19    9     6     2      41    23  66   borussia d.
## 3      36    15    7     5     5      29    24  65    leverkusen
## 4      35    22    6     4     7      23    28  55       schalke
## 5      25    18    6     5     6      20    22  51      freiburg
## 6      32    23    5     5     7      17    23  51  eintracht f.
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2   Borussia D.   Borussia D.   Borussia D.
## 3    Leverkusen    Leverkusen    Leverkusen
## 4       Schalke       Schalke       Schalke
## 5      Freiburg      Freiburg      Freiburg
## 6  Eintracht F.  Eintracht F.  Eintracht F.
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL13)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  29     4     1    98    18   14     2     1
## 2 2   BORUSSIA D.    34  19     9     6    81    42   10     3     4
## 3 3    LEVERKUSEN    34  19     8     7    65    39   12     3     2
## 4 4       SCHALKE    34  16     7    11    58    50   10     3     4
## 5 5      FREIBURG    34  14     9    11    45    40    8     4     5
## 6 6  EINTRACHT F.    34  14     9    11    49    46    9     4     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      56    11   15     2     0      42     7  91 bayern munich
## 2      40    19    9     6     2      41    23  66   borussia d.
## 3      36    15    7     5     5      29    24  65    leverkusen
## 4      35    22    6     4     7      23    28  55       schalke
## 5      25    18    6     5     6      20    22  51      freiburg
## 6      32    23    5     5     7      17    23  51  eintracht f.
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2   Borussia D.   Borussia D.   Borussia D.
## 3    Leverkusen    Leverkusen    Leverkusen
## 4       Schalke       Schalke       Schalke
## 5      Freiburg      Freiburg      Freiburg
## 6  Eintracht F.  Eintracht F.  Eintracht F.
</code></pre>

<pre><code class="r">names(data_GL13)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df6 &lt;- data_GL13[c(1, 23, 3:8, 19)]

str(df6)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Bayern Munich&quot; &quot;Borussia D.&quot; &quot;Leverkusen&quot; &quot;Schalke&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 7 6 5 5 5 3 4 2 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 9 8 7 9 9 6 2 6 2 ...
##  $ NA..2: Factor w/ 13 levels &quot;1&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 11 12 2 2 2 4 2 5 3 ...
##  $ Goals: Factor w/ 15 levels &quot;26&quot;,&quot;33&quot;,&quot;37&quot;,..: 14 13 12 10 6 8 5 6 11 4 ...
##  $ NA..3: Factor w/ 19 levels &quot;18&quot;,&quot;39&quot;,&quot;40&quot;,..: 1 4 2 9 3 6 12 8 16 7 ...
##  $ Pts  : num  91 66 65 55 51 51 48 47 45 44 ...
</code></pre>

<pre><code class="r">head(df6)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Bayern Munich    34  29     4     1    98    18  91
## 2 2   Borussia D.    34  19     9     6    81    42  66
## 3 3    Leverkusen    34  19     8     7    65    39  65
## 4 4       Schalke    34  16     7    11    58    50  55
## 5 5      Freiburg    34  14     9    11    45    40  51
## 6 6  Eintracht F.    34  14     9    11    49    46  51
</code></pre>

<pre><code class="r">#####Changing the names#####

df6$Aggregate &lt;- paste(df6$Goals, df6$NA..3, sep = &quot;-&quot;)
head(df6)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Bayern Munich    34  29     4     1    98    18  91     98-18
## 2 2   Borussia D.    34  19     9     6    81    42  66     81-42
## 3 3    Leverkusen    34  19     8     7    65    39  65     65-39
## 4 4       Schalke    34  16     7    11    58    50  55     58-50
## 5 5      Freiburg    34  14     9    11    45    40  51     45-40
## 6 6  Eintracht F.    34  14     9    11    49    46  51     49-46
</code></pre>

<pre><code class="r">df6 &lt;- df6[ ,c(1:6, 10, 9)]
head(df6)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Bayern Munich    34  29     4     1     98-18  91
## 2 2   Borussia D.    34  19     9     6     81-42  66
## 3 3    Leverkusen    34  19     8     7     65-39  65
## 4 4       Schalke    34  16     7    11     58-50  55
## 5 5      Freiburg    34  14     9    11     45-40  51
## 6 6  Eintracht F.    34  14     9    11     49-46  51
</code></pre>

<pre><code class="r">names(df6) &lt;- names(data_9)
head(df6)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Bayern Munich    34   29     4    1     98-18     91
## 2     2   Borussia D.    34   19     9    6     81-42     66
## 3     3    Leverkusen    34   19     8    7     65-39     65
## 4     4       Schalke    34   16     7   11     58-50     55
## 5     5      Freiburg    34   14     9   11     45-40     51
## 6     6  Eintracht F.    34   14     9   11     49-46     51
</code></pre>

<pre><code class="r">str(df6)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Bayern Munich&quot; &quot;Borussia D.&quot; &quot;Leverkusen&quot; &quot;Schalke&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 7 6 5 5 5 3 4 2 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 9 8 7 9 9 6 2 6 2 ...
##  $ Loss     : Factor w/ 13 levels &quot;1&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 11 12 2 2 2 4 2 5 3 ...
##  $ Aggregate: chr  &quot;98-18&quot; &quot;81-42&quot; &quot;65-39&quot; &quot;58-50&quot; ...
##  $ Points   : num  91 66 65 55 51 51 48 47 45 44 ...
</code></pre>

<pre><code class="r">df6[ ,c(3:6)] &lt;- apply(df6[ ,c(3:6)], 2, as.numeric)

match(df5$Teams, df6$Teams)
</code></pre>

<pre><code>##  [1] NA  1  4 NA  3 12  9 11 14 10 16  5 13 15  7 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df5$Teams, df6$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Borussia Dortmund&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.1176471 1.0000000 0.0000000 0.2000000 0.2307692
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1          Var2  Distance
## 1 Borussia Dortmund Bayern Munich 0.1176471
## 2     Bayern Munich Bayern Munich 1.0000000
## 3           Schalke Bayern Munich 0.0000000
## 4   Monchengladbach Bayern Munich 0.2000000
## 5        Leverkusen Bayern Munich 0.2307692
## 6         Stuttgart Bayern Munich 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Borusia Dortmund and Borussia D.###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 2      Bayern Munich Bayern Munich 1.0000000
## 19 Borussia Dortmund   Borussia D. 0.5882353
## 41        Leverkusen    Leverkusen 1.0000000
## 57           Schalke       Schalke 1.0000000
## 84          Freiburg      Freiburg 1.0000000
## 86          Augsburg      Freiburg 0.5000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 1      Bayern Munich Bayern Munich 1.0000000
## 3         Leverkusen    Leverkusen 1.0000000
## 4            Schalke       Schalke 1.0000000
## 5           Freiburg      Freiburg 1.0000000
## 7          Hamburger     Hamburger 1.0000000
## 9           Hannover      Hannover 1.0000000
## 10          Nurnberg      Nurnberg 1.0000000
## 12         Wolfsburg     Wolfsburg 1.0000000
## 14         Stuttgart     Stuttgart 1.0000000
## 15             Mainz         Mainz 1.0000000
## 16     Werder Bremen Werder Bremen 1.0000000
## 20          Augsburg      Augsburg 1.0000000
## 21        Hoffenheim    Hoffenheim 1.0000000
## 8    Monchengladbach  Monchenglad. 0.7333333
## 2  Borussia Dortmund   Borussia D. 0.5882353
## 13          Augsburg     Wolfsburg 0.5555556
## 17         Wolfsburg      Augsburg 0.5555556
## 6           Augsburg      Freiburg 0.5000000
## 11          Augsburg      Nurnberg 0.5000000
## 18          Nurnberg      Augsburg 0.5000000
## 19          Freiburg      Augsburg 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df6$Teams[df6$Teams == &quot;Monchenglad.&quot;] &lt;- df5$Teams[df5$Teams == &quot;Monchengladbach&quot;]
df6$Teams[df6$Teams == &quot;Borussia D.&quot;] &lt;- df5$Teams[df5$Teams == &quot;Borussia Dortmund&quot;]

###Checking match funtion after the correction
match(df5$Teams, df6$Teams)
</code></pre>

<pre><code>##  [1]  2  1  4  8  3 12  9 11 14 10 16  5 13 15  7 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2011-2012: https://en.wikipedia.org/wiki/2011-12_Bundesliga##

#####Manipulating the upper case issue in imported data (data_GL14)#####

#library(dplyr)

head(data_GL14)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 BAYERN MUNICH    34  29     3     2    94    23   15     1     1
## 3  2   BORUSSIA D.    34  22     5     7    80    38   11     2     4
## 4  3       SCHALKE    34  19     7     8    63    43   12     2     3
## 5  4    LEVERKUSEN    34  19     4    11    60    41   10     3     4
## 6  5     WOLFSBURG    34  18     6    10    63    50   11     3     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      48    15   14     2     1      46     8  90
## 3      41    19   11     3     3      39    19  71
## 4      37    16    7     5     5      26    27  64
## 5      35    22    9     1     7      25    19  61
## 6      37    22    7     3     7      26    28  60
</code></pre>

<pre><code class="r">data_GL14 &lt;- data_GL14[-1 , ]

####Converting teams names to lower case
data_GL14$Team2 &lt;-  tolower(data_GL14$Team)

####Converting the starting letter of the teams names to upper case 
data_GL14$Team3 &lt;- sapply(data_GL14$Team2, simpleCap)

data_GL14$Team4 &lt;- as.factor(data_GL14$Team3)

data_GL14$Team5 &lt;-as.character(data_GL14$Team4)
rownames(data_GL14) &lt;- 1:nrow(data_GL14)
head(data_GL14)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  29     3     2    94    23   15     1     1
## 2 2   BORUSSIA D.    34  22     5     7    80    38   11     2     4
## 3 3       SCHALKE    34  19     7     8    63    43   12     2     3
## 4 4    LEVERKUSEN    34  19     4    11    60    41   10     3     4
## 5 5     WOLFSBURG    34  18     6    10    63    50   11     3     3
## 6 6  MONCHENGLAD.    34  16     7    11    59    43   11     3     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      48    15   14     2     1      46     8  90 bayern munich
## 2      41    19   11     3     3      39    19  71   borussia d.
## 3      37    16    7     5     5      26    27  64       schalke
## 4      35    22    9     1     7      25    19  61    leverkusen
## 5      37    22    7     3     7      26    28  60     wolfsburg
## 6      38    17    5     4     8      21    26  55  monchenglad.
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2   Borussia D.   Borussia D.   Borussia D.
## 3       Schalke       Schalke       Schalke
## 4    Leverkusen    Leverkusen    Leverkusen
## 5     Wolfsburg     Wolfsburg     Wolfsburg
## 6  Monchenglad.  Monchenglad.  Monchenglad.
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL14)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  29     3     2    94    23   15     1     1
## 2 2   BORUSSIA D.    34  22     5     7    80    38   11     2     4
## 3 3       SCHALKE    34  19     7     8    63    43   12     2     3
## 4 4    LEVERKUSEN    34  19     4    11    60    41   10     3     4
## 5 5     WOLFSBURG    34  18     6    10    63    50   11     3     3
## 6 6  MONCHENGLAD.    34  16     7    11    59    43   11     3     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      48    15   14     2     1      46     8  90 bayern munich
## 2      41    19   11     3     3      39    19  71   borussia d.
## 3      37    16    7     5     5      26    27  64       schalke
## 4      35    22    9     1     7      25    19  61    leverkusen
## 5      37    22    7     3     7      26    28  60     wolfsburg
## 6      38    17    5     4     8      21    26  55  monchenglad.
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2   Borussia D.   Borussia D.   Borussia D.
## 3       Schalke       Schalke       Schalke
## 4    Leverkusen    Leverkusen    Leverkusen
## 5     Wolfsburg     Wolfsburg     Wolfsburg
## 6  Monchenglad.  Monchenglad.  Monchenglad.
</code></pre>

<pre><code class="r">names(data_GL14)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df7 &lt;- data_GL14[c(1, 23, 3:8, 19)]

str(df7)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Bayern Munich&quot; &quot;Borussia D.&quot; &quot;Schalke&quot; &quot;Leverkusen&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 7 6 5 5 4 2 3 ...
##  $ NA..1: Factor w/ 9 levels &quot;11&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,..: 2 4 6 3 5 6 4 6 1 5 ...
##  $ NA..2: Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 10 11 2 1 2 4 3 3 6 ...
##  $ Goals: Factor w/ 17 levels &quot;29&quot;,&quot;37&quot;,&quot;40&quot;,..: 16 15 13 12 13 11 10 7 14 6 ...
##  $ NA..3: Factor w/ 17 levels &quot;23&quot;,&quot;38&quot;,&quot;41&quot;,..: 1 2 4 3 7 4 8 5 15 10 ...
##  $ Pts  : num  90 71 64 61 60 55 53 52 44 42 ...
</code></pre>

<pre><code class="r">head(df7)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Bayern Munich    34  29     3     2    94    23  90
## 2 2   Borussia D.    34  22     5     7    80    38  71
## 3 3       Schalke    34  19     7     8    63    43  64
## 4 4    Leverkusen    34  19     4    11    60    41  61
## 5 5     Wolfsburg    34  18     6    10    63    50  60
## 6 6  Monchenglad.    34  16     7    11    59    43  55
</code></pre>

<pre><code class="r">#####Changing the names#####

df7$Aggregate &lt;- paste(df7$Goals, df7$NA..3, sep = &quot;-&quot;)
head(df7)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Bayern Munich    34  29     3     2    94    23  90     94-23
## 2 2   Borussia D.    34  22     5     7    80    38  71     80-38
## 3 3       Schalke    34  19     7     8    63    43  64     63-43
## 4 4    Leverkusen    34  19     4    11    60    41  61     60-41
## 5 5     Wolfsburg    34  18     6    10    63    50  60     63-50
## 6 6  Monchenglad.    34  16     7    11    59    43  55     59-43
</code></pre>

<pre><code class="r">df7 &lt;- df7[ ,c(1:6, 10, 9)]
head(df7)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Bayern Munich    34  29     3     2     94-23  90
## 2 2   Borussia D.    34  22     5     7     80-38  71
## 3 3       Schalke    34  19     7     8     63-43  64
## 4 4    Leverkusen    34  19     4    11     60-41  61
## 5 5     Wolfsburg    34  18     6    10     63-50  60
## 6 6  Monchenglad.    34  16     7    11     59-43  55
</code></pre>

<pre><code class="r">names(df7) &lt;- names(data_9)
head(df7)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Bayern Munich    34   29     3    2     94-23     90
## 2     2   Borussia D.    34   22     5    7     80-38     71
## 3     3       Schalke    34   19     7    8     63-43     64
## 4     4    Leverkusen    34   19     4   11     60-41     61
## 5     5     Wolfsburg    34   18     6   10     63-50     60
## 6     6  Monchenglad.    34   16     7   11     59-43     55
</code></pre>

<pre><code class="r">str(df7)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Bayern Munich&quot; &quot;Borussia D.&quot; &quot;Schalke&quot; &quot;Leverkusen&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 7 6 5 5 4 2 3 ...
##  $ Draws    : Factor w/ 9 levels &quot;11&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,..: 2 4 6 3 5 6 4 6 1 5 ...
##  $ Loss     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 10 11 2 1 2 4 3 3 6 ...
##  $ Aggregate: chr  &quot;94-23&quot; &quot;80-38&quot; &quot;63-43&quot; &quot;60-41&quot; ...
##  $ Points   : num  90 71 64 61 60 55 53 52 44 42 ...
</code></pre>

<pre><code class="r">df7[ ,c(3:6)] &lt;- apply(df7[ ,c(3:6)], 2, as.numeric)

match(df6$Teams, df7$Teams)
</code></pre>

<pre><code>##  [1]  1 NA  4  3 14 13 16 NA 10 17  5 15  7 12  8  9 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df6$Teams, df7$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.0000000 0.1176471 0.2307692 0.0000000 0.1538462
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1          Var2   Distance
## 1     Bayern Munich Bayern Munich 1.00000000
## 2 Borussia Dortmund Bayern Munich 0.11764706
## 3        Leverkusen Bayern Munich 0.23076923
## 4           Schalke Bayern Munich 0.00000000
## 5          Freiburg Bayern Munich 0.15384615
## 6      Eintracht F. Bayern Munich 0.07692308
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 22
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Borusia Dortmund and Borussia D.###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 1      Bayern Munich Bayern Munich 1.0000000
## 20 Borussia Dortmund   Borussia D. 0.5882353
## 40           Schalke       Schalke 1.0000000
## 57        Leverkusen    Leverkusen 1.0000000
## 83         Wolfsburg     Wolfsburg 1.0000000
## 87          Augsburg     Wolfsburg 0.5555556
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 1      Bayern Munich Bayern Munich 1.0000000
## 3            Schalke       Schalke 1.0000000
## 4         Leverkusen    Leverkusen 1.0000000
## 5          Wolfsburg     Wolfsburg 1.0000000
## 8              Mainz         Mainz 1.0000000
## 12          Augsburg      Augsburg 1.0000000
## 13        Hoffenheim    Hoffenheim 1.0000000
## 14          Hannover      Hannover 1.0000000
## 15     Werder Bremen Werder Bremen 1.0000000
## 16      Eintracht F.  Eintracht F. 1.0000000
## 17          Freiburg      Freiburg 1.0000000
## 19         Stuttgart     Stuttgart 1.0000000
## 20         Hamburger     Hamburger 1.0000000
## 21          Nurnberg      Nurnberg 1.0000000
## 7    Monchengladbach  Monchenglad. 0.7333333
## 2  Borussia Dortmund   Borussia D. 0.5882353
## 6           Augsburg     Wolfsburg 0.5555556
## 11         Wolfsburg      Augsburg 0.5555556
## 9           Freiburg      Augsburg 0.5000000
## 10          Nurnberg      Augsburg 0.5000000
## 18          Augsburg      Freiburg 0.5000000
## 22          Augsburg      Nurnberg 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df7$Teams[df7$Teams == &quot;Monchenglad.&quot;] &lt;- df6$Teams[df6$Teams == &quot;Monchengladbach&quot;]
df7$Teams[df7$Teams == &quot;Borussia D.&quot;] &lt;- df6$Teams[df6$Teams == &quot;Borussia Dortmund&quot;]

###Checking match funtion after the correction
match(df6$Teams, df7$Teams)
</code></pre>

<pre><code>##  [1]  1  2  4  3 14 13 16  6 10 17  5 15  7 12  8  9 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2012-2013: https://en.wikipedia.org/wiki/2012-13_Bundesliga##

#####Manipulating the upper case issue in imported data (data_GL15)#####

#library(dplyr)

head(data_GL15)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 BAYERN MUNICH    34  25     4     5    80    18   14     1     2
## 3  2     WOLFSBURG    34  20     9     5    72    38   13     4     0
## 4  3  MONCHENGLAD.    34  19     9     6    53    26   12     3     2
## 5  4    LEVERKUSEN    34  17    10     7    62    37   10     6     1
## 6  5      AUGSBURG    34  15     4    15    43    43    9     4     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      46     7   11     3     3      34    11  79
## 3      38    13    7     5     5      34    25  69
## 4      32    14    7     6     4      21    12  66
## 5      39    15    7     4     6      23    22  61
## 6      28    21    6     0    11      15    22  49
</code></pre>

<pre><code class="r">data_GL15 &lt;- data_GL15[-1 , ]

####Converting teams names to lower case
data_GL15$Team2 &lt;-  tolower(data_GL15$Team)

####Converting the starting letter of the teams names to upper case 
data_GL15$Team3 &lt;- sapply(data_GL15$Team2, simpleCap)

data_GL15$Team4 &lt;- as.factor(data_GL15$Team3)

data_GL15$Team5 &lt;-as.character(data_GL15$Team4)
rownames(data_GL15) &lt;- 1:nrow(data_GL15)
head(data_GL15)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  25     4     5    80    18   14     1     2
## 2 2     WOLFSBURG    34  20     9     5    72    38   13     4     0
## 3 3  MONCHENGLAD.    34  19     9     6    53    26   12     3     2
## 4 4    LEVERKUSEN    34  17    10     7    62    37   10     6     1
## 5 5      AUGSBURG    34  15     4    15    43    43    9     4     4
## 6 6       SCHALKE    34  13     9    12    42    40   10     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      46     7   11     3     3      34    11  79 bayern munich
## 2      38    13    7     5     5      34    25  69     wolfsburg
## 3      32    14    7     6     4      21    12  66  monchenglad.
## 4      39    15    7     4     6      23    22  61    leverkusen
## 5      28    21    6     0    11      15    22  49      augsburg
## 6      26    14    3     4    10      16    26  48       schalke
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2     Wolfsburg     Wolfsburg     Wolfsburg
## 3  Monchenglad.  Monchenglad.  Monchenglad.
## 4    Leverkusen    Leverkusen    Leverkusen
## 5      Augsburg      Augsburg      Augsburg
## 6       Schalke       Schalke       Schalke
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL15)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  25     4     5    80    18   14     1     2
## 2 2     WOLFSBURG    34  20     9     5    72    38   13     4     0
## 3 3  MONCHENGLAD.    34  19     9     6    53    26   12     3     2
## 4 4    LEVERKUSEN    34  17    10     7    62    37   10     6     1
## 5 5      AUGSBURG    34  15     4    15    43    43    9     4     4
## 6 6       SCHALKE    34  13     9    12    42    40   10     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      46     7   11     3     3      34    11  79 bayern munich
## 2      38    13    7     5     5      34    25  69     wolfsburg
## 3      32    14    7     6     4      21    12  66  monchenglad.
## 4      39    15    7     4     6      23    22  61    leverkusen
## 5      28    21    6     0    11      15    22  49      augsburg
## 6      26    14    3     4    10      16    26  48       schalke
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2     Wolfsburg     Wolfsburg     Wolfsburg
## 3  Monchenglad.  Monchenglad.  Monchenglad.
## 4    Leverkusen    Leverkusen    Leverkusen
## 5      Augsburg      Augsburg      Augsburg
## 6       Schalke       Schalke       Schalke
</code></pre>

<pre><code class="r">names(data_GL15)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df8 &lt;- data_GL15[c(1, 23, 3:8, 19)]

str(df8)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Bayern Munich&quot; &quot;Wolfsburg&quot; &quot;Monchenglad.&quot; &quot;Leverkusen&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 11 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 7 6 5 4 3 3 2 1 1 ...
##  $ NA..1: Factor w/ 7 levels &quot;10&quot;,&quot;13&quot;,&quot;4&quot;,..: 3 6 6 1 3 6 4 5 1 1 ...
##  $ NA..2: Factor w/ 10 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 7 7 8 9 4 1 3 3 2 2 ...
##  $ Goals: Factor w/ 17 levels &quot;25&quot;,&quot;31&quot;,&quot;34&quot;,..: 16 15 12 14 7 6 9 10 13 11 ...
##  $ NA..3: Factor w/ 16 levels &quot;18&quot;,&quot;26&quot;,&quot;37&quot;,..: 1 4 2 3 7 5 6 11 14 15 ...
##  $ Pts  : num  79 69 66 61 49 48 46 44 43 43 ...
</code></pre>

<pre><code class="r">head(df8)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Bayern Munich    34  25     4     5    80    18  79
## 2 2     Wolfsburg    34  20     9     5    72    38  69
## 3 3  Monchenglad.    34  19     9     6    53    26  66
## 4 4    Leverkusen    34  17    10     7    62    37  61
## 5 5      Augsburg    34  15     4    15    43    43  49
## 6 6       Schalke    34  13     9    12    42    40  48
</code></pre>

<pre><code class="r">#####Changing the names#####

df8$Aggregate &lt;- paste(df8$Goals, df8$NA..3, sep = &quot;-&quot;)
head(df8)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Bayern Munich    34  25     4     5    80    18  79     80-18
## 2 2     Wolfsburg    34  20     9     5    72    38  69     72-38
## 3 3  Monchenglad.    34  19     9     6    53    26  66     53-26
## 4 4    Leverkusen    34  17    10     7    62    37  61     62-37
## 5 5      Augsburg    34  15     4    15    43    43  49     43-43
## 6 6       Schalke    34  13     9    12    42    40  48     42-40
</code></pre>

<pre><code class="r">df8 &lt;- df8[ ,c(1:6, 10, 9)]
head(df8)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Bayern Munich    34  25     4     5     80-18  79
## 2 2     Wolfsburg    34  20     9     5     72-38  69
## 3 3  Monchenglad.    34  19     9     6     53-26  66
## 4 4    Leverkusen    34  17    10     7     62-37  61
## 5 5      Augsburg    34  15     4    15     43-43  49
## 6 6       Schalke    34  13     9    12     42-40  48
</code></pre>

<pre><code class="r">names(df8) &lt;- names(data_9)
head(df8)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Bayern Munich    34   25     4    5     80-18     79
## 2     2     Wolfsburg    34   20     9    5     72-38     69
## 3     3  Monchenglad.    34   19     9    6     53-26     66
## 4     4    Leverkusen    34   17    10    7     62-37     61
## 5     5      Augsburg    34   15     4   15     43-43     49
## 6     6       Schalke    34   13     9   12     42-40     48
</code></pre>

<pre><code class="r">str(df8)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Bayern Munich&quot; &quot;Wolfsburg&quot; &quot;Monchenglad.&quot; &quot;Leverkusen&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 11 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 7 6 5 4 3 3 2 1 1 ...
##  $ Draws    : Factor w/ 7 levels &quot;10&quot;,&quot;13&quot;,&quot;4&quot;,..: 3 6 6 1 3 6 4 5 1 1 ...
##  $ Loss     : Factor w/ 10 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 7 7 8 9 4 1 3 3 2 2 ...
##  $ Aggregate: chr  &quot;80-18&quot; &quot;72-38&quot; &quot;53-26&quot; &quot;62-37&quot; ...
##  $ Points   : num  79 69 66 61 49 48 46 44 43 43 ...
</code></pre>

<pre><code class="r">df8[ ,c(3:6)] &lt;- apply(df8[ ,c(3:6)], 2, as.numeric)

match(df7$Teams, df8$Teams)
</code></pre>

<pre><code>##  [1]  1 NA  6  4  2 NA 11  5  8 13 15 10  9 17 14 16 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df7$Teams, df8$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00000000 0.11764706 0.00000000 0.23076923 0.07692308
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                Var1          Var2   Distance
## 1     Bayern Munich Bayern Munich 1.00000000
## 2 Borussia Dortmund Bayern Munich 0.11764706
## 3           Schalke Bayern Munich 0.00000000
## 4        Leverkusen Bayern Munich 0.23076923
## 5         Wolfsburg Bayern Munich 0.07692308
## 6   Monchengladbach Bayern Munich 0.20000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Borusia Dortmund and Borussia D.###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##               Var1          Var2  Distance
## 1    Bayern Munich Bayern Munich 1.0000000
## 23       Wolfsburg     Wolfsburg 1.0000000
## 26        Augsburg     Wolfsburg 0.5555556
## 42 Monchengladbach  Monchenglad. 0.7333333
## 58      Leverkusen    Leverkusen 1.0000000
## 77       Wolfsburg      Augsburg 0.5555556
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 1      Bayern Munich Bayern Munich 1.0000000
## 2          Wolfsburg     Wolfsburg 1.0000000
## 5         Leverkusen    Leverkusen 1.0000000
## 7           Augsburg      Augsburg 1.0000000
## 10           Schalke       Schalke 1.0000000
## 12        Hoffenheim    Hoffenheim 1.0000000
## 13      Eintracht F.  Eintracht F. 1.0000000
## 14     Werder Bremen Werder Bremen 1.0000000
## 15             Mainz         Mainz 1.0000000
## 16          Hannover      Hannover 1.0000000
## 17         Stuttgart     Stuttgart 1.0000000
## 18            Hertha        Hertha 1.0000000
## 19         Hamburger     Hamburger 1.0000000
## 21          Freiburg      Freiburg 1.0000000
## 4    Monchengladbach  Monchenglad. 0.7333333
## 11 Borussia Dortmund   Borussia D. 0.5882353
## 3           Augsburg     Wolfsburg 0.5555556
## 6          Wolfsburg      Augsburg 0.5555556
## 8           Freiburg      Augsburg 0.5000000
## 9           Nurnberg      Augsburg 0.5000000
## 20          Augsburg      Freiburg 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df8$Teams[df8$Teams == &quot;Monchenglad.&quot;] &lt;- df7$Teams[df7$Teams == &quot;Monchengladbach&quot;]
df8$Teams[df8$Teams == &quot;Borussia D.&quot;] &lt;- df7$Teams[df7$Teams == &quot;Borussia Dortmund&quot;]

###Checking match funtion after the correction
match(df7$Teams, df8$Teams)
</code></pre>

<pre><code>##  [1]  1  7  6  4  2  3 11  5  8 13 15 10  9 17 14 16 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2013-2014: https://en.wikipedia.org/wiki/2013-14_Bundesliga##

#####Manipulating the upper case issue in imported data (data_GL16)#####

#library(dplyr)

head(data_GL16)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 BAYERN MUNICH    34  28     4     2    80    17   15     1     1
## 3  2   BORUSSIA D.    34  24     6     4    82    34   14     3     0
## 4  3    LEVERKUSEN    34  18     6    10    56    40   10     3     4
## 5  4  MONCHENGLAD.    34  17     4    13    67    50   13     1     3
## 6  5       SCHALKE    34  15     7    12    51    49    8     5     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      51     8   13     3     1      29     9  88
## 3      49    14   10     3     4      33    20  78
## 4      31    17    8     3     6      25    23  60
## 5      42    18    4     3    10      25    32  55
## 6      28    24    7     2     8      23    25  52
</code></pre>

<pre><code class="r">data_GL16 &lt;- data_GL16[-1 , ]

####Converting teams names to lower case
data_GL16$Team2 &lt;-  tolower(data_GL16$Team)

####Converting the starting letter of the teams names to upper case 
data_GL16$Team3 &lt;- sapply(data_GL16$Team2, simpleCap)

data_GL16$Team4 &lt;- as.factor(data_GL16$Team3)

data_GL16$Team5 &lt;-as.character(data_GL16$Team4)
rownames(data_GL16) &lt;- 1:nrow(data_GL16)
head(data_GL16)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  28     4     2    80    17   15     1     1
## 2 2   BORUSSIA D.    34  24     6     4    82    34   14     3     0
## 3 3    LEVERKUSEN    34  18     6    10    56    40   10     3     4
## 4 4  MONCHENGLAD.    34  17     4    13    67    50   13     1     3
## 5 5       SCHALKE    34  15     7    12    51    49    8     5     4
## 6 6         MAINZ    34  14     8    12    46    42    8     4     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      51     8   13     3     1      29     9  88 bayern munich
## 2      49    14   10     3     4      33    20  78   borussia d.
## 3      31    17    8     3     6      25    23  60    leverkusen
## 4      42    18    4     3    10      25    32  55  monchenglad.
## 5      28    24    7     2     8      23    25  52       schalke
## 6      23    18    6     4     7      23    24  50         mainz
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2   Borussia D.   Borussia D.   Borussia D.
## 3    Leverkusen    Leverkusen    Leverkusen
## 4  Monchenglad.  Monchenglad.  Monchenglad.
## 5       Schalke       Schalke       Schalke
## 6         Mainz         Mainz         Mainz
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GL16)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 BAYERN MUNICH    34  28     4     2    80    17   15     1     1
## 2 2   BORUSSIA D.    34  24     6     4    82    34   14     3     0
## 3 3    LEVERKUSEN    34  18     6    10    56    40   10     3     4
## 4 4  MONCHENGLAD.    34  17     4    13    67    50   13     1     3
## 5 5       SCHALKE    34  15     7    12    51    49    8     5     4
## 6 6         MAINZ    34  14     8    12    46    42    8     4     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      51     8   13     3     1      29     9  88 bayern munich
## 2      49    14   10     3     4      33    20  78   borussia d.
## 3      31    17    8     3     6      25    23  60    leverkusen
## 4      42    18    4     3    10      25    32  55  monchenglad.
## 5      28    24    7     2     8      23    25  52       schalke
## 6      23    18    6     4     7      23    24  50         mainz
##           Team3         Team4         Team5
## 1 Bayern Munich Bayern Munich Bayern Munich
## 2   Borussia D.   Borussia D.   Borussia D.
## 3    Leverkusen    Leverkusen    Leverkusen
## 4  Monchenglad.  Monchenglad.  Monchenglad.
## 5       Schalke       Schalke       Schalke
## 6         Mainz         Mainz         Mainz
</code></pre>

<pre><code class="r">names(data_GL16)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df9 &lt;- data_GL16[c(1, 23, 3:8, 19)]

str(df9)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Bayern Munich&quot; &quot;Borussia D.&quot; &quot;Leverkusen&quot; &quot;Monchenglad.&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 5 4 4 3 1 2 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 4 5 5 4 6 7 7 8 3 7 ...
##  $ NA..2: Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 11 1 4 3 3 3 4 2 6 ...
##  $ Goals: Factor w/ 16 levels &quot;31&quot;,&quot;33&quot;,&quot;34&quot;,..: 14 15 12 13 11 8 7 9 4 6 ...
##  $ NA..3: Factor w/ 14 levels &quot;17&quot;,&quot;34&quot;,&quot;40&quot;,..: 1 2 3 7 6 4 4 6 4 5 ...
##  $ Pts  : num  88 78 60 55 52 50 50 45 43 41 ...
</code></pre>

<pre><code class="r">head(df9)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Bayern Munich    34  28     4     2    80    17  88
## 2 2   Borussia D.    34  24     6     4    82    34  78
## 3 3    Leverkusen    34  18     6    10    56    40  60
## 4 4  Monchenglad.    34  17     4    13    67    50  55
## 5 5       Schalke    34  15     7    12    51    49  52
## 6 6         Mainz    34  14     8    12    46    42  50
</code></pre>

<pre><code class="r">#####Changing the names#####

df9$Aggregate &lt;- paste(df9$Goals, df9$NA..3, sep = &quot;-&quot;)
head(df9)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Bayern Munich    34  28     4     2    80    17  88     80-17
## 2 2   Borussia D.    34  24     6     4    82    34  78     82-34
## 3 3    Leverkusen    34  18     6    10    56    40  60     56-40
## 4 4  Monchenglad.    34  17     4    13    67    50  55     67-50
## 5 5       Schalke    34  15     7    12    51    49  52     51-49
## 6 6         Mainz    34  14     8    12    46    42  50     46-42
</code></pre>

<pre><code class="r">df9 &lt;- df9[ ,c(1:6, 10, 9)]
head(df9)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Bayern Munich    34  28     4     2     80-17  88
## 2 2   Borussia D.    34  24     6     4     82-34  78
## 3 3    Leverkusen    34  18     6    10     56-40  60
## 4 4  Monchenglad.    34  17     4    13     67-50  55
## 5 5       Schalke    34  15     7    12     51-49  52
## 6 6         Mainz    34  14     8    12     46-42  50
</code></pre>

<pre><code class="r">names(df9) &lt;- names(data_9)
head(df9)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Bayern Munich    34   28     4    2     80-17     88
## 2     2   Borussia D.    34   24     6    4     82-34     78
## 3     3    Leverkusen    34   18     6   10     56-40     60
## 4     4  Monchenglad.    34   17     4   13     67-50     55
## 5     5       Schalke    34   15     7   12     51-49     52
## 6     6         Mainz    34   14     8   12     46-42     50
</code></pre>

<pre><code class="r">str(df9)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Bayern Munich&quot; &quot;Borussia D.&quot; &quot;Leverkusen&quot; &quot;Monchenglad.&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 5 4 4 3 1 2 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 4 5 5 4 6 7 7 8 3 7 ...
##  $ Loss     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 11 1 4 3 3 3 4 2 6 ...
##  $ Aggregate: chr  &quot;80-17&quot; &quot;82-34&quot; &quot;56-40&quot; &quot;67-50&quot; ...
##  $ Points   : num  88 78 60 55 52 50 50 45 43 41 ...
</code></pre>

<pre><code class="r">df9[ ,c(3:6)] &lt;- apply(df9[ ,c(3:6)], 2, as.numeric)

match(df8$Teams, df9$Teams)
</code></pre>

<pre><code>##  [1]  1  8 NA  3 12  5 NA 15 16 13  6  9 18 17  7 10 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df8$Teams, df9$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Bayern Munich&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00000000 0.07692308 0.20000000 0.23076923 0.07692308
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##              Var1          Var2   Distance
## 1   Bayern Munich Bayern Munich 1.00000000
## 2       Wolfsburg Bayern Munich 0.07692308
## 3 Monchengladbach Bayern Munich 0.20000000
## 4      Leverkusen Bayern Munich 0.23076923
## 5        Augsburg Bayern Munich 0.07692308
## 6         Schalke Bayern Munich 0.00000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 19
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Borusia Dortmund and Borussia D.###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                  Var1          Var2  Distance
## 1       Bayern Munich Bayern Munich 1.0000000
## 25  Borussia Dortmund   Borussia D. 0.5882353
## 40         Leverkusen    Leverkusen 1.0000000
## 57    Monchengladbach  Monchenglad. 0.7333333
## 78            Schalke       Schalke 1.0000000
## 101             Mainz         Mainz 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                 Var1          Var2  Distance
## 1      Bayern Munich Bayern Munich 1.0000000
## 3         Leverkusen    Leverkusen 1.0000000
## 5            Schalke       Schalke 1.0000000
## 6              Mainz         Mainz 1.0000000
## 7             Hertha        Hertha 1.0000000
## 8          Wolfsburg     Wolfsburg 1.0000000
## 10              Koln          Koln 1.0000000
## 11         Hamburger     Hamburger 1.0000000
## 13          Augsburg      Augsburg 1.0000000
## 15     Werder Bremen Werder Bremen 1.0000000
## 16        Hoffenheim    Hoffenheim 1.0000000
## 17      Eintracht F.  Eintracht F. 1.0000000
## 18         Stuttgart     Stuttgart 1.0000000
## 19          Hannover      Hannover 1.0000000
## 4    Monchengladbach  Monchenglad. 0.7333333
## 2  Borussia Dortmund   Borussia D. 0.5882353
## 9           Augsburg     Wolfsburg 0.5555556
## 12         Wolfsburg      Augsburg 0.5555556
## 14          Freiburg      Augsburg 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df9$Teams[df9$Teams == &quot;Monchenglad.&quot;] &lt;- df7$Teams[df7$Teams == &quot;Monchengladbach&quot;]
df9$Teams[df9$Teams == &quot;Borussia D.&quot;] &lt;- df7$Teams[df7$Teams == &quot;Borussia Dortmund&quot;]

###Checking match funtion after the correction
match(df8$Teams, df9$Teams)
</code></pre>

<pre><code>##  [1]  1  8  4  3 12  5  2 15 16 13  6  9 18 17  7 10 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2013-2014: https://en.wikipedia.org/wiki/2014-15_Bundesliga##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_ITL09)#####
####ITL09 = Italian League season 2008-2009####

library(dplyr)

head(data_ITL09)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1      INTER    38  25     9     4    70    32   14     5     0      37
## 3  2   JUVENTUS    38  21    11     6    69    37   11     6     2      38
## 4  3      MILAN    38  22     8     8    70    35   14     3     2      39
## 5  4 FIORENTINA    38  21     5    12    53    38   14     2     3      29
## 6  5      GENOA    38  19    11     8    56    39   12     5     2      39
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    16   11     4     4      33    16  84
## 3    19   10     5     4      31    18  74
## 4    12    8     5     6      31    23  74
## 5    14    7     3     9      24    24  68
## 6    19    7     6     6      17    20  68
</code></pre>

<pre><code class="r">data_ITL09 &lt;- data_ITL09[-1 , ]

####Converting teams names to lower case
data_ITL09$Team2 &lt;-  tolower(data_ITL09$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL09$Team3 &lt;- sapply(data_ITL09$Team2, simpleCap)

data_ITL09$Team4 &lt;- as.factor(data_ITL09$Team3)

data_ITL09$Team5 &lt;-as.character(data_ITL09$Team4)
rownames(data_ITL09) &lt;- 1:nrow(data_ITL09)
head(data_ITL09)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      INTER    38  25     9     4    70    32   14     5     0      37
## 2 2   JUVENTUS    38  21    11     6    69    37   11     6     2      38
## 3 3      MILAN    38  22     8     8    70    35   14     3     2      39
## 4 4 FIORENTINA    38  21     5    12    53    38   14     2     3      29
## 5 5      GENOA    38  19    11     8    56    39   12     5     2      39
## 6 6       ROMA    38  18     9    11    64    61   13     4     2      35
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    16   11     4     4      33    16  84      inter      Inter
## 2    19   10     5     4      31    18  74   juventus   Juventus
## 3    12    8     5     6      31    23  74      milan      Milan
## 4    14    7     3     9      24    24  68 fiorentina Fiorentina
## 5    19    7     6     6      17    20  68      genoa      Genoa
## 6    23    5     5     9      29    38  63       roma       Roma
##        Team4      Team5
## 1      Inter      Inter
## 2   Juventus   Juventus
## 3      Milan      Milan
## 4 Fiorentina Fiorentina
## 5      Genoa      Genoa
## 6       Roma       Roma
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL09)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      INTER    38  25     9     4    70    32   14     5     0      37
## 2 2   JUVENTUS    38  21    11     6    69    37   11     6     2      38
## 3 3      MILAN    38  22     8     8    70    35   14     3     2      39
## 4 4 FIORENTINA    38  21     5    12    53    38   14     2     3      29
## 5 5      GENOA    38  19    11     8    56    39   12     5     2      39
## 6 6       ROMA    38  18     9    11    64    61   13     4     2      35
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    16   11     4     4      33    16  84      inter      Inter
## 2    19   10     5     4      31    18  74   juventus   Juventus
## 3    12    8     5     6      31    23  74      milan      Milan
## 4    14    7     3     9      24    24  68 fiorentina Fiorentina
## 5    19    7     6     6      17    20  68      genoa      Genoa
## 6    23    5     5     9      29    38  63       roma       Roma
##        Team4      Team5
## 1      Inter      Inter
## 2   Juventus   Juventus
## 3      Milan      Milan
## 4 Fiorentina Fiorentina
## 5      Genoa      Genoa
## 6       Roma       Roma
</code></pre>

<pre><code class="r">names(data_ITL09)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df_it &lt;- data_ITL09[c(1, 23, 3:8, 19)]

str(df_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Inter&quot; &quot;Juventus&quot; &quot;Milan&quot; &quot;Fiorentina&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 16 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 9 10 9 8 7 5 6 4 4 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 2 9 6 2 10 1 7 9 6 ...
##  $ NA..2: Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 10 11 12 2 12 1 2 4 4 7 ...
##  $ Goals: Factor w/ 17 levels &quot;30&quot;,&quot;33&quot;,&quot;35&quot;,..: 16 15 16 10 11 14 13 12 9 8 ...
##  $ NA..3: Factor w/ 17 levels &quot;32&quot;,&quot;35&quot;,&quot;37&quot;,..: 1 3 2 4 5 14 10 10 10 13 ...
##  $ Pts  : num  84 74 74 68 68 63 58 57 53 50 ...
</code></pre>

<pre><code class="r">head(df_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1      Inter    38  25     9     4    70    32  84
## 2 2   Juventus    38  21    11     6    69    37  74
## 3 3      Milan    38  22     8     8    70    35  74
## 4 4 Fiorentina    38  21     5    12    53    38  68
## 5 5      Genoa    38  19    11     8    56    39  68
## 6 6       Roma    38  18     9    11    64    61  63
</code></pre>

<pre><code class="r">#####Changing the names#####

df_it$Aggregate &lt;- paste(df_it$Goals, df_it$NA..3, sep = &quot;-&quot;)
head(df_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1      Inter    38  25     9     4    70    32  84     70-32
## 2 2   Juventus    38  21    11     6    69    37  74     69-37
## 3 3      Milan    38  22     8     8    70    35  74     70-35
## 4 4 Fiorentina    38  21     5    12    53    38  68     53-38
## 5 5      Genoa    38  19    11     8    56    39  68     56-39
## 6 6       Roma    38  18     9    11    64    61  63     64-61
</code></pre>

<pre><code class="r">df_it &lt;- df_it[ ,c(1:6, 10, 9)]
head(df_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1      Inter    38  25     9     4     70-32  84
## 2 2   Juventus    38  21    11     6     69-37  74
## 3 3      Milan    38  22     8     8     70-35  74
## 4 4 Fiorentina    38  21     5    12     53-38  68
## 5 5      Genoa    38  19    11     8     56-39  68
## 6 6       Roma    38  18     9    11     64-61  63
</code></pre>

<pre><code class="r">names(df_it) &lt;- names(data_9)
head(df_it)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1      Inter    38   25     9    4     70-32     84
## 2     2   Juventus    38   21    11    6     69-37     74
## 3     3      Milan    38   22     8    8     70-35     74
## 4     4 Fiorentina    38   21     5   12     53-38     68
## 5     5      Genoa    38   19    11    8     56-39     68
## 6     6       Roma    38   18     9   11     64-61     63
</code></pre>

<pre><code class="r">str(df_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Inter&quot; &quot;Juventus&quot; &quot;Milan&quot; &quot;Fiorentina&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 16 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 9 10 9 8 7 5 6 4 4 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 2 9 6 2 10 1 7 9 6 ...
##  $ Loss     : Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 10 11 12 2 12 1 2 4 4 7 ...
##  $ Aggregate: chr  &quot;70-32&quot; &quot;69-37&quot; &quot;70-35&quot; &quot;53-38&quot; ...
##  $ Points   : num  84 74 74 68 68 63 58 57 53 50 ...
</code></pre>

<pre><code class="r">df_it[ ,c(3:6)] &lt;- apply(df_it[ ,c(3:6)], 2, as.numeric)


#####Manipulating the upper case issue in imported data (data_ITL10)#####

#library(dplyr)

head(data_ITL10)
</code></pre>

<pre><code>##    N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA      &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1     INTER    38  24    10     4    75    34   15     4     0      42
## 3  2      ROMA    38  24     8     6    68    41   15     1     3      36
## 4  3     MILAN    38  20    10     8    60    39   12     5     2      37
## 5  4 SAMPDORIA    38  19    10     9    49    41   13     6     0      31
## 6  5   PALERMO    38  18    11     9    59    47   13     6     0      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    15    9     6     4      33    19  82
## 3    17    9     7     3      32    24  80
## 4    20    8     5     6      23    19  70
## 5    10    6     4     9      18    31  67
## 6    14    5     5     9      25    33  65
</code></pre>

<pre><code class="r">data_ITL10 &lt;- data_ITL10[-1 , ]

####Converting teams names to lower case
data_ITL10$Team2 &lt;-  tolower(data_ITL10$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL10$Team3 &lt;- sapply(data_ITL10$Team2, simpleCap)

data_ITL10$Team4 &lt;- as.factor(data_ITL10$Team3)

data_ITL10$Team5 &lt;-as.character(data_ITL10$Team4)
rownames(data_ITL10) &lt;- 1:nrow(data_ITL10)
head(data_ITL10)
</code></pre>

<pre><code>##   N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1     INTER    38  24    10     4    75    34   15     4     0      42
## 2 2      ROMA    38  24     8     6    68    41   15     1     3      36
## 3 3     MILAN    38  20    10     8    60    39   12     5     2      37
## 4 4 SAMPDORIA    38  19    10     9    49    41   13     6     0      31
## 5 5   PALERMO    38  18    11     9    59    47   13     6     0      34
## 6 6    NAPOLI    38  15    14     9    50    43    9     8     2      26
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts     Team2     Team3     Team4
## 1    15    9     6     4      33    19  82     inter     Inter     Inter
## 2    17    9     7     3      32    24  80      roma      Roma      Roma
## 3    20    8     5     6      23    19  70     milan     Milan     Milan
## 4    10    6     4     9      18    31  67 sampdoria Sampdoria Sampdoria
## 5    14    5     5     9      25    33  65   palermo   Palermo   Palermo
## 6    16    6     6     7      24    27  59    napoli    Napoli    Napoli
##       Team5
## 1     Inter
## 2      Roma
## 3     Milan
## 4 Sampdoria
## 5   Palermo
## 6    Napoli
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL10)
</code></pre>

<pre><code>##   N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1     INTER    38  24    10     4    75    34   15     4     0      42
## 2 2      ROMA    38  24     8     6    68    41   15     1     3      36
## 3 3     MILAN    38  20    10     8    60    39   12     5     2      37
## 4 4 SAMPDORIA    38  19    10     9    49    41   13     6     0      31
## 5 5   PALERMO    38  18    11     9    59    47   13     6     0      34
## 6 6    NAPOLI    38  15    14     9    50    43    9     8     2      26
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts     Team2     Team3     Team4
## 1    15    9     6     4      33    19  82     inter     Inter     Inter
## 2    17    9     7     3      32    24  80      roma      Roma      Roma
## 3    20    8     5     6      23    19  70     milan     Milan     Milan
## 4    10    6     4     9      18    31  67 sampdoria Sampdoria Sampdoria
## 5    14    5     5     9      25    33  65   palermo   Palermo   Palermo
## 6    16    6     6     7      24    27  59    napoli    Napoli    Napoli
##       Team5
## 1     Inter
## 2      Roma
## 3     Milan
## 4 Sampdoria
## 5   Palermo
## 6    Napoli
</code></pre>

<pre><code class="r">names(data_ITL10)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df3_it &lt;- data_ITL10[c(1, 23, 3:8, 19)]

str(df3_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Inter&quot; &quot;Roma&quot; &quot;Milan&quot; &quot;Sampdoria&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 11 10 9 8 6 7 5 5 4 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 8 1 1 2 5 7 1 9 2 ...
##  $ NA..2: Factor w/ 13 levels &quot;13&quot;,&quot;14&quot;,&quot;15&quot;,..: 9 10 11 12 12 12 3 2 3 2 ...
##  $ Goals: Factor w/ 19 levels &quot;27&quot;,&quot;37&quot;,&quot;39&quot;,..: 18 17 16 9 15 10 12 7 14 9 ...
##  $ NA..3: Factor w/ 17 levels &quot;34&quot;,&quot;39&quot;,&quot;41&quot;,..: 1 3 2 3 7 5 12 9 15 8 ...
##  $ Pts  : num  82 80 70 67 65 59 55 52 51 50 ...
</code></pre>

<pre><code class="r">head(df3_it)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1     Inter    38  24    10     4    75    34  82
## 2 2      Roma    38  24     8     6    68    41  80
## 3 3     Milan    38  20    10     8    60    39  70
## 4 4 Sampdoria    38  19    10     9    49    41  67
## 5 5   Palermo    38  18    11     9    59    47  65
## 6 6    Napoli    38  15    14     9    50    43  59
</code></pre>

<pre><code class="r">#####Changing the names#####

df3_it$Aggregate &lt;- paste(df3_it$Goals, df3_it$NA..3, sep = &quot;-&quot;)
head(df3_it)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1     Inter    38  24    10     4    75    34  82     75-34
## 2 2      Roma    38  24     8     6    68    41  80     68-41
## 3 3     Milan    38  20    10     8    60    39  70     60-39
## 4 4 Sampdoria    38  19    10     9    49    41  67     49-41
## 5 5   Palermo    38  18    11     9    59    47  65     59-47
## 6 6    Napoli    38  15    14     9    50    43  59     50-43
</code></pre>

<pre><code class="r">df3_it &lt;- df3_it[ ,c(1:6, 10, 9)]
head(df3_it)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1     Inter    38  24    10     4     75-34  82
## 2 2      Roma    38  24     8     6     68-41  80
## 3 3     Milan    38  20    10     8     60-39  70
## 4 4 Sampdoria    38  19    10     9     49-41  67
## 5 5   Palermo    38  18    11     9     59-47  65
## 6 6    Napoli    38  15    14     9     50-43  59
</code></pre>

<pre><code class="r">names(df3_it) &lt;- names(data_9)
head(df3_it)
</code></pre>

<pre><code>##   Index     Teams Games Wins Draws Loss Aggregate Points
## 1     1     Inter    38   24    10    4     75-34     82
## 2     2      Roma    38   24     8    6     68-41     80
## 3     3     Milan    38   20    10    8     60-39     70
## 4     4 Sampdoria    38   19    10    9     49-41     67
## 5     5   Palermo    38   18    11    9     59-47     65
## 6     6    Napoli    38   15    14    9     50-43     59
</code></pre>

<pre><code class="r">str(df3_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Inter&quot; &quot;Roma&quot; &quot;Milan&quot; &quot;Sampdoria&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 11 10 9 8 6 7 5 5 4 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 8 1 1 2 5 7 1 9 2 ...
##  $ Loss     : Factor w/ 13 levels &quot;13&quot;,&quot;14&quot;,&quot;15&quot;,..: 9 10 11 12 12 12 3 2 3 2 ...
##  $ Aggregate: chr  &quot;75-34&quot; &quot;68-41&quot; &quot;60-39&quot; &quot;49-41&quot; ...
##  $ Points   : num  82 80 70 67 65 59 55 52 51 50 ...
</code></pre>

<pre><code class="r">df3_it[ ,c(3:6)] &lt;- apply(df3_it[ ,c(3:6)], 2, as.numeric)

match(df_it$Teams, df3_it$Teams)
</code></pre>

<pre><code>##  [1]  1  7  3 11  9  2 15  5 14 12 18  6  4 19 13 16 17 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df_it$Teams, df3_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Inter&quot;,&quot;Juventus&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Inter&quot;,&quot;Roma&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00 0.25 0.00 0.20 0.00
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1  Var2 Distance
## 1      Inter Inter     1.00
## 2   Juventus Inter     0.25
## 3      Milan Inter     0.00
## 4 Fiorentina Inter     0.20
## 5      Genoa Inter     0.00
## 6       Roma Inter     0.00
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.4))
</code></pre>

<pre><code>## [1] 31
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.4)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.4, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and Ac Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##         Var1      Var2  Distance
## 1      Inter     Inter 1.0000000
## 26      Roma      Roma 1.0000000
## 43     Milan     Milan 1.0000000
## 72    Napoli Sampdoria 0.4444444
## 73 Sampdoria Sampdoria 1.0000000
## 88   Palermo   Palermo 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1       Inter      Inter 1.0000000
## 2        Roma       Roma 1.0000000
## 3       Milan      Milan 1.0000000
## 5   Sampdoria  Sampdoria 1.0000000
## 6     Palermo    Palermo 1.0000000
## 7      Napoli     Napoli 1.0000000
## 9    Juventus   Juventus 1.0000000
## 12      Genoa      Genoa 1.0000000
## 15 Fiorentina Fiorentina 1.0000000
## 19      Lazio      Lazio 1.0000000
## 21    Catania    Catania 1.0000000
## 22   Cagliari   Cagliari 1.0000000
## 23    Udinese    Udinese 1.0000000
## 24     Chievo     Chievo 1.0000000
## 25    Bologna    Bologna 1.0000000
## 26   Atalanta   Atalanta 1.0000000
## 30      Siena      Siena 1.0000000
## 11    Palermo      Parma 0.5714286
## 20   Atalanta    Catania 0.5000000
## 27    Catania   Atalanta 0.5000000
## 4      Napoli  Sampdoria 0.4444444
## 8   Sampdoria     Napoli 0.4444444
## 31     Torino    Livorno 0.4285714
## 10       Roma      Parma 0.4000000
## 13      Siena      Genoa 0.4000000
## 14      Lazio       Bari 0.4000000
## 16      Siena Fiorentina 0.4000000
## 17     Torino Fiorentina 0.4000000
## 18    Reggina Fiorentina 0.4000000
## 28 Fiorentina      Siena 0.4000000
## 29      Genoa      Siena 0.4000000
</code></pre>

<pre><code class="r">###Checking match funtion after the correction
match(df_it$Teams, df3_it$Teams)
</code></pre>

<pre><code>##  [1]  1  7  3 11  9  2 15  5 14 12 18  6  4 19 13 16 17 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2008-2009 in Serie A: https://en.wikipedia.org/wiki/2008-09_Serie_A##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_ITL11)#####

#library(dplyr)

head(data_ITL11)
</code></pre>

<pre><code>##    N    Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA    &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1   MILAN    38  24    10     4    65    24   13     4     2      42
## 3  2   INTER    38  23     7     8    69    42   15     3     1      48
## 4  3  NAPOLI    38  21     7    10    59    39   12     4     3      33
## 5  4 UDINESE    38  20     6    12    65    43   11     4     4      27
## 6  5   LAZIO    38  20     6    12    55    39   13     3     3      31
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    12   11     6     2      23    12  82
## 3    20    8     4     7      21    22  76
## 4    15    9     3     7      26    24  70
## 5    16    9     2     8      38    27  66
## 6    15    7     3     9      24    24  66
</code></pre>

<pre><code class="r">data_ITL11 &lt;- data_ITL11[-1 , ]

####Converting teams names to lower case
data_ITL11$Team2 &lt;-  tolower(data_ITL11$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL11$Team3 &lt;- sapply(data_ITL11$Team2, simpleCap)

data_ITL11$Team4 &lt;- as.factor(data_ITL11$Team3)

data_ITL11$Team5 &lt;-as.character(data_ITL11$Team4)
rownames(data_ITL11) &lt;- 1:nrow(data_ITL11)
head(data_ITL11)
</code></pre>

<pre><code>##   N    Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   MILAN    38  24    10     4    65    24   13     4     2      42
## 2 2   INTER    38  23     7     8    69    42   15     3     1      48
## 3 3  NAPOLI    38  21     7    10    59    39   12     4     3      33
## 4 4 UDINESE    38  20     6    12    65    43   11     4     4      27
## 5 5   LAZIO    38  20     6    12    55    39   13     3     3      31
## 6 6    ROMA    38  18     9    11    59    52   11     5     3      31
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts   Team2   Team3   Team4   Team5
## 1    12   11     6     2      23    12  82   milan   Milan   Milan   Milan
## 2    20    8     4     7      21    22  76   inter   Inter   Inter   Inter
## 3    15    9     3     7      26    24  70  napoli  Napoli  Napoli  Napoli
## 4    16    9     2     8      38    27  66 udinese Udinese Udinese Udinese
## 5    15    7     3     9      24    24  66   lazio   Lazio   Lazio   Lazio
## 6    18    7     4     8      28    34  63    roma    Roma    Roma    Roma
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL11)
</code></pre>

<pre><code>##   N    Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   MILAN    38  24    10     4    65    24   13     4     2      42
## 2 2   INTER    38  23     7     8    69    42   15     3     1      48
## 3 3  NAPOLI    38  21     7    10    59    39   12     4     3      33
## 4 4 UDINESE    38  20     6    12    65    43   11     4     4      27
## 5 5   LAZIO    38  20     6    12    55    39   13     3     3      31
## 6 6    ROMA    38  18     9    11    59    52   11     5     3      31
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts   Team2   Team3   Team4   Team5
## 1    12   11     6     2      23    12  82   milan   Milan   Milan   Milan
## 2    20    8     4     7      21    22  76   inter   Inter   Inter   Inter
## 3    15    9     3     7      26    24  70  napoli  Napoli  Napoli  Napoli
## 4    16    9     2     8      38    27  66 udinese Udinese Udinese Udinese
## 5    15    7     3     9      24    24  66   lazio   Lazio   Lazio   Lazio
## 6    18    7     4     8      28    34  63    roma    Roma    Roma    Roma
</code></pre>

<pre><code class="r">names(data_ITL11)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df4_it &lt;- data_ITL11[c(1, 23, 3:8, 19)]

str(df4_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Milan&quot; &quot;Inter&quot; &quot;Napoli&quot; &quot;Udinese&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 10 9 8 7 7 6 4 5 2 3 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 8 8 7 7 10 4 6 5 10 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 12 13 1 3 3 2 1 6 2 5 ...
##  $ Goals: Factor w/ 18 levels &quot;27&quot;,&quot;33&quot;,&quot;34&quot;,..: 16 17 15 16 12 15 13 14 11 9 ...
##  $ NA..3: Factor w/ 15 levels &quot;24&quot;,&quot;39&quot;,&quot;40&quot;,..: 1 4 2 5 2 11 7 13 6 7 ...
##  $ Pts  : num  82 76 70 66 66 63 58 56 51 51 ...
</code></pre>

<pre><code class="r">head(df4_it)
</code></pre>

<pre><code>##   N   Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Milan    38  24    10     4    65    24  82
## 2 2   Inter    38  23     7     8    69    42  76
## 3 3  Napoli    38  21     7    10    59    39  70
## 4 4 Udinese    38  20     6    12    65    43  66
## 5 5   Lazio    38  20     6    12    55    39  66
## 6 6    Roma    38  18     9    11    59    52  63
</code></pre>

<pre><code class="r">#####Changing the names#####

df4_it$Aggregate &lt;- paste(df4_it$Goals, df4_it$NA..3, sep = &quot;-&quot;)
head(df4_it)
</code></pre>

<pre><code>##   N   Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Milan    38  24    10     4    65    24  82     65-24
## 2 2   Inter    38  23     7     8    69    42  76     69-42
## 3 3  Napoli    38  21     7    10    59    39  70     59-39
## 4 4 Udinese    38  20     6    12    65    43  66     65-43
## 5 5   Lazio    38  20     6    12    55    39  66     55-39
## 6 6    Roma    38  18     9    11    59    52  63     59-52
</code></pre>

<pre><code class="r">df4_it &lt;- df4_it[ ,c(1:6, 10, 9)]
head(df4_it)
</code></pre>

<pre><code>##   N   Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Milan    38  24    10     4     65-24  82
## 2 2   Inter    38  23     7     8     69-42  76
## 3 3  Napoli    38  21     7    10     59-39  70
## 4 4 Udinese    38  20     6    12     65-43  66
## 5 5   Lazio    38  20     6    12     55-39  66
## 6 6    Roma    38  18     9    11     59-52  63
</code></pre>

<pre><code class="r">names(df4_it) &lt;- names(data_9)
head(df4_it)
</code></pre>

<pre><code>##   Index   Teams Games Wins Draws Loss Aggregate Points
## 1     1   Milan    38   24    10    4     65-24     82
## 2     2   Inter    38   23     7    8     69-42     76
## 3     3  Napoli    38   21     7   10     59-39     70
## 4     4 Udinese    38   20     6   12     65-43     66
## 5     5   Lazio    38   20     6   12     55-39     66
## 6     6    Roma    38   18     9   11     59-52     63
</code></pre>

<pre><code class="r">str(df4_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Milan&quot; &quot;Inter&quot; &quot;Napoli&quot; &quot;Udinese&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 10 9 8 7 7 6 4 5 2 3 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 8 8 7 7 10 4 6 5 10 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 12 13 1 3 3 2 1 6 2 5 ...
##  $ Aggregate: chr  &quot;65-24&quot; &quot;69-42&quot; &quot;59-39&quot; &quot;65-43&quot; ...
##  $ Points   : num  82 76 70 66 66 63 58 56 51 51 ...
</code></pre>

<pre><code class="r">df4_it[ ,c(3:6)] &lt;- apply(df4_it[ ,c(3:6)], 2, as.numeric)

match(df3_it$Teams, df4_it$Teams)
</code></pre>

<pre><code>##  [1]  2  6  1 18  8  3  7 12 10 20  9  5 13 14  4 11 16 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df3_it$Teams, df4_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Inter&quot;,&quot;Roma&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Milan&quot;,&quot;Inter&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.0000000 0.2000000 1.0000000 0.0000000 0.1428571
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##        Var1  Var2  Distance
## 1     Inter Milan 0.0000000
## 2      Roma Milan 0.2000000
## 3     Milan Milan 1.0000000
## 4 Sampdoria Milan 0.0000000
## 5   Palermo Milan 0.1428571
## 6    Napoli Milan 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and Ac Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##        Var1    Var2 Distance
## 3     Milan   Milan        1
## 21    Inter   Inter        1
## 46   Napoli  Napoli        1
## 75  Udinese Udinese        1
## 92    Lazio   Lazio        1
## 102    Roma    Roma        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1       Milan      Milan 1.0000000
## 2       Inter      Inter 1.0000000
## 3      Napoli     Napoli 1.0000000
## 4     Udinese    Udinese 1.0000000
## 5       Lazio      Lazio 1.0000000
## 6        Roma       Roma 1.0000000
## 7    Juventus   Juventus 1.0000000
## 8     Palermo    Palermo 1.0000000
## 10 Fiorentina Fiorentina 1.0000000
## 11      Genoa      Genoa 1.0000000
## 12     Chievo     Chievo 1.0000000
## 14      Parma      Parma 1.0000000
## 15    Catania    Catania 1.0000000
## 17   Cagliari   Cagliari 1.0000000
## 19    Bologna    Bologna 1.0000000
## 20  Sampdoria  Sampdoria 1.0000000
## 21       Bari       Bari 1.0000000
## 9       Parma    Palermo 0.5714286
## 13    Palermo      Parma 0.5714286
## 16   Atalanta    Catania 0.5000000
## 18      Siena     Cesena 0.5000000
</code></pre>

<pre><code class="r">###Checking match funtion after the correction
match(df3_it$Teams, df4_it$Teams)
</code></pre>

<pre><code>##  [1]  2  6  1 18  8  3  7 12 10 20  9  5 13 14  4 11 16 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2009-2010 in Serie A: https://en.wikipedia.org/wiki/2009-10_Serie_A##

#####Manipulating the upper case issue in imported data (data_ITL12)#####

#library(dplyr)

head(data_ITL12)
</code></pre>

<pre><code>##    N     Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA     &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1 JUVENTUS    38  23    15     0    68    20   13     6     0      40
## 3  2    MILAN    38  24     8     6    74    33   12     5     2      36
## 4  3  UDINESE    38  18    10    10    52    35   13     4     2      33
## 5  4    LAZIO    38  18     8    12    56    47   10     6     3      28
## 6  5   NAPOLI    38  16    13     9    66    46   10     6     3      39
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    12   10     9     0      28     8  84
## 3    11   12     3     4      38    22  80
## 4    13    5     6     8      19    22  64
## 5    16    8     2     9      28    31  62
## 6    22    6     7     6      27    24  61
</code></pre>

<pre><code class="r">data_ITL12 &lt;- data_ITL12[-1 , ]

####Converting teams names to lower case
data_ITL12$Team2 &lt;-  tolower(data_ITL12$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL12$Team3 &lt;- sapply(data_ITL12$Team2, simpleCap)

data_ITL12$Team4 &lt;- as.factor(data_ITL12$Team3)

data_ITL12$Team5 &lt;-as.character(data_ITL12$Team4)
rownames(data_ITL12) &lt;- 1:nrow(data_ITL12)
head(data_ITL12)
</code></pre>

<pre><code>##   N     Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 JUVENTUS    38  23    15     0    68    20   13     6     0      40
## 2 2    MILAN    38  24     8     6    74    33   12     5     2      36
## 3 3  UDINESE    38  18    10    10    52    35   13     4     2      33
## 4 4    LAZIO    38  18     8    12    56    47   10     6     3      28
## 5 5   NAPOLI    38  16    13     9    66    46   10     6     3      39
## 6 6    INTER    38  17     7    14    58    55   10     4     5      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts    Team2    Team3    Team4
## 1    12   10     9     0      28     8  84 juventus Juventus Juventus
## 2    11   12     3     4      38    22  80    milan    Milan    Milan
## 3    13    5     6     8      19    22  64  udinese  Udinese  Udinese
## 4    16    8     2     9      28    31  62    lazio    Lazio    Lazio
## 5    22    6     7     6      27    24  61   napoli   Napoli   Napoli
## 6    27    7     3     9      22    28  58    inter    Inter    Inter
##      Team5
## 1 Juventus
## 2    Milan
## 3  Udinese
## 4    Lazio
## 5   Napoli
## 6    Inter
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL12)
</code></pre>

<pre><code>##   N     Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 JUVENTUS    38  23    15     0    68    20   13     6     0      40
## 2 2    MILAN    38  24     8     6    74    33   12     5     2      36
## 3 3  UDINESE    38  18    10    10    52    35   13     4     2      33
## 4 4    LAZIO    38  18     8    12    56    47   10     6     3      28
## 5 5   NAPOLI    38  16    13     9    66    46   10     6     3      39
## 6 6    INTER    38  17     7    14    58    55   10     4     5      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts    Team2    Team3    Team4
## 1    12   10     9     0      28     8  84 juventus Juventus Juventus
## 2    11   12     3     4      38    22  80    milan    Milan    Milan
## 3    13    5     6     8      19    22  64  udinese  Udinese  Udinese
## 4    16    8     2     9      28    31  62    lazio    Lazio    Lazio
## 5    22    6     7     6      27    24  61   napoli   Napoli   Napoli
## 6    27    7     3     9      22    28  58    inter    Inter    Inter
##      Team5
## 1 Juventus
## 2    Milan
## 3  Udinese
## 4    Lazio
## 5   Napoli
## 6    Inter
</code></pre>

<pre><code class="r">names(data_ITL12)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df5_it &lt;- data_ITL12[c(1, 23, 3:8, 19)]

str(df5_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Juventus&quot; &quot;Milan&quot; &quot;Udinese&quot; &quot;Lazio&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 10 8 8 6 7 6 5 4 3 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 7 1 7 4 6 7 2 3 4 ...
##  $ NA..2: Factor w/ 14 levels &quot;0&quot;,&quot;10&quot;,&quot;12&quot;,..: 1 12 2 3 13 5 5 3 4 4 ...
##  $ Goals: Factor w/ 17 levels &quot;24&quot;,&quot;35&quot;,&quot;37&quot;,..: 15 16 9 11 14 12 13 10 5 2 ...
##  $ NA..3: Factor w/ 17 levels &quot;20&quot;,&quot;33&quot;,&quot;35&quot;,..: 1 2 3 7 6 11 10 9 4 5 ...
##  $ Pts  : num  84 80 64 62 61 58 56 56 51 49 ...
</code></pre>

<pre><code class="r">head(df5_it)
</code></pre>

<pre><code>##   N    Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Juventus    38  23    15     0    68    20  84
## 2 2    Milan    38  24     8     6    74    33  80
## 3 3  Udinese    38  18    10    10    52    35  64
## 4 4    Lazio    38  18     8    12    56    47  62
## 5 5   Napoli    38  16    13     9    66    46  61
## 6 6    Inter    38  17     7    14    58    55  58
</code></pre>

<pre><code class="r">#####Changing the names#####

df5_it$Aggregate &lt;- paste(df5_it$Goals, df5_it$NA..3, sep = &quot;-&quot;)
head(df5_it)
</code></pre>

<pre><code>##   N    Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Juventus    38  23    15     0    68    20  84     68-20
## 2 2    Milan    38  24     8     6    74    33  80     74-33
## 3 3  Udinese    38  18    10    10    52    35  64     52-35
## 4 4    Lazio    38  18     8    12    56    47  62     56-47
## 5 5   Napoli    38  16    13     9    66    46  61     66-46
## 6 6    Inter    38  17     7    14    58    55  58     58-55
</code></pre>

<pre><code class="r">df5_it &lt;- df5_it[ ,c(1:6, 10, 9)]
head(df5_it)
</code></pre>

<pre><code>##   N    Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Juventus    38  23    15     0     68-20  84
## 2 2    Milan    38  24     8     6     74-33  80
## 3 3  Udinese    38  18    10    10     52-35  64
## 4 4    Lazio    38  18     8    12     56-47  62
## 5 5   Napoli    38  16    13     9     66-46  61
## 6 6    Inter    38  17     7    14     58-55  58
</code></pre>

<pre><code class="r">names(df5_it) &lt;- names(data_9)
head(df5_it)
</code></pre>

<pre><code>##   Index    Teams Games Wins Draws Loss Aggregate Points
## 1     1 Juventus    38   23    15    0     68-20     84
## 2     2    Milan    38   24     8    6     74-33     80
## 3     3  Udinese    38   18    10   10     52-35     64
## 4     4    Lazio    38   18     8   12     56-47     62
## 5     5   Napoli    38   16    13    9     66-46     61
## 6     6    Inter    38   17     7   14     58-55     58
</code></pre>

<pre><code class="r">str(df5_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Juventus&quot; &quot;Milan&quot; &quot;Udinese&quot; &quot;Lazio&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 10 8 8 6 7 6 5 4 3 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 7 1 7 4 6 7 2 3 4 ...
##  $ Loss     : Factor w/ 14 levels &quot;0&quot;,&quot;10&quot;,&quot;12&quot;,..: 1 12 2 3 13 5 5 3 4 4 ...
##  $ Aggregate: chr  &quot;68-20&quot; &quot;74-33&quot; &quot;52-35&quot; &quot;56-47&quot; ...
##  $ Points   : num  84 80 64 62 61 58 56 56 51 49 ...
</code></pre>

<pre><code class="r">df5_it[ ,c(3:6)] &lt;- apply(df5_it[ ,c(3:6)], 2, as.numeric)

match(df4_it$Teams, df5_it$Teams)
</code></pre>

<pre><code>##  [1]  2  6  5  3  4  7  1 16 13 17 10  8 11 15 20  9 18 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df4_it$Teams, df5_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Milan&quot;,&quot;Inter&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Milan&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.125 0.250 0.000 0.125 0.000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##      Var1     Var2 Distance
## 1   Milan Juventus    0.125
## 2   Inter Juventus    0.250
## 3  Napoli Juventus    0.000
## 4 Udinese Juventus    0.125
## 5   Lazio Juventus    0.000
## 6    Roma Juventus    0.000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and Ac Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##         Var1     Var2 Distance
## 7   Juventus Juventus        1
## 21     Milan    Milan        1
## 44   Udinese  Udinese        1
## 65     Lazio    Lazio        1
## 83    Napoli   Napoli        1
## 102    Inter    Inter        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1    Juventus   Juventus 1.0000000
## 2       Milan      Milan 1.0000000
## 3     Udinese    Udinese 1.0000000
## 4       Lazio      Lazio 1.0000000
## 5      Napoli     Napoli 1.0000000
## 6       Inter      Inter 1.0000000
## 7        Roma       Roma 1.0000000
## 9       Parma      Parma 1.0000000
## 10    Bologna    Bologna 1.0000000
## 11     Chievo     Chievo 1.0000000
## 12    Catania    Catania 1.0000000
## 14 Fiorentina Fiorentina 1.0000000
## 16   Cagliari   Cagliari 1.0000000
## 17    Palermo    Palermo 1.0000000
## 19      Genoa      Genoa 1.0000000
## 20      Lecce      Lecce 1.0000000
## 21     Cesena     Cesena 1.0000000
## 8     Palermo      Parma 0.5714286
## 18      Parma    Palermo 0.5714286
## 13    Catania   Atalanta 0.5000000
## 15     Cesena      Siena 0.5000000
</code></pre>

<pre><code class="r">###Checking match funtion after the correction
match(df4_it$Teams, df5_it$Teams)
</code></pre>

<pre><code>##  [1]  2  6  5  3  4  7  1 16 13 17 10  8 11 15 20  9 18 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2010-2011 in Serie A: https://en.wikipedia.org/wiki/2010-11_Serie_A##

#####Manipulating the upper case issue in imported data (data_ITL13)#####

#library(dplyr)

head(data_ITL13)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1   JUVENTUS    38  27     6     5    71    24   14     3     2      36
## 3  2     NAPOLI    38  23     9     6    73    36   14     4     1      44
## 4  3      MILAN    38  21     9     8    67    39   13     2     4      33
## 5  4 FIORENTINA    38  21     7    10    72    44   13     4     2      40
## 6  5    UDINESE    38  18    12     8    59    45   11     7     1      31
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    10   13     3     3      35    14  87
## 3    18    9     5     5      29    18  78
## 4    15    8     7     4      34    24  72
## 5    19    8     3     8      32    25  70
## 6    16    7     5     7      28    29  66
</code></pre>

<pre><code class="r">data_ITL13 &lt;- data_ITL13[-1 , ]

####Converting teams names to lower case
data_ITL13$Team2 &lt;-  tolower(data_ITL13$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL13$Team3 &lt;- sapply(data_ITL13$Team2, simpleCap)

data_ITL13$Team4 &lt;- as.factor(data_ITL13$Team3)

data_ITL13$Team5 &lt;-as.character(data_ITL13$Team4)
rownames(data_ITL13) &lt;- 1:nrow(data_ITL13)
head(data_ITL13)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  27     6     5    71    24   14     3     2      36
## 2 2     NAPOLI    38  23     9     6    73    36   14     4     1      44
## 3 3      MILAN    38  21     9     8    67    39   13     2     4      33
## 4 4 FIORENTINA    38  21     7    10    72    44   13     4     2      40
## 5 5    UDINESE    38  18    12     8    59    45   11     7     1      31
## 6 6       ROMA    38  18     8    12    71    56   10     5     4      40
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    10   13     3     3      35    14  87   juventus   Juventus
## 2    18    9     5     5      29    18  78     napoli     Napoli
## 3    15    8     7     4      34    24  72      milan      Milan
## 4    19    8     3     8      32    25  70 fiorentina Fiorentina
## 5    16    7     5     7      28    29  66    udinese    Udinese
## 6    24    8     3     8      31    32  62       roma       Roma
##        Team4      Team5
## 1   Juventus   Juventus
## 2     Napoli     Napoli
## 3      Milan      Milan
## 4 Fiorentina Fiorentina
## 5    Udinese    Udinese
## 6       Roma       Roma
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL13)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  27     6     5    71    24   14     3     2      36
## 2 2     NAPOLI    38  23     9     6    73    36   14     4     1      44
## 3 3      MILAN    38  21     9     8    67    39   13     2     4      33
## 4 4 FIORENTINA    38  21     7    10    72    44   13     4     2      40
## 5 5    UDINESE    38  18    12     8    59    45   11     7     1      31
## 6 6       ROMA    38  18     8    12    71    56   10     5     4      40
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    10   13     3     3      35    14  87   juventus   Juventus
## 2    18    9     5     5      29    18  78     napoli     Napoli
## 3    15    8     7     4      34    24  72      milan      Milan
## 4    19    8     3     8      32    25  70 fiorentina Fiorentina
## 5    16    7     5     7      28    29  66    udinese    Udinese
## 6    24    8     3     8      31    32  62       roma       Roma
##        Team4      Team5
## 1   Juventus   Juventus
## 2     Napoli     Napoli
## 3      Milan      Milan
## 4 Fiorentina Fiorentina
## 5    Udinese    Udinese
## 6       Roma       Roma
</code></pre>

<pre><code class="r">names(data_ITL13)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df6_it &lt;- data_ITL13[c(1, 23, 3:8, 19)]

str(df6_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Juventus&quot; &quot;Napoli&quot; &quot;Milan&quot; &quot;Fiorentina&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 7 6 6 6 4 5 3 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 10 10 8 3 9 8 2 7 1 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 12 13 1 13 2 3 2 6 5 ...
##  $ Goals: Factor w/ 18 levels &quot;27&quot;,&quot;34&quot;,&quot;36&quot;,..: 15 17 14 16 13 15 11 10 12 8 ...
##  $ NA..3: Factor w/ 15 levels &quot;24&quot;,&quot;36&quot;,&quot;39&quot;,..: 1 2 3 5 6 12 4 7 13 7 ...
##  $ Pts  : num  87 78 72 70 66 62 61 56 54 49 ...
</code></pre>

<pre><code class="r">head(df6_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Juventus    38  27     6     5    71    24  87
## 2 2     Napoli    38  23     9     6    73    36  78
## 3 3      Milan    38  21     9     8    67    39  72
## 4 4 Fiorentina    38  21     7    10    72    44  70
## 5 5    Udinese    38  18    12     8    59    45  66
## 6 6       Roma    38  18     8    12    71    56  62
</code></pre>

<pre><code class="r">#####Changing the names#####

df6_it$Aggregate &lt;- paste(df6_it$Goals, df6_it$NA..3, sep = &quot;-&quot;)
head(df6_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Juventus    38  27     6     5    71    24  87     71-24
## 2 2     Napoli    38  23     9     6    73    36  78     73-36
## 3 3      Milan    38  21     9     8    67    39  72     67-39
## 4 4 Fiorentina    38  21     7    10    72    44  70     72-44
## 5 5    Udinese    38  18    12     8    59    45  66     59-45
## 6 6       Roma    38  18     8    12    71    56  62     71-56
</code></pre>

<pre><code class="r">df6_it &lt;- df6_it[ ,c(1:6, 10, 9)]
head(df6_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Juventus    38  27     6     5     71-24  87
## 2 2     Napoli    38  23     9     6     73-36  78
## 3 3      Milan    38  21     9     8     67-39  72
## 4 4 Fiorentina    38  21     7    10     72-44  70
## 5 5    Udinese    38  18    12     8     59-45  66
## 6 6       Roma    38  18     8    12     71-56  62
</code></pre>

<pre><code class="r">names(df6_it) &lt;- names(data_9)
head(df6_it)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1   Juventus    38   27     6    5     71-24     87
## 2     2     Napoli    38   23     9    6     73-36     78
## 3     3      Milan    38   21     9    8     67-39     72
## 4     4 Fiorentina    38   21     7   10     72-44     70
## 5     5    Udinese    38   18    12    8     59-45     66
## 6     6       Roma    38   18     8   12     71-56     62
</code></pre>

<pre><code class="r">str(df6_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Juventus&quot; &quot;Napoli&quot; &quot;Milan&quot; &quot;Fiorentina&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 7 6 6 6 4 5 3 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 10 10 8 3 9 8 2 7 1 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 12 13 1 13 2 3 2 6 5 ...
##  $ Aggregate: chr  &quot;71-24&quot; &quot;73-36&quot; &quot;67-39&quot; &quot;72-44&quot; ...
##  $ Points   : num  87 78 72 70 66 62 61 56 54 49 ...
</code></pre>

<pre><code class="r">df6_it[ ,c(3:6)] &lt;- apply(df6_it[ ,c(3:6)], 2, as.numeric)

match(df5_it$Teams, df6_it$Teams)
</code></pre>

<pre><code>##  [1]  1  3  5  7  2  9  6 10 13 12  8 15  4 19 11 18 17 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df5_it$Teams, df6_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Milan&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Napoli&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.000 0.125 0.125 0.000 0.000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##       Var1     Var2 Distance
## 1 Juventus Juventus    1.000
## 2    Milan Juventus    0.125
## 3  Udinese Juventus    0.125
## 4    Lazio Juventus    0.000
## 5   Napoli Juventus    0.000
## 6    Inter Juventus    0.250
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 22
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and AC Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1       Var2 Distance
## 1     Juventus   Juventus        1
## 25      Napoli     Napoli        1
## 42       Milan      Milan        1
## 73  Fiorentina Fiorentina        1
## 83     Udinese    Udinese        1
## 107       Roma       Roma        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1    Juventus   Juventus 1.0000000
## 2      Napoli     Napoli 1.0000000
## 3       Milan      Milan 1.0000000
## 4  Fiorentina Fiorentina 1.0000000
## 5     Udinese    Udinese 1.0000000
## 6        Roma       Roma 1.0000000
## 7       Lazio      Lazio 1.0000000
## 8     Catania    Catania 1.0000000
## 10      Inter      Inter 1.0000000
## 11      Parma      Parma 1.0000000
## 13   Cagliari   Cagliari 1.0000000
## 14     Chievo     Chievo 1.0000000
## 15    Bologna    Bologna 1.0000000
## 17   Atalanta   Atalanta 1.0000000
## 18      Genoa      Genoa 1.0000000
## 20    Palermo    Palermo 1.0000000
## 21      Siena      Siena 1.0000000
## 12    Palermo      Parma 0.5714286
## 19      Parma    Palermo 0.5714286
## 9    Atalanta    Catania 0.5000000
## 16    Catania   Atalanta 0.5000000
## 22     Cesena      Siena 0.5000000
</code></pre>

<pre><code class="r">###Checking match funtion after the correction
match(df5_it$Teams, df6_it$Teams)
</code></pre>

<pre><code>##  [1]  1  3  5  7  2  9  6 10 13 12  8 15  4 19 11 18 17 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2011-2012 in Serie A: https://en.wikipedia.org/wiki/2011-12_Serie_A##

#####Manipulating the upper case issue in imported data (data_ITL14)#####

#library(dplyr)

head(data_ITL14)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1   JUVENTUS    38  33     3     2    80    23   19     0     0      47
## 3  2       ROMA    38  26     7     5    72    25   15     3     1      44
## 4  3     NAPOLI    38  23     9     6    77    39   13     4     2      43
## 5  4 FIORENTINA    38  19     8    11    65    44    9     4     6      36
## 6  5      INTER    38  15    15     8    62    39    8     9     2      27
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2     9   14     3     2      33    14 102
## 3     9   11     4     4      28    16  85
## 4    15   10     5     4      34    24  78
## 5    29   10     4     5      29    15  65
## 6    18    7     6     6      35    21  60
</code></pre>

<pre><code class="r">data_ITL14 &lt;- data_ITL14[-1 , ]

####Converting teams names to lower case
data_ITL14$Team2 &lt;-  tolower(data_ITL14$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL14$Team3 &lt;- sapply(data_ITL14$Team2, simpleCap)

data_ITL14$Team4 &lt;- as.factor(data_ITL14$Team3)

data_ITL14$Team5 &lt;-as.character(data_ITL14$Team4)
rownames(data_ITL14) &lt;- 1:nrow(data_ITL14)
head(data_ITL14)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  33     3     2    80    23   19     0     0      47
## 2 2       ROMA    38  26     7     5    72    25   15     3     1      44
## 3 3     NAPOLI    38  23     9     6    77    39   13     4     2      43
## 4 4 FIORENTINA    38  19     8    11    65    44    9     4     6      36
## 5 5      INTER    38  15    15     8    62    39    8     9     2      27
## 6 6      PARMA    38  15    13    10    58    46    9     7     3      27
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     9   14     3     2      33    14 102   juventus   Juventus
## 2     9   11     4     4      28    16  85       roma       Roma
## 3    15   10     5     4      34    24  78     napoli     Napoli
## 4    29   10     4     5      29    15  65 fiorentina Fiorentina
## 5    18    7     6     6      35    21  60      inter      Inter
## 6    18    6     6     7      31    28  58      parma      Parma
##        Team4      Team5
## 1   Juventus   Juventus
## 2       Roma       Roma
## 3     Napoli     Napoli
## 4 Fiorentina Fiorentina
## 5      Inter      Inter
## 6      Parma      Parma
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL14)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  33     3     2    80    23   19     0     0      47
## 2 2       ROMA    38  26     7     5    72    25   15     3     1      44
## 3 3     NAPOLI    38  23     9     6    77    39   13     4     2      43
## 4 4 FIORENTINA    38  19     8    11    65    44    9     4     6      36
## 5 5      INTER    38  15    15     8    62    39    8     9     2      27
## 6 6      PARMA    38  15    13    10    58    46    9     7     3      27
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     9   14     3     2      33    14 102   juventus   Juventus
## 2     9   11     4     4      28    16  85       roma       Roma
## 3    15   10     5     4      34    24  78     napoli     Napoli
## 4    29   10     4     5      29    15  65 fiorentina Fiorentina
## 5    18    7     6     6      35    21  60      inter      Inter
## 6    18    6     6     7      31    28  58      parma      Parma
##        Team4      Team5
## 1   Juventus   Juventus
## 2       Roma       Roma
## 3     Napoli     Napoli
## 4 Fiorentina Fiorentina
## 5      Inter      Inter
## 6      Parma      Parma
</code></pre>

<pre><code class="r">names(data_ITL14)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df7_it &lt;- data_ITL14[c(1, 23, 3:8, 19)]

str(df7_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Juventus&quot; &quot;Roma&quot; &quot;Napoli&quot; &quot;Fiorentina&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 4 4 4 5 4 5 ...
##  $ NA..1: Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 6 9 11 10 5 3 2 11 1 8 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 12 13 2 14 1 2 4 3 5 ...
##  $ Goals: Factor w/ 16 levels &quot;28&quot;,&quot;34&quot;,&quot;39&quot;,..: 15 13 14 12 11 10 10 9 8 11 ...
##  $ NA..3: Factor w/ 19 levels &quot;23&quot;,&quot;25&quot;,&quot;39&quot;,..: 1 2 3 4 3 5 6 7 11 16 ...
##  $ Pts  : num  102 85 78 65 60 58 57 57 56 54 ...
</code></pre>

<pre><code class="r">head(df7_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Juventus    38  33     3     2    80    23 102
## 2 2       Roma    38  26     7     5    72    25  85
## 3 3     Napoli    38  23     9     6    77    39  78
## 4 4 Fiorentina    38  19     8    11    65    44  65
## 5 5      Inter    38  15    15     8    62    39  60
## 6 6      Parma    38  15    13    10    58    46  58
</code></pre>

<pre><code class="r">#####Changing the names#####

df7_it$Aggregate &lt;- paste(df7_it$Goals, df7_it$NA..3, sep = &quot;-&quot;)
head(df7_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Juventus    38  33     3     2    80    23 102     80-23
## 2 2       Roma    38  26     7     5    72    25  85     72-25
## 3 3     Napoli    38  23     9     6    77    39  78     77-39
## 4 4 Fiorentina    38  19     8    11    65    44  65     65-44
## 5 5      Inter    38  15    15     8    62    39  60     62-39
## 6 6      Parma    38  15    13    10    58    46  58     58-46
</code></pre>

<pre><code class="r">df7_it &lt;- df7_it[ ,c(1:6, 10, 9)]
head(df7_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Juventus    38  33     3     2     80-23 102
## 2 2       Roma    38  26     7     5     72-25  85
## 3 3     Napoli    38  23     9     6     77-39  78
## 4 4 Fiorentina    38  19     8    11     65-44  65
## 5 5      Inter    38  15    15     8     62-39  60
## 6 6      Parma    38  15    13    10     58-46  58
</code></pre>

<pre><code class="r">names(df7_it) &lt;- names(data_9)
head(df7_it)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1   Juventus    38   33     3    2     80-23    102
## 2     2       Roma    38   26     7    5     72-25     85
## 3     3     Napoli    38   23     9    6     77-39     78
## 4     4 Fiorentina    38   19     8   11     65-44     65
## 5     5      Inter    38   15    15    8     62-39     60
## 6     6      Parma    38   15    13   10     58-46     58
</code></pre>

<pre><code class="r">str(df7_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Juventus&quot; &quot;Roma&quot; &quot;Napoli&quot; &quot;Fiorentina&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 4 4 4 5 4 5 ...
##  $ Draws    : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 6 9 11 10 5 3 2 11 1 8 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 12 13 2 14 1 2 4 3 5 ...
##  $ Aggregate: chr  &quot;80-23&quot; &quot;72-25&quot; &quot;77-39&quot; &quot;65-44&quot; ...
##  $ Points   : num  102 85 78 65 60 58 57 57 56 54 ...
</code></pre>

<pre><code class="r">df7_it[ ,c(3:6)] &lt;- apply(df7_it[ ,c(3:6)], 2, as.numeric)

match(df6_it$Teams, df7_it$Teams)
</code></pre>

<pre><code>##  [1]  1  3  8  4 14  2  9 18  5  6 15 16 19 12 11  7 13 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df6_it$Teams, df7_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Napoli&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Roma&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.000 0.000 0.125 0.300 0.125
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1     Var2 Distance
## 1   Juventus Juventus    1.000
## 2     Napoli Juventus    0.000
## 3      Milan Juventus    0.125
## 4 Fiorentina Juventus    0.300
## 5    Udinese Juventus    0.125
## 6       Roma Juventus    0.000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and AC Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1       Var2 Distance
## 1     Juventus   Juventus        1
## 26        Roma       Roma        1
## 42      Napoli     Napoli        1
## 64  Fiorentina Fiorentina        1
## 89       Inter      Inter        1
## 110      Parma      Parma        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1    Juventus   Juventus 1.0000000
## 2        Roma       Roma 1.0000000
## 3      Napoli     Napoli 1.0000000
## 4  Fiorentina Fiorentina 1.0000000
## 5       Inter      Inter 1.0000000
## 6       Parma      Parma 1.0000000
## 8      Torino     Torino 1.0000000
## 9       Milan      Milan 1.0000000
## 10      Lazio      Lazio 1.0000000
## 13   Atalanta   Atalanta 1.0000000
## 14  Sampdoria  Sampdoria 1.0000000
## 15      Genoa      Genoa 1.0000000
## 16    Udinese    Udinese 1.0000000
## 17   Cagliari   Cagliari 1.0000000
## 18     Chievo     Chievo 1.0000000
## 19    Catania    Catania 1.0000000
## 21    Bologna    Bologna 1.0000000
## 7     Palermo      Parma 0.5714286
## 11      Genoa     Verona 0.5000000
## 12    Catania   Atalanta 0.5000000
## 20   Atalanta    Catania 0.5000000
</code></pre>

<pre><code class="r">###Checking match funtion after the correction
match(df6_it$Teams, df7_it$Teams)
</code></pre>

<pre><code>##  [1]  1  3  8  4 14  2  9 18  5  6 15 16 19 12 11  7 13 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2012-2013 in Serie A: https://en.wikipedia.org/wiki/2012-13_Serie_A##

#####Manipulating the upper case issue in imported data (data_ITL15)#####

#library(dplyr)

head(data_ITL15)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1   JUVENTUS    38  26     9     3    72    24   16     3     0      45
## 3  2       ROMA    38  19    13     6    54    31   10     7     2      31
## 4  3      LAZIO    38  21     6    11    71    38   12     1     6      40
## 5  4 FIORENTINA    38  18    10    10    61    46    9     6     4      30
## 6  5     NAPOLI    38  18     9    11    70    54   11     5     3      46
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    11   10     6     3      27    13  87
## 3    14    9     6     4      23    17  70
## 4    18    9     5     5      31    20  69
## 5    17    9     4     6      31    29  64
## 6    28    7     4     8      24    26  63
</code></pre>

<pre><code class="r">data_ITL15 &lt;- data_ITL15[-1 , ]

####Converting teams names to lower case
data_ITL15$Team2 &lt;-  tolower(data_ITL15$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL15$Team3 &lt;- sapply(data_ITL15$Team2, simpleCap)

data_ITL15$Team4 &lt;- as.factor(data_ITL15$Team3)

data_ITL15$Team5 &lt;-as.character(data_ITL15$Team4)
rownames(data_ITL15) &lt;- 1:nrow(data_ITL15)
head(data_ITL15)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  26     9     3    72    24   16     3     0      45
## 2 2       ROMA    38  19    13     6    54    31   10     7     2      31
## 3 3      LAZIO    38  21     6    11    71    38   12     1     6      40
## 4 4 FIORENTINA    38  18    10    10    61    46    9     6     4      30
## 5 5     NAPOLI    38  18     9    11    70    54   11     5     3      46
## 6 6      GENOA    38  16    11    11    62    47    9     6     4      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    11   10     6     3      27    13  87   juventus   Juventus
## 2    14    9     6     4      23    17  70       roma       Roma
## 3    18    9     5     5      31    20  69      lazio      Lazio
## 4    17    9     4     6      31    29  64 fiorentina Fiorentina
## 5    28    7     4     8      24    26  63     napoli     Napoli
## 6    21    7     5     7      29    26  59      genoa      Genoa
##        Team4      Team5
## 1   Juventus   Juventus
## 2       Roma       Roma
## 3      Lazio      Lazio
## 4 Fiorentina Fiorentina
## 5     Napoli     Napoli
## 6      Genoa      Genoa
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL15)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  26     9     3    72    24   16     3     0      45
## 2 2       ROMA    38  19    13     6    54    31   10     7     2      31
## 3 3      LAZIO    38  21     6    11    71    38   12     1     6      40
## 4 4 FIORENTINA    38  18    10    10    61    46    9     6     4      30
## 5 5     NAPOLI    38  18     9    11    70    54   11     5     3      46
## 6 6      GENOA    38  16    11    11    62    47    9     6     4      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    11   10     6     3      27    13  87   juventus   Juventus
## 2    14    9     6     4      23    17  70       roma       Roma
## 3    18    9     5     5      31    20  69      lazio      Lazio
## 4    17    9     4     6      31    29  64 fiorentina Fiorentina
## 5    28    7     4     8      24    26  63     napoli     Napoli
## 6    21    7     5     7      29    26  59      genoa      Genoa
##        Team4      Team5
## 1   Juventus   Juventus
## 2       Roma       Roma
## 3      Lazio      Lazio
## 4 Fiorentina Fiorentina
## 5     Napoli     Napoli
## 6      Genoa      Genoa
</code></pre>

<pre><code class="r">names(data_ITL15)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df8_it &lt;- data_ITL15[c(1, 23, 3:8, 19)]

str(df8_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Juventus&quot; &quot;Roma&quot; &quot;Lazio&quot; &quot;Fiorentina&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 8 9 7 7 6 4 5 5 4 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 4 8 1 10 2 6 4 3 4 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 12 2 1 2 2 13 2 3 3 ...
##  $ Goals: Factor w/ 18 levels &quot;28&quot;,&quot;33&quot;,&quot;36&quot;,..: 17 10 16 13 15 14 7 12 7 11 ...
##  $ NA..3: Factor w/ 20 levels &quot;24&quot;,&quot;31&quot;,&quot;38&quot;,..: 1 2 3 7 12 8 5 9 6 10 ...
##  $ Pts  : num  87 70 69 64 63 59 56 55 54 52 ...
</code></pre>

<pre><code class="r">head(df8_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Juventus    38  26     9     3    72    24  87
## 2 2       Roma    38  19    13     6    54    31  70
## 3 3      Lazio    38  21     6    11    71    38  69
## 4 4 Fiorentina    38  18    10    10    61    46  64
## 5 5     Napoli    38  18     9    11    70    54  63
## 6 6      Genoa    38  16    11    11    62    47  59
</code></pre>

<pre><code class="r">#####Changing the names#####

df8_it$Aggregate &lt;- paste(df8_it$Goals, df8_it$NA..3, sep = &quot;-&quot;)
head(df8_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Juventus    38  26     9     3    72    24  87     72-24
## 2 2       Roma    38  19    13     6    54    31  70     54-31
## 3 3      Lazio    38  21     6    11    71    38  69     71-38
## 4 4 Fiorentina    38  18    10    10    61    46  64     61-46
## 5 5     Napoli    38  18     9    11    70    54  63     70-54
## 6 6      Genoa    38  16    11    11    62    47  59     62-47
</code></pre>

<pre><code class="r">df8_it &lt;- df8_it[ ,c(1:6, 10, 9)]
head(df8_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Juventus    38  26     9     3     72-24  87
## 2 2       Roma    38  19    13     6     54-31  70
## 3 3      Lazio    38  21     6    11     71-38  69
## 4 4 Fiorentina    38  18    10    10     61-46  64
## 5 5     Napoli    38  18     9    11     70-54  63
## 6 6      Genoa    38  16    11    11     62-47  59
</code></pre>

<pre><code class="r">names(df8_it) &lt;- names(data_9)
head(df8_it)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1   Juventus    38   26     9    3     72-24     87
## 2     2       Roma    38   19    13    6     54-31     70
## 3     3      Lazio    38   21     6   11     71-38     69
## 4     4 Fiorentina    38   18    10   10     61-46     64
## 5     5     Napoli    38   18     9   11     70-54     63
## 6     6      Genoa    38   16    11   11     62-47     59
</code></pre>

<pre><code class="r">str(df8_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Juventus&quot; &quot;Roma&quot; &quot;Lazio&quot; &quot;Fiorentina&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 8 9 7 7 6 4 5 5 4 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 4 8 1 10 2 6 4 3 4 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 12 2 1 2 2 13 2 3 3 ...
##  $ Aggregate: chr  &quot;72-24&quot; &quot;54-31&quot; &quot;71-38&quot; &quot;61-46&quot; ...
##  $ Points   : num  87 70 69 64 63 59 56 55 54 52 ...
</code></pre>

<pre><code class="r">df8_it[ ,c(3:6)] &lt;- apply(df8_it[ ,c(3:6)], 2, as.numeric)

match(df7_it$Teams, df8_it$Teams)
</code></pre>

<pre><code>##  [1]  1  2  5  4  8 20  9 10  3 13 17  7  6 16 18 14 12 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df7_it$Teams, df8_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Roma&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Roma&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00 0.00 0.00 0.30 0.25
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1     Var2 Distance
## 1   Juventus Juventus     1.00
## 2       Roma Juventus     0.00
## 3     Napoli Juventus     0.00
## 4 Fiorentina Juventus     0.30
## 5      Inter Juventus     0.25
## 6      Parma Juventus     0.00
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and Ac Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1       Var2 Distance
## 1     Juventus   Juventus      1.0
## 22        Roma       Roma      1.0
## 49       Lazio      Lazio      1.0
## 64  Fiorentina Fiorentina      1.0
## 83      Napoli     Napoli      1.0
## 110     Verona      Genoa      0.5
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1    Juventus   Juventus 1.0000000
## 2        Roma       Roma 1.0000000
## 3       Lazio      Lazio 1.0000000
## 4  Fiorentina Fiorentina 1.0000000
## 5      Napoli     Napoli 1.0000000
## 7       Genoa      Genoa 1.0000000
## 8   Sampdoria  Sampdoria 1.0000000
## 9       Inter      Inter 1.0000000
## 10     Torino     Torino 1.0000000
## 11      Milan      Milan 1.0000000
## 13   Sassuolo   Sassuolo 1.0000000
## 14     Verona     Verona 1.0000000
## 16     Chievo     Chievo 1.0000000
## 18    Udinese    Udinese 1.0000000
## 19   Atalanta   Atalanta 1.0000000
## 21   Cagliari   Cagliari 1.0000000
## 23      Parma      Parma 1.0000000
## 17     Napoli     Empoli 0.6666667
## 12      Parma    Palermo 0.5714286
## 6      Verona      Genoa 0.5000000
## 15      Genoa     Verona 0.5000000
## 20    Catania   Atalanta 0.5000000
## 22     Verona     Cesena 0.5000000
</code></pre>

<pre><code class="r">###Checking match funtion after the correction
match(df7_it$Teams, df8_it$Teams)
</code></pre>

<pre><code>##  [1]  1  2  5  4  8 20  9 10  3 13 17  7  6 16 18 14 12 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2013-2014 in Serie A: https://en.wikipedia.org/wiki/2013-14_Serie_A##


#####Manipulating the upper case issue in imported data (data_ITL16)#####

#library(dplyr)

head(data_ITL16)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1   JUVENTUS    38  29     4     5    75    20   16     2     1      37
## 3  2     NAPOLI    38  25     7     6    80    32   16     3     0      49
## 4  3       ROMA    38  23    11     4    83    41   13     5     1      44
## 5  4      INTER    38  20     7    11    50    38   13     2     4      29
## 6  5 FIORENTINA    38  18    10    10    60    42   11     5     3      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2     6   13     2     4      38    14  91
## 3    12    9     4     6      31    20  82
## 4    17   10     6     3      39    24  80
## 5    15    7     5     7      21    23  67
## 6    16    7     5     7      26    26  64
</code></pre>

<pre><code class="r">data_ITL16 &lt;- data_ITL16[-1 , ]

####Converting teams names to lower case
data_ITL16$Team2 &lt;-  tolower(data_ITL16$Team)

####Converting the starting letter of the teams names to upper case 
data_ITL16$Team3 &lt;- sapply(data_ITL16$Team2, simpleCap)

data_ITL16$Team4 &lt;- as.factor(data_ITL16$Team3)

data_ITL16$Team5 &lt;-as.character(data_ITL16$Team4)
rownames(data_ITL16) &lt;- 1:nrow(data_ITL16)
head(data_ITL16)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  29     4     5    75    20   16     2     1      37
## 2 2     NAPOLI    38  25     7     6    80    32   16     3     0      49
## 3 3       ROMA    38  23    11     4    83    41   13     5     1      44
## 4 4      INTER    38  20     7    11    50    38   13     2     4      29
## 5 5 FIORENTINA    38  18    10    10    60    42   11     5     3      34
## 6 6   SASSUOLO    38  16    13     9    49    40    8     8     3      25
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     6   13     2     4      38    14  91   juventus   Juventus
## 2    12    9     4     6      31    20  82     napoli     Napoli
## 3    17   10     6     3      39    24  80       roma       Roma
## 4    15    7     5     7      21    23  67      inter      Inter
## 5    16    7     5     7      26    26  64 fiorentina Fiorentina
## 6    20    8     5     6      24    20  61   sassuolo   Sassuolo
##        Team4      Team5
## 1   Juventus   Juventus
## 2     Napoli     Napoli
## 3       Roma       Roma
## 4      Inter      Inter
## 5 Fiorentina Fiorentina
## 6   Sassuolo   Sassuolo
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_ITL16)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   JUVENTUS    38  29     4     5    75    20   16     2     1      37
## 2 2     NAPOLI    38  25     7     6    80    32   16     3     0      49
## 3 3       ROMA    38  23    11     4    83    41   13     5     1      44
## 4 4      INTER    38  20     7    11    50    38   13     2     4      29
## 5 5 FIORENTINA    38  18    10    10    60    42   11     5     3      34
## 6 6   SASSUOLO    38  16    13     9    49    40    8     8     3      25
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     6   13     2     4      38    14  91   juventus   Juventus
## 2    12    9     4     6      31    20  82     napoli     Napoli
## 3    17   10     6     3      39    24  80       roma       Roma
## 4    15    7     5     7      21    23  67      inter      Inter
## 5    16    7     5     7      26    26  64 fiorentina Fiorentina
## 6    20    8     5     6      24    20  61   sassuolo   Sassuolo
##        Team4      Team5
## 1   Juventus   Juventus
## 2     Napoli     Napoli
## 3       Roma       Roma
## 4      Inter      Inter
## 5 Fiorentina Fiorentina
## 6   Sassuolo   Sassuolo
</code></pre>

<pre><code class="r">names(data_ITL16)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df9_it &lt;- data_ITL16[c(1, 23, 3:8, 19)]

str(df9_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Juventus&quot; &quot;Napoli&quot; &quot;Roma&quot; &quot;Inter&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 8 7 6 5 5 4 4 ...
##  $ NA..1: Factor w/ 8 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 6 2 6 1 4 3 7 2 6 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;14&quot;,..: 12 13 11 2 1 14 2 3 3 7 ...
##  $ Goals: Factor w/ 18 levels &quot;33&quot;,&quot;34&quot;,&quot;35&quot;,..: 15 16 17 12 14 11 11 13 8 9 ...
##  $ NA..3: Factor w/ 20 levels &quot;20&quot;,&quot;32&quot;,&quot;38&quot;,..: 1 2 5 3 6 4 7 12 8 10 ...
##  $ Pts  : num  91 82 80 67 64 61 57 54 50 46 ...
</code></pre>

<pre><code class="r">head(df9_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Juventus    38  29     4     5    75    20  91
## 2 2     Napoli    38  25     7     6    80    32  82
## 3 3       Roma    38  23    11     4    83    41  80
## 4 4      Inter    38  20     7    11    50    38  67
## 5 5 Fiorentina    38  18    10    10    60    42  64
## 6 6   Sassuolo    38  16    13     9    49    40  61
</code></pre>

<pre><code class="r">#####Changing the names#####

df9_it$Aggregate &lt;- paste(df9_it$Goals, df9_it$NA..3, sep = &quot;-&quot;)
head(df9_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Juventus    38  29     4     5    75    20  91     75-20
## 2 2     Napoli    38  25     7     6    80    32  82     80-32
## 3 3       Roma    38  23    11     4    83    41  80     83-41
## 4 4      Inter    38  20     7    11    50    38  67     50-38
## 5 5 Fiorentina    38  18    10    10    60    42  64     60-42
## 6 6   Sassuolo    38  16    13     9    49    40  61     49-40
</code></pre>

<pre><code class="r">df9_it &lt;- df9_it[ ,c(1:6, 10, 9)]
head(df9_it)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Juventus    38  29     4     5     75-20  91
## 2 2     Napoli    38  25     7     6     80-32  82
## 3 3       Roma    38  23    11     4     83-41  80
## 4 4      Inter    38  20     7    11     50-38  67
## 5 5 Fiorentina    38  18    10    10     60-42  64
## 6 6   Sassuolo    38  16    13     9     49-40  61
</code></pre>

<pre><code class="r">names(df9_it) &lt;- names(data_9)
head(df9_it)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1   Juventus    38   29     4    5     75-20     91
## 2     2     Napoli    38   25     7    6     80-32     82
## 3     3       Roma    38   23    11    4     83-41     80
## 4     4      Inter    38   20     7   11     50-38     67
## 5     5 Fiorentina    38   18    10   10     60-42     64
## 6     6   Sassuolo    38   16    13    9     49-40     61
</code></pre>

<pre><code class="r">str(df9_it)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Juventus&quot; &quot;Napoli&quot; &quot;Roma&quot; &quot;Inter&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 8 7 6 5 5 4 4 ...
##  $ Draws    : Factor w/ 8 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 6 2 6 1 4 3 7 2 6 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;14&quot;,..: 12 13 11 2 1 14 2 3 3 7 ...
##  $ Aggregate: chr  &quot;75-20&quot; &quot;80-32&quot; &quot;83-41&quot; &quot;50-38&quot; ...
##  $ Points   : num  91 82 80 67 64 61 57 54 50 46 ...
</code></pre>

<pre><code class="r">df9_it[ ,c(3:6)] &lt;- apply(df9_it[ ,c(3:6)], 2, as.numeric)

match(df8_it$Teams, df9_it$Teams)
</code></pre>

<pre><code>##  [1]  1  3  8  5  2 10 15  4 12 NA 17  6 20  9 11 16 13 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df8_it$Teams, df9_it$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Roma&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Juventus&quot;,&quot;Napoli&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.0 0.0 0.0 0.3 0.0
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1     Var2 Distance
## 1   Juventus Juventus     1.00
## 2       Roma Juventus     0.00
## 3      Lazio Juventus     0.00
## 4 Fiorentina Juventus     0.30
## 5     Napoli Juventus     0.00
## 6      Genoa Juventus     0.25
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Milan and Ac Milan###
###We change the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1    Juventus   Juventus 1.0000000
## 25     Napoli     Napoli 1.0000000
## 35     Empoli     Napoli 0.6666667
## 42       Roma       Roma 1.0000000
## 68      Inter      Inter 1.0000000
## 84 Fiorentina Fiorentina 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1    Juventus   Juventus 1.0000000
## 2      Napoli     Napoli 1.0000000
## 4        Roma       Roma 1.0000000
## 5       Inter      Inter 1.0000000
## 6  Fiorentina Fiorentina 1.0000000
## 7    Sassuolo   Sassuolo 1.0000000
## 9       Lazio      Lazio 1.0000000
## 10     Chievo     Chievo 1.0000000
## 11      Genoa      Genoa 1.0000000
## 14     Empoli     Empoli 1.0000000
## 15     Torino     Torino 1.0000000
## 16   Atalanta   Atalanta 1.0000000
## 17  Sampdoria  Sampdoria 1.0000000
## 18    Udinese    Udinese 1.0000000
## 19    Palermo    Palermo 1.0000000
## 22     Verona     Verona 1.0000000
## 3      Empoli     Napoli 0.6666667
## 13     Napoli     Empoli 0.6666667
## 8       Milan   Ac Milan 0.6250000
## 20      Parma    Palermo 0.5714286
## 12     Verona      Genoa 0.5000000
## 21      Genoa     Verona 0.5000000
## 23     Cesena     Verona 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df9_it$Teams[df9_it$Teams == &quot;Ac Milan&quot;] &lt;- df8_it$Teams[df8_it$Teams == &quot;Milan&quot;]

###Checking match funtion after the correction
match(df8_it$Teams, df9_it$Teams)
</code></pre>

<pre><code>##  [1]  1  3  8  5  2 10 15  4 12  7 17  6 20  9 11 16 13 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2014-2015 in Serie A: https://en.wikipedia.org/wiki/2014-15_Serie_A##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_SPL09)#####
####SPL09 = Spanish League season 2008-2009####

library(dplyr)

head(data_SPL09)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BARCELONA    38  27     6     5   105    35   14     3     2
## 3  2 REAL MADRID    38  25     3    10    83    52   14     2     3
## 4  3     SEVILLA    38  21     7    10    54    39   11     2     6
## 5  4 ATL. MADRID    38  20     7    11    80    57   13     1     5
## 6  5  VILLARREAL    38  18    11     9    61    54   12     3     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      61    14   13     3     3      44    21  87
## 3      49    29   11     1     7      34    23  78
## 4      28    20   10     5     4      26    19  70
## 5      47    23    7     6     6      33    34  67
## 6      33    25    6     8     5      28    29  65
</code></pre>

<pre><code class="r">data_SPL09 &lt;- data_SPL09[-1 , ]

####Converting teams names to lower case
data_SPL09$Team2 &lt;-  tolower(data_SPL09$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL09$Team3 &lt;- sapply(data_SPL09$Team2, simpleCap)

data_SPL09$Team4 &lt;- as.factor(data_SPL09$Team3)

data_SPL09$Team5 &lt;-as.character(data_SPL09$Team4)
rownames(data_SPL09) &lt;- 1:nrow(data_SPL09)
head(data_SPL09)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  27     6     5   105    35   14     3     2      61
## 2 2 REAL MADRID    38  25     3    10    83    52   14     2     3      49
## 3 3     SEVILLA    38  21     7    10    54    39   11     2     6      28
## 4 4 ATL. MADRID    38  20     7    11    80    57   13     1     5      47
## 5 5  VILLARREAL    38  18    11     9    61    54   12     3     4      33
## 6 6    VALENCIA    38  18     8    12    68    54   12     4     3      47
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    14   13     3     3      44    21  87   barcelona   Barcelona
## 2    29   11     1     7      34    23  78 real madrid Real Madrid
## 3    20   10     5     4      26    19  70     sevilla     Sevilla
## 4    23    7     6     6      33    34  67 atl. madrid Atl. Madrid
## 5    25    6     8     5      28    29  65  villarreal  Villarreal
## 6    26    6     4     9      21    28  62    valencia    Valencia
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3     Sevilla     Sevilla
## 4 Atl. Madrid Atl. Madrid
## 5  Villarreal  Villarreal
## 6    Valencia    Valencia
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL09)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  27     6     5   105    35   14     3     2      61
## 2 2 REAL MADRID    38  25     3    10    83    52   14     2     3      49
## 3 3     SEVILLA    38  21     7    10    54    39   11     2     6      28
## 4 4 ATL. MADRID    38  20     7    11    80    57   13     1     5      47
## 5 5  VILLARREAL    38  18    11     9    61    54   12     3     4      33
## 6 6    VALENCIA    38  18     8    12    68    54   12     4     3      47
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    14   13     3     3      44    21  87   barcelona   Barcelona
## 2    29   11     1     7      34    23  78 real madrid Real Madrid
## 3    20   10     5     4      26    19  70     sevilla     Sevilla
## 4    23    7     6     6      33    34  67 atl. madrid Atl. Madrid
## 5    25    6     8     5      28    29  65  villarreal  Villarreal
## 6    26    6     4     9      21    28  62    valencia    Valencia
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3     Sevilla     Sevilla
## 4 Atl. Madrid Atl. Madrid
## 5  Villarreal  Villarreal
## 6    Valencia    Valencia
</code></pre>

<pre><code class="r">names(data_SPL09)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df_sp &lt;- data_SPL09[c(1, 23, 3:8, 19)]

str(df_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Sevilla&quot; &quot;Atl. Madrid&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 10 9 8 7 7 6 5 4 2 ...
##  $ NA..1: Factor w/ 12 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 8 6 9 9 3 10 2 2 11 3 ...
##  $ NA..2: Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 1 1 2 12 3 3 4 5 5 ...
##  $ Goals: Factor w/ 19 levels &quot;105&quot;,&quot;34&quot;,&quot;38&quot;,..: 1 18 13 17 15 16 8 14 12 6 ...
##  $ NA..3: Factor w/ 17 levels &quot;35&quot;,&quot;39&quot;,&quot;47&quot;,..: 1 6 2 9 7 7 3 11 12 5 ...
##  $ Pts  : num  87 78 70 67 65 62 58 55 51 47 ...
</code></pre>

<pre><code class="r">head(df_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Barcelona    38  27     6     5   105    35  87
## 2 2 Real Madrid    38  25     3    10    83    52  78
## 3 3     Sevilla    38  21     7    10    54    39  70
## 4 4 Atl. Madrid    38  20     7    11    80    57  67
## 5 5  Villarreal    38  18    11     9    61    54  65
## 6 6    Valencia    38  18     8    12    68    54  62
</code></pre>

<pre><code class="r">#####Changing the names#####

df_sp$Aggregate &lt;- paste(df_sp$Goals, df_sp$NA..3, sep = &quot;-&quot;)
head(df_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Barcelona    38  27     6     5   105    35  87    105-35
## 2 2 Real Madrid    38  25     3    10    83    52  78     83-52
## 3 3     Sevilla    38  21     7    10    54    39  70     54-39
## 4 4 Atl. Madrid    38  20     7    11    80    57  67     80-57
## 5 5  Villarreal    38  18    11     9    61    54  65     61-54
## 6 6    Valencia    38  18     8    12    68    54  62     68-54
</code></pre>

<pre><code class="r">df_sp &lt;- df_sp[ ,c(1:6, 10, 9)]
head(df_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Barcelona    38  27     6     5    105-35  87
## 2 2 Real Madrid    38  25     3    10     83-52  78
## 3 3     Sevilla    38  21     7    10     54-39  70
## 4 4 Atl. Madrid    38  20     7    11     80-57  67
## 5 5  Villarreal    38  18    11     9     61-54  65
## 6 6    Valencia    38  18     8    12     68-54  62
</code></pre>

<pre><code class="r">names(df_sp) &lt;- names(data_9)
head(df_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1   Barcelona    38   27     6    5    105-35     87
## 2     2 Real Madrid    38   25     3   10     83-52     78
## 3     3     Sevilla    38   21     7   10     54-39     70
## 4     4 Atl. Madrid    38   20     7   11     80-57     67
## 5     5  Villarreal    38   18    11    9     61-54     65
## 6     6    Valencia    38   18     8   12     68-54     62
</code></pre>

<pre><code class="r">str(df_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Sevilla&quot; &quot;Atl. Madrid&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 10 9 8 7 7 6 5 4 2 ...
##  $ Draws    : Factor w/ 12 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 8 6 9 9 3 10 2 2 11 3 ...
##  $ Loss     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 1 1 2 12 3 3 4 5 5 ...
##  $ Aggregate: chr  &quot;105-35&quot; &quot;83-52&quot; &quot;54-39&quot; &quot;80-57&quot; ...
##  $ Points   : num  87 78 70 67 65 62 58 55 51 47 ...
</code></pre>

<pre><code class="r">df_sp[ ,c(3:6)] &lt;- apply(df_sp[ ,c(3:6)], 2, as.numeric)


#####Manipulating the upper case issue in imported data (data_SPL10)#####

#library(dplyr)

head(data_SPL10)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BARCELONA    38  31     6     1    98    24   18     1     0
## 3  2 REAL MADRID    38  31     3     4   102    35   18     0     1
## 4  3    VALENCIA    38  21     8     9    59    40   13     5     1
## 5  4     SEVILLA    38  19     6    13    65    49   10     6     3
## 6  5    MALLORCA    38  18     8    12    59    44   15     1     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      57    11   13     5     1      41    13  99
## 3      60    18   13     3     3      42    17  96
## 4      34    12    8     3     8      25    28  71
## 5      33    18    9     0    10      32    31  63
## 6      42    15    3     7     9      17    29  62
</code></pre>

<pre><code class="r">data_SPL10 &lt;- data_SPL10[-1 , ]

####Converting teams names to lower case
data_SPL10$Team2 &lt;-  tolower(data_SPL10$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL10$Team3 &lt;- sapply(data_SPL10$Team2, simpleCap)

data_SPL10$Team4 &lt;- as.factor(data_SPL10$Team3)

data_SPL10$Team5 &lt;-as.character(data_SPL10$Team4)
rownames(data_SPL10) &lt;- 1:nrow(data_SPL10)
head(data_SPL10)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  31     6     1    98    24   18     1     0      57
## 2 2 REAL MADRID    38  31     3     4   102    35   18     0     1      60
## 3 3    VALENCIA    38  21     8     9    59    40   13     5     1      34
## 4 4     SEVILLA    38  19     6    13    65    49   10     6     3      33
## 5 5    MALLORCA    38  18     8    12    59    44   15     1     3      42
## 6 6      GETAFE    38  17     7    14    58    48   11     4     4      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    11   13     5     1      41    13  99   barcelona   Barcelona
## 2    18   13     3     3      42    17  96 real madrid Real Madrid
## 3    12    8     3     8      25    28  71    valencia    Valencia
## 4    18    9     0    10      32    31  63     sevilla     Sevilla
## 5    15    3     7     9      17    29  62    mallorca    Mallorca
## 6    22    6     3    10      24    26  58      getafe      Getafe
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3    Valencia    Valencia
## 4     Sevilla     Sevilla
## 5    Mallorca    Mallorca
## 6      Getafe      Getafe
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL10)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  31     6     1    98    24   18     1     0      57
## 2 2 REAL MADRID    38  31     3     4   102    35   18     0     1      60
## 3 3    VALENCIA    38  21     8     9    59    40   13     5     1      34
## 4 4     SEVILLA    38  19     6    13    65    49   10     6     3      33
## 5 5    MALLORCA    38  18     8    12    59    44   15     1     3      42
## 6 6      GETAFE    38  17     7    14    58    48   11     4     4      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    11   13     5     1      41    13  99   barcelona   Barcelona
## 2    18   13     3     3      42    17  96 real madrid Real Madrid
## 3    12    8     3     8      25    28  71    valencia    Valencia
## 4    18    9     0    10      32    31  63     sevilla     Sevilla
## 5    15    3     7     9      17    29  62    mallorca    Mallorca
## 6    22    6     3    10      24    26  58      getafe      Getafe
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3    Valencia    Valencia
## 4     Sevilla     Sevilla
## 5    Mallorca    Mallorca
## 6      Getafe      Getafe
</code></pre>

<pre><code class="r">names(data_SPL10)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df3_sp &lt;- data_SPL10[c(1, 23, 3:8, 19)]

str(df3_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Valencia&quot; &quot;Sevilla&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 10 9 8 7 6 5 4 3 3 ...
##  $ NA..1: Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 10 8 10 9 10 11 10 10 ...
##  $ NA..2: Factor w/ 11 levels &quot;1&quot;,&quot;12&quot;,&quot;13&quot;,..: 1 9 10 3 2 4 4 4 7 7 ...
##  $ Goals: Factor w/ 17 levels &quot;102&quot;,&quot;29&quot;,&quot;35&quot;,..: 16 1 14 15 14 13 13 11 12 3 ...
##  $ NA..3: Factor w/ 18 levels &quot;24&quot;,&quot;35&quot;,&quot;40&quot;,..: 1 2 3 7 4 6 11 9 13 7 ...
##  $ Pts  : num  99 96 71 63 62 58 56 54 47 47 ...
</code></pre>

<pre><code class="r">head(df3_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Barcelona    38  31     6     1    98    24  99
## 2 2 Real Madrid    38  31     3     4   102    35  96
## 3 3    Valencia    38  21     8     9    59    40  71
## 4 4     Sevilla    38  19     6    13    65    49  63
## 5 5    Mallorca    38  18     8    12    59    44  62
## 6 6      Getafe    38  17     7    14    58    48  58
</code></pre>

<pre><code class="r">#####Changing the names#####

df3_sp$Aggregate &lt;- paste(df3_sp$Goals, df3_sp$NA..3, sep = &quot;-&quot;)
head(df3_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Barcelona    38  31     6     1    98    24  99     98-24
## 2 2 Real Madrid    38  31     3     4   102    35  96    102-35
## 3 3    Valencia    38  21     8     9    59    40  71     59-40
## 4 4     Sevilla    38  19     6    13    65    49  63     65-49
## 5 5    Mallorca    38  18     8    12    59    44  62     59-44
## 6 6      Getafe    38  17     7    14    58    48  58     58-48
</code></pre>

<pre><code class="r">df3_sp &lt;- df3_sp[ ,c(1:6, 10, 9)]
head(df3_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Barcelona    38  31     6     1     98-24  99
## 2 2 Real Madrid    38  31     3     4    102-35  96
## 3 3    Valencia    38  21     8     9     59-40  71
## 4 4     Sevilla    38  19     6    13     65-49  63
## 5 5    Mallorca    38  18     8    12     59-44  62
## 6 6      Getafe    38  17     7    14     58-48  58
</code></pre>

<pre><code class="r">names(df3_sp) &lt;- names(data_9)
head(df3_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1   Barcelona    38   31     6    1     98-24     99
## 2     2 Real Madrid    38   31     3    4    102-35     96
## 3     3    Valencia    38   21     8    9     59-40     71
## 4     4     Sevilla    38   19     6   13     65-49     63
## 5     5    Mallorca    38   18     8   12     59-44     62
## 6     6      Getafe    38   17     7   14     58-48     58
</code></pre>

<pre><code class="r">str(df3_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Valencia&quot; &quot;Sevilla&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 10 9 8 7 6 5 4 3 3 ...
##  $ Draws    : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 10 8 10 9 10 11 10 10 ...
##  $ Loss     : Factor w/ 11 levels &quot;1&quot;,&quot;12&quot;,&quot;13&quot;,..: 1 9 10 3 2 4 4 4 7 7 ...
##  $ Aggregate: chr  &quot;98-24&quot; &quot;102-35&quot; &quot;59-40&quot; &quot;65-49&quot; ...
##  $ Points   : num  99 96 71 63 62 58 56 54 47 47 ...
</code></pre>

<pre><code class="r">df3_sp[ ,c(3:6)] &lt;- apply(df3_sp[ ,c(3:6)], 2, as.numeric)

match(df_sp$Teams, df3_sp$Teams)
</code></pre>

<pre><code>##  [1]  1  2  4  9  7  3 10 17  5 11 16 13  8 12 18 15  6 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df_sp$Teams, df3_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00000000 0.09090909 0.22222222 0.00000000 0.10000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1      Var2   Distance
## 1   Barcelona Barcelona 1.00000000
## 2 Real Madrid Barcelona 0.09090909
## 3     Sevilla Barcelona 0.22222222
## 4 Atl. Madrid Barcelona 0.00000000
## 5  Villarreal Barcelona 0.10000000
## 6    Valencia Barcelona 0.33333333
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1        Var2  Distance
## 1    Barcelona   Barcelona 1.0000000
## 22 Real Madrid Real Madrid 1.0000000
## 24 Atl. Madrid Real Madrid 0.6363636
## 46    Valencia    Valencia 1.0000000
## 59    Numancia    Valencia 0.5000000
## 63     Sevilla     Sevilla 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 1         Barcelona        Barcelona 1.0000000
## 2       Real Madrid      Real Madrid 1.0000000
## 4          Valencia         Valencia 1.0000000
## 6           Sevilla          Sevilla 1.0000000
## 8          Mallorca         Mallorca 1.0000000
## 9            Getafe           Getafe 1.0000000
## 10       Villarreal       Villarreal 1.0000000
## 11       Ath Bilbao       Ath Bilbao 1.0000000
## 13      Atl. Madrid      Atl. Madrid 1.0000000
## 14   Dep. La Coruna   Dep. La Coruna 1.0000000
## 15         Espanyol         Espanyol 1.0000000
## 16          Osasuna          Osasuna 1.0000000
## 17          Almeria          Almeria 1.0000000
## 19   Sporting Gijon   Sporting Gijon 1.0000000
## 20 Racing Santander Racing Santander 1.0000000
## 21           Malaga           Malaga 1.0000000
## 23       Valladolid       Valladolid 1.0000000
## 3       Atl. Madrid      Real Madrid 0.6363636
## 12      Real Madrid      Atl. Madrid 0.6363636
## 5          Numancia         Valencia 0.5000000
## 7            Malaga         Mallorca 0.5000000
## 18           Malaga         Zaragoza 0.5000000
## 22         Mallorca           Malaga 0.5000000
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
#match(df2_it$Teams, df3_sp$Teams)

###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2008-2009 in Primera Division: https://en.wikipedia.org/wiki/2008-09_La_Liga##
###To be true, each season in Primera Division are relegated three teams (thesis, Table 3: Values of N, K, and I in European football leagues from 2008 - 2016 (8 seasons))


#####Manipulating the upper case issue in imported data (data_SPL11)#####

#library(dplyr)

head(data_SPL11)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BARCELONA    38  30     6     2    95    21   16     2     1
## 3  2 REAL MADRID    38  29     5     4   102    33   16     1     2
## 4  3    VALENCIA    38  21     8     9    64    44   10     5     4
## 5  4  VILLARREAL    38  18     8    12    54    44   13     3     3
## 6  5 ATL. MADRID    38  17     7    14    62    53   10     3     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      46    10   14     4     1      49    11  96
## 3      61    12   13     4     2      41    21  92
## 4      34    21   11     3     5      30    23  71
## 5      33    14    5     5     9      21    30  62
## 6      35    20    7     4     8      27    33  58
</code></pre>

<pre><code class="r">data_SPL11 &lt;- data_SPL11[-1 , ]

####Converting teams names to lower case
data_SPL11$Team2 &lt;-  tolower(data_SPL11$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL11$Team3 &lt;- sapply(data_SPL11$Team2, simpleCap)

data_SPL11$Team4 &lt;- as.factor(data_SPL11$Team3)

data_SPL11$Team5 &lt;-as.character(data_SPL11$Team4)
rownames(data_SPL11) &lt;- 1:nrow(data_SPL11)
head(data_SPL11)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  30     6     2    95    21   16     2     1      46
## 2 2 REAL MADRID    38  29     5     4   102    33   16     1     2      61
## 3 3    VALENCIA    38  21     8     9    64    44   10     5     4      34
## 4 4  VILLARREAL    38  18     8    12    54    44   13     3     3      33
## 5 5 ATL. MADRID    38  17     7    14    62    53   10     3     6      35
## 6 6  ATH BILBAO    38  18     4    16    59    55   12     1     6      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    10   14     4     1      49    11  96   barcelona   Barcelona
## 2    12   13     4     2      41    21  92 real madrid Real Madrid
## 3    21   11     3     5      30    23  71    valencia    Valencia
## 4    14    5     5     9      21    30  62  villarreal  Villarreal
## 5    20    7     4     8      27    33  58 atl. madrid Atl. Madrid
## 6    20    6     3    10      27    35  58  ath bilbao  Ath Bilbao
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3    Valencia    Valencia
## 4  Villarreal  Villarreal
## 5 Atl. Madrid Atl. Madrid
## 6  Ath Bilbao  Ath Bilbao
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL11)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  30     6     2    95    21   16     2     1      46
## 2 2 REAL MADRID    38  29     5     4   102    33   16     1     2      61
## 3 3    VALENCIA    38  21     8     9    64    44   10     5     4      34
## 4 4  VILLARREAL    38  18     8    12    54    44   13     3     3      33
## 5 5 ATL. MADRID    38  17     7    14    62    53   10     3     6      35
## 6 6  ATH BILBAO    38  18     4    16    59    55   12     1     6      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    10   14     4     1      49    11  96   barcelona   Barcelona
## 2    12   13     4     2      41    21  92 real madrid Real Madrid
## 3    21   11     3     5      30    23  71    valencia    Valencia
## 4    14    5     5     9      21    30  62  villarreal  Villarreal
## 5    20    7     4     8      27    33  58 atl. madrid Atl. Madrid
## 6    20    6     3    10      27    35  58  ath bilbao  Ath Bilbao
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3    Valencia    Valencia
## 4  Villarreal  Villarreal
## 5 Atl. Madrid Atl. Madrid
## 6  Ath Bilbao  Ath Bilbao
</code></pre>

<pre><code class="r">names(data_SPL11)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df4_sp &lt;- data_SPL11[c(1, 23, 3:8, 19)]

str(df4_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Valencia&quot; &quot;Villarreal&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 8 7 8 7 6 4 2 ...
##  $ NA..1: Factor w/ 12 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 7 10 10 9 6 9 6 10 4 ...
##  $ NA..2: Factor w/ 14 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 9 12 13 1 3 5 3 8 6 2 ...
##  $ Goals: Factor w/ 15 levels &quot;102&quot;,&quot;31&quot;,&quot;35&quot;,..: 14 1 13 10 12 11 12 8 7 3 ...
##  $ NA..3: Factor w/ 16 levels &quot;21&quot;,&quot;33&quot;,&quot;42&quot;,..: 1 2 4 4 8 9 12 9 5 3 ...
##  $ Pts  : num  96 92 71 62 58 58 58 49 47 47 ...
</code></pre>

<pre><code class="r">head(df4_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Barcelona    38  30     6     2    95    21  96
## 2 2 Real Madrid    38  29     5     4   102    33  92
## 3 3    Valencia    38  21     8     9    64    44  71
## 4 4  Villarreal    38  18     8    12    54    44  62
## 5 5 Atl. Madrid    38  17     7    14    62    53  58
## 6 6  Ath Bilbao    38  18     4    16    59    55  58
</code></pre>

<pre><code class="r">#####Changing the names#####

df4_sp$Aggregate &lt;- paste(df4_sp$Goals, df4_sp$NA..3, sep = &quot;-&quot;)
head(df4_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Barcelona    38  30     6     2    95    21  96     95-21
## 2 2 Real Madrid    38  29     5     4   102    33  92    102-33
## 3 3    Valencia    38  21     8     9    64    44  71     64-44
## 4 4  Villarreal    38  18     8    12    54    44  62     54-44
## 5 5 Atl. Madrid    38  17     7    14    62    53  58     62-53
## 6 6  Ath Bilbao    38  18     4    16    59    55  58     59-55
</code></pre>

<pre><code class="r">df4_sp &lt;- df4_sp[ ,c(1:6, 10, 9)]
head(df4_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Barcelona    38  30     6     2     95-21  96
## 2 2 Real Madrid    38  29     5     4    102-33  92
## 3 3    Valencia    38  21     8     9     64-44  71
## 4 4  Villarreal    38  18     8    12     54-44  62
## 5 5 Atl. Madrid    38  17     7    14     62-53  58
## 6 6  Ath Bilbao    38  18     4    16     59-55  58
</code></pre>

<pre><code class="r">names(df4_sp) &lt;- names(data_9)
head(df4_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1   Barcelona    38   30     6    2     95-21     96
## 2     2 Real Madrid    38   29     5    4    102-33     92
## 3     3    Valencia    38   21     8    9     64-44     71
## 4     4  Villarreal    38   18     8   12     54-44     62
## 5     5 Atl. Madrid    38   17     7   14     62-53     58
## 6     6  Ath Bilbao    38   18     4   16     59-55     58
</code></pre>

<pre><code class="r">str(df4_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Valencia&quot; &quot;Villarreal&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 8 7 8 7 6 4 2 ...
##  $ Draws    : Factor w/ 12 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 7 10 10 9 6 9 6 10 4 ...
##  $ Loss     : Factor w/ 14 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 9 12 13 1 3 5 3 8 6 2 ...
##  $ Aggregate: chr  &quot;95-21&quot; &quot;102-33&quot; &quot;64-44&quot; &quot;54-44&quot; ...
##  $ Points   : num  96 92 71 62 58 58 58 49 47 47 ...
</code></pre>

<pre><code class="r">df4_sp[ ,c(3:6)] &lt;- apply(df4_sp[ ,c(3:6)], 2, as.numeric)

match(df3_sp$Teams, df4_sp$Teams)
</code></pre>

<pre><code>##  [1]  1  2  3  7 17 16  4  6  5 18  8  9 20 14 10 12 11 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df3_sp$Teams, df4_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00000000 0.09090909 0.33333333 0.22222222 0.33333333
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1      Var2   Distance
## 1   Barcelona Barcelona 1.00000000
## 2 Real Madrid Barcelona 0.09090909
## 3    Valencia Barcelona 0.33333333
## 4     Sevilla Barcelona 0.22222222
## 5    Mallorca Barcelona 0.33333333
## 6      Getafe Barcelona 0.11111111
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1        Var2  Distance
## 1    Barcelona   Barcelona 1.0000000
## 22 Real Madrid Real Madrid 1.0000000
## 29 Atl. Madrid Real Madrid 0.6363636
## 43    Valencia    Valencia 1.0000000
## 67  Villarreal  Villarreal 1.0000000
## 82 Real Madrid Atl. Madrid 0.6363636
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 1         Barcelona        Barcelona 1.0000000
## 2       Real Madrid      Real Madrid 1.0000000
## 4          Valencia         Valencia 1.0000000
## 5        Villarreal       Villarreal 1.0000000
## 7       Atl. Madrid      Atl. Madrid 1.0000000
## 8        Ath Bilbao       Ath Bilbao 1.0000000
## 9           Sevilla          Sevilla 1.0000000
## 10         Espanyol         Espanyol 1.0000000
## 11          Osasuna          Osasuna 1.0000000
## 12   Sporting Gijon   Sporting Gijon 1.0000000
## 15           Malaga           Malaga 1.0000000
## 16 Racing Santander Racing Santander 1.0000000
## 17         Zaragoza         Zaragoza 1.0000000
## 19           Getafe           Getafe 1.0000000
## 20         Mallorca         Mallorca 1.0000000
## 22   Dep. La Coruna   Dep. La Coruna 1.0000000
## 23          Almeria          Almeria 1.0000000
## 3       Atl. Madrid      Real Madrid 0.6363636
## 6       Real Madrid      Atl. Madrid 0.6363636
## 13         Mallorca           Malaga 0.5000000
## 14         Zaragoza           Malaga 0.5000000
## 18           Malaga         Zaragoza 0.5000000
## 21           Malaga         Mallorca 0.5000000
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
match(df3_sp$Teams, df4_sp$Teams)
</code></pre>

<pre><code>##  [1]  1  2  3  7 17 16  4  6  5 18  8  9 20 14 10 12 11 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2009-2010 in Primera Division: https://en.wikipedia.org/wiki/2009-10_La_Liga##

#####Manipulating the upper case issue in imported data (data_SPL12)#####

#library(dplyr)

head(data_SPL12)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 REAL MADRID    38  32     4     2   121    32   16     2     1
## 3  2   BARCELONA    38  28     7     3   114    29   17     1     1
## 4  3    VALENCIA    38  17    10    11    59    44   11     4     4
## 5  4      MALAGA    38  17     7    14    54    53   13     3     3
## 6  5 ATL. MADRID    38  15    11    12    53    46   11     5     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      70    19   16     2     1      51    13 100
## 3      73    11   11     6     2      41    18  91
## 4      40    20    6     6     7      19    24  61
## 5      35    21    4     4    11      19    32  58
## 6      36    17    4     6     9      17    29  56
</code></pre>

<pre><code class="r">data_SPL12 &lt;- data_SPL12[-1 , ]

####Converting teams names to lower case
data_SPL12$Team2 &lt;-  tolower(data_SPL12$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL12$Team3 &lt;- sapply(data_SPL12$Team2, simpleCap)

data_SPL12$Team4 &lt;- as.factor(data_SPL12$Team3)

data_SPL12$Team5 &lt;-as.character(data_SPL12$Team4)
rownames(data_SPL12) &lt;- 1:nrow(data_SPL12)
head(data_SPL12)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 REAL MADRID    38  32     4     2   121    32   16     2     1      70
## 2 2   BARCELONA    38  28     7     3   114    29   17     1     1      73
## 3 3    VALENCIA    38  17    10    11    59    44   11     4     4      40
## 4 4      MALAGA    38  17     7    14    54    53   13     3     3      35
## 5 5 ATL. MADRID    38  15    11    12    53    46   11     5     3      36
## 6 6     LEVANTE    38  16     7    15    54    50   11     3     5      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    19   16     2     1      51    13 100 real madrid Real Madrid
## 2    11   11     6     2      41    18  91   barcelona   Barcelona
## 3    20    6     6     7      19    24  61    valencia    Valencia
## 4    21    4     4    11      19    32  58      malaga      Malaga
## 5    17    4     6     9      17    29  56 atl. madrid Atl. Madrid
## 6    19    5     4    10      21    31  55     levante     Levante
##         Team4       Team5
## 1 Real Madrid Real Madrid
## 2   Barcelona   Barcelona
## 3    Valencia    Valencia
## 4      Malaga      Malaga
## 5 Atl. Madrid Atl. Madrid
## 6     Levante     Levante
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL12)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 REAL MADRID    38  32     4     2   121    32   16     2     1      70
## 2 2   BARCELONA    38  28     7     3   114    29   17     1     1      73
## 3 3    VALENCIA    38  17    10    11    59    44   11     4     4      40
## 4 4      MALAGA    38  17     7    14    54    53   13     3     3      35
## 5 5 ATL. MADRID    38  15    11    12    53    46   11     5     3      36
## 6 6     LEVANTE    38  16     7    15    54    50   11     3     5      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    19   16     2     1      51    13 100 real madrid Real Madrid
## 2    11   11     6     2      41    18  91   barcelona   Barcelona
## 3    20    6     6     7      19    24  61    valencia    Valencia
## 4    21    4     4    11      19    32  58      malaga      Malaga
## 5    17    4     6     9      17    29  56 atl. madrid Atl. Madrid
## 6    19    5     4    10      21    31  55     levante     Levante
##         Team4       Team5
## 1 Real Madrid Real Madrid
## 2   Barcelona   Barcelona
## 3    Valencia    Valencia
## 4      Malaga      Malaga
## 5 Atl. Madrid Atl. Madrid
## 6     Levante     Levante
</code></pre>

<pre><code class="r">names(data_SPL12)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df5_sp &lt;- data_SPL12[c(1, 23, 3:8, 19)]

str(df5_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Real Madrid&quot; &quot;Barcelona&quot; &quot;Valencia&quot; &quot;Malaga&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 7 5 6 3 4 3 2 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 6 8 1 8 2 8 5 1 2 3 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 13 2 5 3 6 1 5 5 4 ...
##  $ Goals: Factor w/ 17 levels &quot;114&quot;,&quot;121&quot;,&quot;28&quot;,..: 2 1 16 15 14 15 9 8 12 13 ...
##  $ NA..3: Factor w/ 15 levels &quot;29&quot;,&quot;32&quot;,&quot;44&quot;,..: 2 1 3 9 4 6 11 4 5 8 ...
##  $ Pts  : num  100 91 61 58 56 55 54 52 50 49 ...
</code></pre>

<pre><code class="r">head(df5_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Real Madrid    38  32     4     2   121    32 100
## 2 2   Barcelona    38  28     7     3   114    29  91
## 3 3    Valencia    38  17    10    11    59    44  61
## 4 4      Malaga    38  17     7    14    54    53  58
## 5 5 Atl. Madrid    38  15    11    12    53    46  56
## 6 6     Levante    38  16     7    15    54    50  55
</code></pre>

<pre><code class="r">#####Changing the names#####

df5_sp$Aggregate &lt;- paste(df5_sp$Goals, df5_sp$NA..3, sep = &quot;-&quot;)
head(df5_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Real Madrid    38  32     4     2   121    32 100    121-32
## 2 2   Barcelona    38  28     7     3   114    29  91    114-29
## 3 3    Valencia    38  17    10    11    59    44  61     59-44
## 4 4      Malaga    38  17     7    14    54    53  58     54-53
## 5 5 Atl. Madrid    38  15    11    12    53    46  56     53-46
## 6 6     Levante    38  16     7    15    54    50  55     54-50
</code></pre>

<pre><code class="r">df5_sp &lt;- df5_sp[ ,c(1:6, 10, 9)]
head(df5_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Real Madrid    38  32     4     2    121-32 100
## 2 2   Barcelona    38  28     7     3    114-29  91
## 3 3    Valencia    38  17    10    11     59-44  61
## 4 4      Malaga    38  17     7    14     54-53  58
## 5 5 Atl. Madrid    38  15    11    12     53-46  56
## 6 6     Levante    38  16     7    15     54-50  55
</code></pre>

<pre><code class="r">names(df5_sp) &lt;- names(data_9)
head(df5_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1 Real Madrid    38   32     4    2    121-32    100
## 2     2   Barcelona    38   28     7    3    114-29     91
## 3     3    Valencia    38   17    10   11     59-44     61
## 4     4      Malaga    38   17     7   14     54-53     58
## 5     5 Atl. Madrid    38   15    11   12     53-46     56
## 6     6     Levante    38   16     7   15     54-50     55
</code></pre>

<pre><code class="r">str(df5_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Real Madrid&quot; &quot;Barcelona&quot; &quot;Valencia&quot; &quot;Malaga&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 7 5 6 3 4 3 2 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 6 8 1 8 2 8 5 1 2 3 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 13 2 5 3 6 1 5 5 4 ...
##  $ Aggregate: chr  &quot;121-32&quot; &quot;114-29&quot; &quot;59-44&quot; &quot;54-53&quot; ...
##  $ Points   : num  100 91 61 58 56 55 54 52 50 49 ...
</code></pre>

<pre><code class="r">df5_sp[ ,c(3:6)] &lt;- apply(df5_sp[ ,c(3:6)], 2, as.numeric)

match(df4_sp$Teams, df5_sp$Teams)
</code></pre>

<pre><code>##  [1]  2  1  3 18  5 10  9 14  7 19  4 20  6 16 11 13  8 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df4_sp$Teams, df5_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Real Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.09090909 1.00000000 0.27272727 0.18181818 0.63636364
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1        Var2   Distance
## 1   Barcelona Real Madrid 0.09090909
## 2 Real Madrid Real Madrid 1.00000000
## 3    Valencia Real Madrid 0.27272727
## 4  Villarreal Real Madrid 0.18181818
## 5 Atl. Madrid Real Madrid 0.63636364
## 6  Ath Bilbao Real Madrid 0.09090909
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1        Var2  Distance
## 2  Real Madrid Real Madrid 1.0000000
## 5  Atl. Madrid Real Madrid 0.6363636
## 21   Barcelona   Barcelona 1.0000000
## 43    Valencia    Valencia 1.0000000
## 71      Malaga      Malaga 1.0000000
## 74    Zaragoza      Malaga 0.5000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 1       Real Madrid      Real Madrid 1.0000000
## 3         Barcelona        Barcelona 1.0000000
## 4          Valencia         Valencia 1.0000000
## 5            Malaga           Malaga 1.0000000
## 9       Atl. Madrid      Atl. Madrid 1.0000000
## 10          Levante          Levante 1.0000000
## 11          Osasuna          Osasuna 1.0000000
## 13         Mallorca         Mallorca 1.0000000
## 14          Sevilla          Sevilla 1.0000000
## 15       Ath Bilbao       Ath Bilbao 1.0000000
## 16    Real Sociedad    Real Sociedad 1.0000000
## 17           Getafe           Getafe 1.0000000
## 18         Espanyol         Espanyol 1.0000000
## 20         Zaragoza         Zaragoza 1.0000000
## 21       Villarreal       Villarreal 1.0000000
## 22   Sporting Gijon   Sporting Gijon 1.0000000
## 23 Racing Santander Racing Santander 1.0000000
## 2       Atl. Madrid      Real Madrid 0.6363636
## 8       Real Madrid      Atl. Madrid 0.6363636
## 6          Zaragoza           Malaga 0.5000000
## 7          Mallorca           Malaga 0.5000000
## 12           Malaga         Mallorca 0.5000000
## 19           Malaga         Zaragoza 0.5000000
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion 
match(df4_sp$Teams, df5_sp$Teams)
</code></pre>

<pre><code>##  [1]  2  1  3 18  5 10  9 14  7 19  4 20  6 16 11 13  8 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2010-2011 in Primera Division: https://en.wikipedia.org/wiki/2010-11_La_Liga##


#####Manipulating the upper case issue in imported data (data_SPL13)#####

#library(dplyr)

head(data_SPL13)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1     BARCELONA    38  32     4     2   115    39   18     1     0
## 3  2   REAL MADRID    38  26     7     5   103    42   17     2     0
## 4  3   ATL. MADRID    38  23     7     8    65    31   14     2     3
## 5  4 REAL SOCIEDAD    38  18    12     8    70    49   10     7     2
## 6  5      VALENCIA    38  19     8    11    67    54   13     3     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      63    14   14     3     2      52    25 100
## 3      67    21    9     5     5      36    21  85
## 4      42    12    9     5     5      23    19  76
## 5      41    22    8     5     6      29    27  66
## 6      42    25    6     5     8      25    29  65
</code></pre>

<pre><code class="r">data_SPL13 &lt;- data_SPL13[-1 , ]

####Converting teams names to lower case
data_SPL13$Team2 &lt;-  tolower(data_SPL13$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL13$Team3 &lt;- sapply(data_SPL13$Team2, simpleCap)

data_SPL13$Team4 &lt;- as.factor(data_SPL13$Team3)

data_SPL13$Team5 &lt;-as.character(data_SPL13$Team4)
rownames(data_SPL13) &lt;- 1:nrow(data_SPL13)
head(data_SPL13)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1     BARCELONA    38  32     4     2   115    39   18     1     0
## 2 2   REAL MADRID    38  26     7     5   103    42   17     2     0
## 3 3   ATL. MADRID    38  23     7     8    65    31   14     2     3
## 4 4 REAL SOCIEDAD    38  18    12     8    70    49   10     7     2
## 5 5      VALENCIA    38  19     8    11    67    54   13     3     3
## 6 6        MALAGA    38  16     9    13    53    50   10     5     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      63    14   14     3     2      52    25 100     barcelona
## 2      67    21    9     5     5      36    21  85   real madrid
## 3      42    12    9     5     5      23    19  76   atl. madrid
## 4      41    22    8     5     6      29    27  66 real sociedad
## 5      42    25    6     5     8      25    29  65      valencia
## 6      33    18    6     4     9      20    32  57        malaga
##           Team3         Team4         Team5
## 1     Barcelona     Barcelona     Barcelona
## 2   Real Madrid   Real Madrid   Real Madrid
## 3   Atl. Madrid   Atl. Madrid   Atl. Madrid
## 4 Real Sociedad Real Sociedad Real Sociedad
## 5      Valencia      Valencia      Valencia
## 6        Malaga        Malaga        Malaga
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL13)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1     BARCELONA    38  32     4     2   115    39   18     1     0
## 2 2   REAL MADRID    38  26     7     5   103    42   17     2     0
## 3 3   ATL. MADRID    38  23     7     8    65    31   14     2     3
## 4 4 REAL SOCIEDAD    38  18    12     8    70    49   10     7     2
## 5 5      VALENCIA    38  19     8    11    67    54   13     3     3
## 6 6        MALAGA    38  16     9    13    53    50   10     5     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      63    14   14     3     2      52    25 100     barcelona
## 2      67    21    9     5     5      36    21  85   real madrid
## 3      42    12    9     5     5      23    19  76   atl. madrid
## 4      41    22    8     5     6      29    27  66 real sociedad
## 5      42    25    6     5     8      25    29  65      valencia
## 6      33    18    6     4     9      20    32  57        malaga
##           Team3         Team4         Team5
## 1     Barcelona     Barcelona     Barcelona
## 2   Real Madrid   Real Madrid   Real Madrid
## 3   Atl. Madrid   Atl. Madrid   Atl. Madrid
## 4 Real Sociedad Real Sociedad Real Sociedad
## 5      Valencia      Valencia      Valencia
## 6        Malaga        Malaga        Malaga
</code></pre>

<pre><code class="r">names(data_SPL13)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df6_sp &lt;- data_SPL13[c(1, 23, 3:8, 19)]

str(df6_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Atl. Madrid&quot; &quot;Real Sociedad&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 7 8 6 6 6 5 4 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 4 6 6 3 7 8 7 5 7 7 ...
##  $ NA..2: Factor w/ 14 levels &quot;11&quot;,&quot;13&quot;,&quot;14&quot;,..: 8 12 13 13 1 2 3 5 4 5 ...
##  $ Goals: Factor w/ 17 levels &quot;103&quot;,&quot;115&quot;,&quot;33&quot;,..: 2 1 14 16 15 11 12 10 13 6 ...
##  $ NA..3: Factor w/ 16 levels &quot;31&quot;,&quot;39&quot;,&quot;42&quot;,..: 2 3 1 4 7 5 8 13 7 9 ...
##  $ Pts  : num  100 85 76 66 65 57 56 53 50 47 ...
</code></pre>

<pre><code class="r">head(df6_sp)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1     Barcelona    38  32     4     2   115    39 100
## 2 2   Real Madrid    38  26     7     5   103    42  85
## 3 3   Atl. Madrid    38  23     7     8    65    31  76
## 4 4 Real Sociedad    38  18    12     8    70    49  66
## 5 5      Valencia    38  19     8    11    67    54  65
## 6 6        Malaga    38  16     9    13    53    50  57
</code></pre>

<pre><code class="r">#####Changing the names#####

df6_sp$Aggregate &lt;- paste(df6_sp$Goals, df6_sp$NA..3, sep = &quot;-&quot;)
head(df6_sp)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1     Barcelona    38  32     4     2   115    39 100    115-39
## 2 2   Real Madrid    38  26     7     5   103    42  85    103-42
## 3 3   Atl. Madrid    38  23     7     8    65    31  76     65-31
## 4 4 Real Sociedad    38  18    12     8    70    49  66     70-49
## 5 5      Valencia    38  19     8    11    67    54  65     67-54
## 6 6        Malaga    38  16     9    13    53    50  57     53-50
</code></pre>

<pre><code class="r">df6_sp &lt;- df6_sp[ ,c(1:6, 10, 9)]
head(df6_sp)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1     Barcelona    38  32     4     2    115-39 100
## 2 2   Real Madrid    38  26     7     5    103-42  85
## 3 3   Atl. Madrid    38  23     7     8     65-31  76
## 4 4 Real Sociedad    38  18    12     8     70-49  66
## 5 5      Valencia    38  19     8    11     67-54  65
## 6 6        Malaga    38  16     9    13     53-50  57
</code></pre>

<pre><code class="r">names(df6_sp) &lt;- names(data_9)
head(df6_sp)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1     Barcelona    38   32     4    2    115-39    100
## 2     2   Real Madrid    38   26     7    5    103-42     85
## 3     3   Atl. Madrid    38   23     7    8     65-31     76
## 4     4 Real Sociedad    38   18    12    8     70-49     66
## 5     5      Valencia    38   19     8   11     67-54     65
## 6     6        Malaga    38   16     9   13     53-50     57
</code></pre>

<pre><code class="r">str(df6_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Atl. Madrid&quot; &quot;Real Sociedad&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 7 8 6 6 6 5 4 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 4 6 6 3 7 8 7 5 7 7 ...
##  $ Loss     : Factor w/ 14 levels &quot;11&quot;,&quot;13&quot;,&quot;14&quot;,..: 8 12 13 13 1 2 3 5 4 5 ...
##  $ Aggregate: chr  &quot;115-39&quot; &quot;103-42&quot; &quot;65-31&quot; &quot;70-49&quot; ...
##  $ Points   : num  100 85 76 66 65 57 56 53 50 47 ...
</code></pre>

<pre><code class="r">df6_sp[ ,c(3:6)] &lt;- apply(df6_sp[ ,c(3:6)], 2, as.numeric)

match(df5_sp$Teams, df6_sp$Teams)
</code></pre>

<pre><code>##  [1]  2  1  5  6  3 11 16 18  9 12  4  7 10 13  8 20 15 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df5_sp$Teams, df6_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Real Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.09090909 1.00000000 0.33333333 0.33333333 0.00000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1      Var2   Distance
## 1 Real Madrid Barcelona 0.09090909
## 2   Barcelona Barcelona 1.00000000
## 3    Valencia Barcelona 0.33333333
## 4      Malaga Barcelona 0.33333333
## 5 Atl. Madrid Barcelona 0.00000000
## 6     Levante Barcelona 0.11111111
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 2      Barcelona     Barcelona 1.0000000
## 21   Real Madrid   Real Madrid 1.0000000
## 25   Atl. Madrid   Real Madrid 0.6363636
## 41   Real Madrid   Atl. Madrid 0.6363636
## 45   Atl. Madrid   Atl. Madrid 1.0000000
## 71 Real Sociedad Real Sociedad 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##              Var1           Var2  Distance
## 1       Barcelona      Barcelona 1.0000000
## 2     Real Madrid    Real Madrid 1.0000000
## 5     Atl. Madrid    Atl. Madrid 1.0000000
## 6   Real Sociedad  Real Sociedad 1.0000000
## 7        Valencia       Valencia 1.0000000
## 8          Malaga         Malaga 1.0000000
## 11          Betis          Betis 1.0000000
## 12 Rayo Vallecano Rayo Vallecano 1.0000000
## 13        Sevilla        Sevilla 1.0000000
## 14         Getafe         Getafe 1.0000000
## 15        Levante        Levante 1.0000000
## 16     Ath Bilbao     Ath Bilbao 1.0000000
## 17       Espanyol       Espanyol 1.0000000
## 18     Granada Cf     Granada Cf 1.0000000
## 19        Osasuna        Osasuna 1.0000000
## 21       Mallorca       Mallorca 1.0000000
## 23       Zaragoza       Zaragoza 1.0000000
## 3     Atl. Madrid    Real Madrid 0.6363636
## 4     Real Madrid    Atl. Madrid 0.6363636
## 9        Mallorca         Malaga 0.5000000
## 10       Zaragoza         Malaga 0.5000000
## 20         Malaga       Mallorca 0.5000000
## 22         Malaga       Zaragoza 0.5000000
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion 
match(df5_sp$Teams, df6_sp$Teams)
</code></pre>

<pre><code>##  [1]  2  1  5  6  3 11 16 18  9 12  4  7 10 13  8 20 15 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2011-2012 in Primera Division: https://en.wikipedia.org/wiki/2011-12_La_Liga##
###As we said before each season are relegated three teams in Primera Division

#####Manipulating the upper case issue in imported data (data_SPL14)#####

#library(dplyr)

head(data_SPL14)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 ATL. MADRID    38  28     6     4    77    26   15     4     0
## 3  2   BARCELONA    38  27     6     5   100    33   16     2     1
## 4  3 REAL MADRID    38  27     6     5   104    38   16     1     2
## 5  4  ATH BILBAO    38  20    10     8    66    39   13     4     2
## 6  5     SEVILLA    38  18     9    11    69    52   11     4     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      49    10   13     2     4      28    16  90
## 3      64    15   11     4     4      36    18  87
## 4      63    17   11     5     3      41    21  87
## 5      42    18    7     6     6      24    21  70
## 6      40    21    7     5     7      29    31  63
</code></pre>

<pre><code class="r">data_SPL14 &lt;- data_SPL14[-1 , ]

####Converting teams names to lower case
data_SPL14$Team2 &lt;-  tolower(data_SPL14$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL14$Team3 &lt;- sapply(data_SPL14$Team2, simpleCap)

data_SPL14$Team4 &lt;- as.factor(data_SPL14$Team3)

data_SPL14$Team5 &lt;-as.character(data_SPL14$Team4)
rownames(data_SPL14) &lt;- 1:nrow(data_SPL14)
head(data_SPL14)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 ATL. MADRID    38  28     6     4    77    26   15     4     0      49
## 2 2   BARCELONA    38  27     6     5   100    33   16     2     1      64
## 3 3 REAL MADRID    38  27     6     5   104    38   16     1     2      63
## 4 4  ATH BILBAO    38  20    10     8    66    39   13     4     2      42
## 5 5     SEVILLA    38  18     9    11    69    52   11     4     4      40
## 6 6  VILLARREAL    38  17     8    13    60    44    9     6     4      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    10   13     2     4      28    16  90 atl. madrid Atl. Madrid
## 2    15   11     4     4      36    18  87   barcelona   Barcelona
## 3    17   11     5     3      41    21  87 real madrid Real Madrid
## 4    18    7     6     6      24    21  70  ath bilbao  Ath Bilbao
## 5    21    7     5     7      29    31  63     sevilla     Sevilla
## 6    21    8     2     9      24    23  59  villarreal  Villarreal
##         Team4       Team5
## 1 Atl. Madrid Atl. Madrid
## 2   Barcelona   Barcelona
## 3 Real Madrid Real Madrid
## 4  Ath Bilbao  Ath Bilbao
## 5     Sevilla     Sevilla
## 6  Villarreal  Villarreal
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL14)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 ATL. MADRID    38  28     6     4    77    26   15     4     0      49
## 2 2   BARCELONA    38  27     6     5   100    33   16     2     1      64
## 3 3 REAL MADRID    38  27     6     5   104    38   16     1     2      63
## 4 4  ATH BILBAO    38  20    10     8    66    39   13     4     2      42
## 5 5     SEVILLA    38  18     9    11    69    52   11     4     4      40
## 6 6  VILLARREAL    38  17     8    13    60    44    9     6     4      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    10   13     2     4      28    16  90 atl. madrid Atl. Madrid
## 2    15   11     4     4      36    18  87   barcelona   Barcelona
## 3    17   11     5     3      41    21  87 real madrid Real Madrid
## 4    18    7     6     6      24    21  70  ath bilbao  Ath Bilbao
## 5    21    7     5     7      29    31  63     sevilla     Sevilla
## 6    21    8     2     9      24    23  59  villarreal  Villarreal
##         Team4       Team5
## 1 Atl. Madrid Atl. Madrid
## 2   Barcelona   Barcelona
## 3 Real Madrid Real Madrid
## 4  Ath Bilbao  Ath Bilbao
## 5     Sevilla     Sevilla
## 6  Villarreal  Villarreal
</code></pre>

<pre><code class="r">names(data_SPL14)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df7_sp &lt;- data_SPL14[c(1, 23, 3:8, 19)]

str(df7_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Atl. Madrid&quot; &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Ath Bilbao&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 10 9 8 7 6 4 5 3 ...
##  $ NA..1: Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 8 8 1 11 10 2 1 9 3 ...
##  $ NA..2: Factor w/ 15 levels &quot;11&quot;,&quot;13&quot;,&quot;14&quot;,..: 12 13 13 14 1 2 1 4 6 3 ...
##  $ Goals: Factor w/ 19 levels &quot;100&quot;,&quot;104&quot;,&quot;30&quot;,..: 18 1 2 16 17 14 15 13 12 5 ...
##  $ NA..3: Factor w/ 20 levels &quot;26&quot;,&quot;33&quot;,&quot;38&quot;,..: 1 2 3 4 10 6 13 11 12 5 ...
##  $ Pts  : num  90 87 87 70 63 59 59 49 49 48 ...
</code></pre>

<pre><code class="r">head(df7_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Atl. Madrid    38  28     6     4    77    26  90
## 2 2   Barcelona    38  27     6     5   100    33  87
## 3 3 Real Madrid    38  27     6     5   104    38  87
## 4 4  Ath Bilbao    38  20    10     8    66    39  70
## 5 5     Sevilla    38  18     9    11    69    52  63
## 6 6  Villarreal    38  17     8    13    60    44  59
</code></pre>

<pre><code class="r">#####Changing the names#####

df7_sp$Aggregate &lt;- paste(df7_sp$Goals, df7_sp$NA..3, sep = &quot;-&quot;)
head(df7_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Atl. Madrid    38  28     6     4    77    26  90     77-26
## 2 2   Barcelona    38  27     6     5   100    33  87    100-33
## 3 3 Real Madrid    38  27     6     5   104    38  87    104-38
## 4 4  Ath Bilbao    38  20    10     8    66    39  70     66-39
## 5 5     Sevilla    38  18     9    11    69    52  63     69-52
## 6 6  Villarreal    38  17     8    13    60    44  59     60-44
</code></pre>

<pre><code class="r">df7_sp &lt;- df7_sp[ ,c(1:6, 10, 9)]
head(df7_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Atl. Madrid    38  28     6     4     77-26  90
## 2 2   Barcelona    38  27     6     5    100-33  87
## 3 3 Real Madrid    38  27     6     5    104-38  87
## 4 4  Ath Bilbao    38  20    10     8     66-39  70
## 5 5     Sevilla    38  18     9    11     69-52  63
## 6 6  Villarreal    38  17     8    13     60-44  59
</code></pre>

<pre><code class="r">names(df7_sp) &lt;- names(data_9)
head(df7_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1 Atl. Madrid    38   28     6    4     77-26     90
## 2     2   Barcelona    38   27     6    5    100-33     87
## 3     3 Real Madrid    38   27     6    5    104-38     87
## 4     4  Ath Bilbao    38   20    10    8     66-39     70
## 5     5     Sevilla    38   18     9   11     69-52     63
## 6     6  Villarreal    38   17     8   13     60-44     59
</code></pre>

<pre><code class="r">str(df7_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Atl. Madrid&quot; &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Ath Bilbao&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 10 9 8 7 6 4 5 3 ...
##  $ Draws    : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 8 8 1 11 10 2 1 9 3 ...
##  $ Loss     : Factor w/ 15 levels &quot;11&quot;,&quot;13&quot;,&quot;14&quot;,..: 12 13 13 14 1 2 1 4 6 3 ...
##  $ Aggregate: chr  &quot;77-26&quot; &quot;100-33&quot; &quot;104-38&quot; &quot;66-39&quot; ...
##  $ Points   : num  90 87 87 70 63 59 59 49 49 48 ...
</code></pre>

<pre><code class="r">df7_sp[ ,c(3:6)] &lt;- apply(df7_sp[ ,c(3:6)], 2, as.numeric)

match(df6_sp$Teams, df7_sp$Teams)
</code></pre>

<pre><code>##  [1]  2  3  1  7  8 11 20 12  5 14 10  4 13 19 15 18  9 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df6_sp$Teams, df7_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Atl. Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.0000000 0.6363636 1.0000000 0.1538462 0.1818182
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##            Var1        Var2  Distance
## 1     Barcelona Atl. Madrid 0.0000000
## 2   Real Madrid Atl. Madrid 0.6363636
## 3   Atl. Madrid Atl. Madrid 1.0000000
## 4 Real Sociedad Atl. Madrid 0.1538462
## 5      Valencia Atl. Madrid 0.1818182
## 6        Malaga Atl. Madrid 0.1818182
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1        Var2  Distance
## 2  Real Madrid Atl. Madrid 0.6363636
## 3  Atl. Madrid Atl. Madrid 1.0000000
## 21   Barcelona   Barcelona 1.0000000
## 42 Real Madrid Real Madrid 1.0000000
## 43 Atl. Madrid Real Madrid 0.6363636
## 72  Ath Bilbao  Ath Bilbao 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##              Var1           Var2  Distance
## 2     Atl. Madrid    Atl. Madrid 1.0000000
## 3       Barcelona      Barcelona 1.0000000
## 4     Real Madrid    Real Madrid 1.0000000
## 6      Ath Bilbao     Ath Bilbao 1.0000000
## 7         Sevilla        Sevilla 1.0000000
## 8   Real Sociedad  Real Sociedad 1.0000000
## 9        Valencia       Valencia 1.0000000
## 10     Celta Vigo     Celta Vigo 1.0000000
## 11        Levante        Levante 1.0000000
## 12         Malaga         Malaga 1.0000000
## 15 Rayo Vallecano Rayo Vallecano 1.0000000
## 16       Espanyol       Espanyol 1.0000000
## 17         Getafe         Getafe 1.0000000
## 18     Granada Cf     Granada Cf 1.0000000
## 19        Osasuna        Osasuna 1.0000000
## 20     Valladolid     Valladolid 1.0000000
## 21          Betis          Betis 1.0000000
## 1     Real Madrid    Atl. Madrid 0.6363636
## 5     Atl. Madrid    Real Madrid 0.6363636
## 13       Mallorca         Malaga 0.5000000
## 14       Zaragoza         Malaga 0.5000000
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion 
match(df6_sp$Teams, df7_sp$Teams)
</code></pre>

<pre><code>##  [1]  2  3  1  7  8 11 20 12  5 14 10  4 13 19 15 18  9 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2012-2013 in Primera Division: https://en.wikipedia.org/wiki/2012-13_La_Liga##

#####Manipulating the upper case issue in imported data (data_SPL15)#####

#library(dplyr)

head(data_SPL15)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BARCELONA    38  30     4     4   110    21   16     1     2
## 3  2 REAL MADRID    38  30     2     6   118    38   16     2     1
## 4  3 ATL. MADRID    38  23     9     6    67    29   14     3     2
## 5  4    VALENCIA    38  22    11     5    70    32   15     3     1
## 6  5     SEVILLA    38  23     7     8    71    45   13     5     1
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      64    11   14     3     2      46    10  94
## 3      65    15   14     0     5      53    23  92
## 4      42    11    9     6     4      25    18  78
## 5      42    10    7     8     4      28    22  77
## 6      38    13   10     2     7      33    32  76
</code></pre>

<pre><code class="r">data_SPL15 &lt;- data_SPL15[-1 , ]

####Converting teams names to lower case
data_SPL15$Team2 &lt;-  tolower(data_SPL15$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL15$Team3 &lt;- sapply(data_SPL15$Team2, simpleCap)

data_SPL15$Team4 &lt;- as.factor(data_SPL15$Team3)

data_SPL15$Team5 &lt;-as.character(data_SPL15$Team4)
rownames(data_SPL15) &lt;- 1:nrow(data_SPL15)
head(data_SPL15)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  30     4     4   110    21   16     1     2      64
## 2 2 REAL MADRID    38  30     2     6   118    38   16     2     1      65
## 3 3 ATL. MADRID    38  23     9     6    67    29   14     3     2      42
## 4 4    VALENCIA    38  22    11     5    70    32   15     3     1      42
## 5 5     SEVILLA    38  23     7     8    71    45   13     5     1      38
## 6 6  VILLARREAL    38  16    12    10    48    37   12     1     6      29
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    11   14     3     2      46    10  94   barcelona   Barcelona
## 2    15   14     0     5      53    23  92 real madrid Real Madrid
## 3    11    9     6     4      25    18  78 atl. madrid Atl. Madrid
## 4    10    7     8     4      28    22  77    valencia    Valencia
## 5    13   10     2     7      33    32  76     sevilla     Sevilla
## 6    17    4    11     4      19    20  60  villarreal  Villarreal
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3 Atl. Madrid Atl. Madrid
## 4    Valencia    Valencia
## 5     Sevilla     Sevilla
## 6  Villarreal  Villarreal
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL15)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  30     4     4   110    21   16     1     2      64
## 2 2 REAL MADRID    38  30     2     6   118    38   16     2     1      65
## 3 3 ATL. MADRID    38  23     9     6    67    29   14     3     2      42
## 4 4    VALENCIA    38  22    11     5    70    32   15     3     1      42
## 5 5     SEVILLA    38  23     7     8    71    45   13     5     1      38
## 6 6  VILLARREAL    38  16    12    10    48    37   12     1     6      29
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    11   14     3     2      46    10  94   barcelona   Barcelona
## 2    15   14     0     5      53    23  92 real madrid Real Madrid
## 3    11    9     6     4      25    18  78 atl. madrid Atl. Madrid
## 4    10    7     8     4      28    22  77    valencia    Valencia
## 5    13   10     2     7      33    32  76     sevilla     Sevilla
## 6    17    4    11     4      19    20  60  villarreal  Villarreal
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3 Atl. Madrid Atl. Madrid
## 4    Valencia    Valencia
## 5     Sevilla     Sevilla
## 6  Villarreal  Villarreal
</code></pre>

<pre><code class="r">names(data_SPL15)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df8_sp &lt;- data_SPL15[c(1, 23, 3:8, 19)]

str(df8_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Atl. Madrid&quot; &quot;Valencia&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 10 8 7 8 6 5 3 4 3 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 6 10 2 8 3 1 3 9 1 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;13&quot;,&quot;14&quot;,..: 11 13 13 12 14 1 2 2 5 4 ...
##  $ Goals: Factor w/ 16 levels &quot;110&quot;,&quot;118&quot;,&quot;22&quot;,..: 1 2 13 14 15 12 8 11 8 11 ...
##  $ NA..3: Factor w/ 17 levels &quot;21&quot;,&quot;29&quot;,&quot;32&quot;,..: 1 5 2 3 8 4 6 7 9 10 ...
##  $ Pts  : num  94 92 78 77 76 60 55 51 50 49 ...
</code></pre>

<pre><code class="r">head(df8_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Barcelona    38  30     4     4   110    21  94
## 2 2 Real Madrid    38  30     2     6   118    38  92
## 3 3 Atl. Madrid    38  23     9     6    67    29  78
## 4 4    Valencia    38  22    11     5    70    32  77
## 5 5     Sevilla    38  23     7     8    71    45  76
## 6 6  Villarreal    38  16    12    10    48    37  60
</code></pre>

<pre><code class="r">#####Changing the names#####

df8_sp$Aggregate &lt;- paste(df8_sp$Goals, df8_sp$NA..3, sep = &quot;-&quot;)
head(df8_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Barcelona    38  30     4     4   110    21  94    110-21
## 2 2 Real Madrid    38  30     2     6   118    38  92    118-38
## 3 3 Atl. Madrid    38  23     9     6    67    29  78     67-29
## 4 4    Valencia    38  22    11     5    70    32  77     70-32
## 5 5     Sevilla    38  23     7     8    71    45  76     71-45
## 6 6  Villarreal    38  16    12    10    48    37  60     48-37
</code></pre>

<pre><code class="r">df8_sp &lt;- df8_sp[ ,c(1:6, 10, 9)]
head(df8_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Barcelona    38  30     4     4    110-21  94
## 2 2 Real Madrid    38  30     2     6    118-38  92
## 3 3 Atl. Madrid    38  23     9     6     67-29  78
## 4 4    Valencia    38  22    11     5     70-32  77
## 5 5     Sevilla    38  23     7     8     71-45  76
## 6 6  Villarreal    38  16    12    10     48-37  60
</code></pre>

<pre><code class="r">names(df8_sp) &lt;- names(data_9)
head(df8_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1   Barcelona    38   30     4    4    110-21     94
## 2     2 Real Madrid    38   30     2    6    118-38     92
## 3     3 Atl. Madrid    38   23     9    6     67-29     78
## 4     4    Valencia    38   22    11    5     70-32     77
## 5     5     Sevilla    38   23     7    8     71-45     76
## 6     6  Villarreal    38   16    12   10     48-37     60
</code></pre>

<pre><code class="r">str(df8_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Atl. Madrid&quot; &quot;Valencia&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 10 8 7 8 6 5 3 4 3 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 6 10 2 8 3 1 3 9 1 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;13&quot;,&quot;14&quot;,..: 11 13 13 12 14 1 2 2 5 4 ...
##  $ Aggregate: chr  &quot;110-21&quot; &quot;118-38&quot; &quot;67-29&quot; &quot;70-32&quot; ...
##  $ Points   : num  94 92 78 77 76 60 55 51 50 49 ...
</code></pre>

<pre><code class="r">df8_sp[ ,c(3:6)] &lt;- apply(df8_sp[ ,c(3:6)], 2, as.numeric)

match(df7_sp$Teams, df8_sp$Teams)
</code></pre>

<pre><code>##  [1]  3  1  2  7  5  6 12  4  8 15  9 11 10 14 18 13 19 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df7_sp$Teams, df8_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Atl. Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.00000000 1.00000000 0.09090909 0.10000000 0.22222222
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1      Var2   Distance
## 1 Atl. Madrid Barcelona 0.00000000
## 2   Barcelona Barcelona 1.00000000
## 3 Real Madrid Barcelona 0.09090909
## 4  Ath Bilbao Barcelona 0.10000000
## 5     Sevilla Barcelona 0.22222222
## 6  Villarreal Barcelona 0.10000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 19
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)

###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1        Var2  Distance
## 2    Barcelona   Barcelona 1.0000000
## 21 Atl. Madrid Real Madrid 0.6363636
## 23 Real Madrid Real Madrid 1.0000000
## 41 Atl. Madrid Atl. Madrid 1.0000000
## 43 Real Madrid Atl. Madrid 0.6363636
## 68    Valencia    Valencia 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##              Var1           Var2  Distance
## 1       Barcelona      Barcelona 1.0000000
## 3     Real Madrid    Real Madrid 1.0000000
## 4     Atl. Madrid    Atl. Madrid 1.0000000
## 6        Valencia       Valencia 1.0000000
## 7         Sevilla        Sevilla 1.0000000
## 8      Villarreal     Villarreal 1.0000000
## 9      Ath Bilbao     Ath Bilbao 1.0000000
## 10     Celta Vigo     Celta Vigo 1.0000000
## 11         Malaga         Malaga 1.0000000
## 12       Espanyol       Espanyol 1.0000000
## 13 Rayo Vallecano Rayo Vallecano 1.0000000
## 14  Real Sociedad  Real Sociedad 1.0000000
## 15          Elche          Elche 1.0000000
## 16         Getafe         Getafe 1.0000000
## 17        Levante        Levante 1.0000000
## 18     Granada Cf     Granada Cf 1.0000000
## 19        Almeria        Almeria 1.0000000
## 2     Atl. Madrid    Real Madrid 0.6363636
## 5     Real Madrid    Atl. Madrid 0.6363636
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion 
match(df7_sp$Teams, df8_sp$Teams)
</code></pre>

<pre><code>##  [1]  3  1  2  7  5  6 12  4  8 15  9 11 10 14 18 13 19 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2013-2014 in Primera Division: https://en.wikipedia.org/wiki/2012-13_La_Liga##

#####Manipulating the upper case issue in imported data (data_SPL16)#####

#library(dplyr)

head(data_SPL16)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   BARCELONA    38  29     4     5   112    29   16     1     2
## 3  2 REAL MADRID    38  28     6     4   110    34   16     1     2
## 4  3 ATL. MADRID    38  28     4     6    63    18   15     3     1
## 5  4  VILLARREAL    38  18    10    10    44    35   12     4     3
## 6  5  ATH BILBAO    38  18     8    12    58    45   11     4     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      67    14   13     3     3      45    15  91
## 3      70    16   12     5     2      40    18  90
## 4      33     7   13     1     5      30    11  88
## 5      26    12    6     6     7      18    23  64
## 6      35    17    7     4     8      23    28  62
</code></pre>

<pre><code class="r">data_SPL16 &lt;- data_SPL16[-1 , ]

####Converting teams names to lower case
data_SPL16$Team2 &lt;-  tolower(data_SPL16$Team)

####Converting the starting letter of the teams names to upper case 
data_SPL16$Team3 &lt;- sapply(data_SPL16$Team2, simpleCap)

data_SPL16$Team4 &lt;- as.factor(data_SPL16$Team3)

data_SPL16$Team5 &lt;-as.character(data_SPL16$Team4)
rownames(data_SPL16) &lt;- 1:nrow(data_SPL16)
head(data_SPL16)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  29     4     5   112    29   16     1     2      67
## 2 2 REAL MADRID    38  28     6     4   110    34   16     1     2      70
## 3 3 ATL. MADRID    38  28     4     6    63    18   15     3     1      33
## 4 4  VILLARREAL    38  18    10    10    44    35   12     4     3      26
## 5 5  ATH BILBAO    38  18     8    12    58    45   11     4     4      35
## 6 6  CELTA VIGO    38  17     9    12    51    59    9     6     4      29
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    14   13     3     3      45    15  91   barcelona   Barcelona
## 2    16   12     5     2      40    18  90 real madrid Real Madrid
## 3     7   13     1     5      30    11  88 atl. madrid Atl. Madrid
## 4    12    6     6     7      18    23  64  villarreal  Villarreal
## 5    17    7     4     8      23    28  62  ath bilbao  Ath Bilbao
## 6    25    8     3     8      22    34  60  celta vigo  Celta Vigo
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3 Atl. Madrid Atl. Madrid
## 4  Villarreal  Villarreal
## 5  Ath Bilbao  Ath Bilbao
## 6  Celta Vigo  Celta Vigo
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_SPL16)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   BARCELONA    38  29     4     5   112    29   16     1     2      67
## 2 2 REAL MADRID    38  28     6     4   110    34   16     1     2      70
## 3 3 ATL. MADRID    38  28     4     6    63    18   15     3     1      33
## 4 4  VILLARREAL    38  18    10    10    44    35   12     4     3      26
## 5 5  ATH BILBAO    38  18     8    12    58    45   11     4     4      35
## 6 6  CELTA VIGO    38  17     9    12    51    59    9     6     4      29
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    14   13     3     3      45    15  91   barcelona   Barcelona
## 2    16   12     5     2      40    18  90 real madrid Real Madrid
## 3     7   13     1     5      30    11  88 atl. madrid Atl. Madrid
## 4    12    6     6     7      18    23  64  villarreal  Villarreal
## 5    17    7     4     8      23    28  62  ath bilbao  Ath Bilbao
## 6    25    8     3     8      22    34  60  celta vigo  Celta Vigo
##         Team4       Team5
## 1   Barcelona   Barcelona
## 2 Real Madrid Real Madrid
## 3 Atl. Madrid Atl. Madrid
## 4  Villarreal  Villarreal
## 5  Ath Bilbao  Ath Bilbao
## 6  Celta Vigo  Celta Vigo
</code></pre>

<pre><code class="r">names(data_SPL16)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df9_sp &lt;- data_SPL16[c(1, 23, 3:8, 19)]

str(df9_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Atl. Madrid&quot; &quot;Villarreal&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 8 7 7 6 5 3 4 2 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 6 5 1 8 9 1 3 9 3 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;12&quot;,&quot;14&quot;,..: 12 11 13 1 2 2 3 3 5 4 ...
##  $ Goals: Factor w/ 15 levels &quot;110&quot;,&quot;112&quot;,&quot;34&quot;,..: 2 1 14 7 13 11 11 5 8 3 ...
##  $ NA..3: Factor w/ 18 levels &quot;18&quot;,&quot;29&quot;,&quot;34&quot;,..: 2 3 1 4 5 10 7 4 6 8 ...
##  $ Pts  : num  91 90 88 64 62 60 52 48 48 45 ...
</code></pre>

<pre><code class="r">head(df9_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Barcelona    38  29     4     5   112    29  91
## 2 2 Real Madrid    38  28     6     4   110    34  90
## 3 3 Atl. Madrid    38  28     4     6    63    18  88
## 4 4  Villarreal    38  18    10    10    44    35  64
## 5 5  Ath Bilbao    38  18     8    12    58    45  62
## 6 6  Celta Vigo    38  17     9    12    51    59  60
</code></pre>

<pre><code class="r">#####Changing the names#####

df9_sp$Aggregate &lt;- paste(df9_sp$Goals, df9_sp$NA..3, sep = &quot;-&quot;)
head(df9_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Barcelona    38  29     4     5   112    29  91    112-29
## 2 2 Real Madrid    38  28     6     4   110    34  90    110-34
## 3 3 Atl. Madrid    38  28     4     6    63    18  88     63-18
## 4 4  Villarreal    38  18    10    10    44    35  64     44-35
## 5 5  Ath Bilbao    38  18     8    12    58    45  62     58-45
## 6 6  Celta Vigo    38  17     9    12    51    59  60     51-59
</code></pre>

<pre><code class="r">df9_sp &lt;- df9_sp[ ,c(1:6, 10, 9)]
head(df9_sp)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Barcelona    38  29     4     5    112-29  91
## 2 2 Real Madrid    38  28     6     4    110-34  90
## 3 3 Atl. Madrid    38  28     4     6     63-18  88
## 4 4  Villarreal    38  18    10    10     44-35  64
## 5 5  Ath Bilbao    38  18     8    12     58-45  62
## 6 6  Celta Vigo    38  17     9    12     51-59  60
</code></pre>

<pre><code class="r">names(df9_sp) &lt;- names(data_9)
head(df9_sp)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1   Barcelona    38   29     4    5    112-29     91
## 2     2 Real Madrid    38   28     6    4    110-34     90
## 3     3 Atl. Madrid    38   28     4    6     63-18     88
## 4     4  Villarreal    38   18    10   10     44-35     64
## 5     5  Ath Bilbao    38   18     8   12     58-45     62
## 6     6  Celta Vigo    38   17     9   12     51-59     60
</code></pre>

<pre><code class="r">str(df9_sp)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Barcelona&quot; &quot;Real Madrid&quot; &quot;Atl. Madrid&quot; &quot;Villarreal&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 8 7 7 6 5 3 4 2 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 6 5 1 8 9 1 3 9 3 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;12&quot;,&quot;14&quot;,..: 12 11 13 1 2 2 3 3 5 4 ...
##  $ Aggregate: chr  &quot;112-29&quot; &quot;110-34&quot; &quot;63-18&quot; &quot;44-35&quot; ...
##  $ Points   : num  91 90 88 64 62 60 52 48 48 45 ...
</code></pre>

<pre><code class="r">df9_sp[ ,c(3:6)] &lt;- apply(df9_sp[ ,c(3:6)], 2, as.numeric)

match(df8_sp$Teams, df9_sp$Teams)
</code></pre>

<pre><code>##  [1]  1  2  3 11  7  4  5  6  8 14 18  9 NA 19 20 13 15 17 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df8_sp$Teams, df9_sp$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Barcelona&quot;,&quot;Real Madrid&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.00000000 0.09090909 0.00000000 0.33333333 0.22222222
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1      Var2   Distance
## 1   Barcelona Barcelona 1.00000000
## 2 Real Madrid Barcelona 0.09090909
## 3 Atl. Madrid Barcelona 0.00000000
## 4    Valencia Barcelona 0.33333333
## 5     Sevilla Barcelona 0.22222222
## 6  Villarreal Barcelona 0.10000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 19
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1        Var2  Distance
## 1    Barcelona   Barcelona 1.0000000
## 22 Real Madrid Real Madrid 1.0000000
## 23 Atl. Madrid Real Madrid 0.6363636
## 42 Real Madrid Atl. Madrid 0.6363636
## 43 Atl. Madrid Atl. Madrid 1.0000000
## 66  Villarreal  Villarreal 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##              Var1           Var2  Distance
## 1       Barcelona      Barcelona 1.0000000
## 2     Real Madrid    Real Madrid 1.0000000
## 5     Atl. Madrid    Atl. Madrid 1.0000000
## 6      Villarreal     Villarreal 1.0000000
## 7      Ath Bilbao     Ath Bilbao 1.0000000
## 8      Celta Vigo     Celta Vigo 1.0000000
## 9         Sevilla        Sevilla 1.0000000
## 10         Malaga         Malaga 1.0000000
## 11  Real Sociedad  Real Sociedad 1.0000000
## 12       Valencia       Valencia 1.0000000
## 13          Eibar          Eibar 1.0000000
## 14       Espanyol       Espanyol 1.0000000
## 15 Dep. La Coruna Dep. La Coruna 1.0000000
## 16     Granada Cf     Granada Cf 1.0000000
## 17 Rayo Vallecano Rayo Vallecano 1.0000000
## 18         Getafe         Getafe 1.0000000
## 19        Levante        Levante 1.0000000
## 3     Atl. Madrid    Real Madrid 0.6363636
## 4     Real Madrid    Atl. Madrid 0.6363636
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion 
match(df8_sp$Teams, df9_sp$Teams)
</code></pre>

<pre><code>##  [1]  1  2  3 11  7  4  5  6  8 14 18  9 NA 19 20 13 15 17 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2013-2014 in Primera Division: https://en.wikipedia.org/wiki/2012-13_La_Liga##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_FRL09)#####
####FRL09 = French League season 2008-2009####

library(dplyr)

head(data_FRL09)
</code></pre>

<pre><code>##    N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA      &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1  BORDEAUX    38  24     8     6    64    34   14     5     0      36
## 3  2 MARSEILLE    38  22    11     5    67    35   10     5     4      35
## 4  3      LYON    38  20    11     7    52    29   10     8     1      32
## 5  4  TOULOUSE    38  16    16     6    45    27   10     8     1      26
## 6  5     LILLE    38  17    13     8    51    39   12     5     2      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    12   10     3     6      28    22  80
## 3    22   12     6     1      32    13  77
## 4    15   10     3     6      20    14  71
## 5     8    6     8     5      19    19  64
## 6    20    5     8     6      17    19  64
</code></pre>

<pre><code class="r">data_FRL09 &lt;- data_FRL09[-1 , ]

####Converting teams names to lower case
data_FRL09$Team2 &lt;-  tolower(data_FRL09$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL09$Team3 &lt;- sapply(data_FRL09$Team2, simpleCap)

data_FRL09$Team4 &lt;- as.factor(data_FRL09$Team3)

data_FRL09$Team5 &lt;-as.character(data_FRL09$Team4)
rownames(data_FRL09) &lt;- 1:nrow(data_FRL09)
head(data_FRL09)
</code></pre>

<pre><code>##   N                Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1            BORDEAUX    38  24     8     6    64    34   14     5     0
## 2 2           MARSEILLE    38  22    11     5    67    35   10     5     4
## 3 3                LYON    38  20    11     7    52    29   10     8     1
## 4 4            TOULOUSE    38  16    16     6    45    27   10     8     1
## 5 5               LILLE    38  17    13     8    51    39   12     5     2
## 6 6 PARIS SAINT GERMAIN    38  19     7    12    49    38   12     2     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts               Team2
## 1      36    12   10     3     6      28    22  80            bordeaux
## 2      35    22   12     6     1      32    13  77           marseille
## 3      32    15   10     3     6      20    14  71                lyon
## 4      26     8    6     8     5      19    19  64            toulouse
## 5      34    20    5     8     6      17    19  64               lille
## 6      29    17    7     5     7      20    21  64 paris saint germain
##                 Team3               Team4               Team5
## 1            Bordeaux            Bordeaux            Bordeaux
## 2           Marseille           Marseille           Marseille
## 3                Lyon                Lyon                Lyon
## 4            Toulouse            Toulouse            Toulouse
## 5               Lille               Lille               Lille
## 6 Paris Saint Germain Paris Saint Germain Paris Saint Germain
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL09)
</code></pre>

<pre><code>##   N                Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1            BORDEAUX    38  24     8     6    64    34   14     5     0
## 2 2           MARSEILLE    38  22    11     5    67    35   10     5     4
## 3 3                LYON    38  20    11     7    52    29   10     8     1
## 4 4            TOULOUSE    38  16    16     6    45    27   10     8     1
## 5 5               LILLE    38  17    13     8    51    39   12     5     2
## 6 6 PARIS SAINT GERMAIN    38  19     7    12    49    38   12     2     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts               Team2
## 1      36    12   10     3     6      28    22  80            bordeaux
## 2      35    22   12     6     1      32    13  77           marseille
## 3      32    15   10     3     6      20    14  71                lyon
## 4      26     8    6     8     5      19    19  64            toulouse
## 5      34    20    5     8     6      17    19  64               lille
## 6      29    17    7     5     7      20    21  64 paris saint germain
##                 Team3               Team4               Team5
## 1            Bordeaux            Bordeaux            Bordeaux
## 2           Marseille           Marseille           Marseille
## 3                Lyon                Lyon                Lyon
## 4            Toulouse            Toulouse            Toulouse
## 5               Lille               Lille               Lille
## 6 Paris Saint Germain Paris Saint Germain Paris Saint Germain
</code></pre>

<pre><code class="r">names(data_FRL09)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df_fr &lt;- data_FRL09[c(1, 23, 3:8, 19)]

str(df_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Bordeaux&quot; &quot;Marseille&quot; &quot;Lyon&quot; &quot;Toulouse&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 9 8 5 6 7 4 5 3 1 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 2 2 7 4 9 7 9 2 6 ...
##  $ NA..2: Factor w/ 15 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 12 11 13 12 14 1 13 4 3 2 ...
##  $ Goals: Factor w/ 17 levels &quot;24&quot;,&quot;30&quot;,&quot;33&quot;,..: 15 16 14 10 13 12 8 4 6 11 ...
##  $ NA..3: Factor w/ 17 levels &quot;27&quot;,&quot;29&quot;,&quot;34&quot;,..: 3 4 2 1 7 6 3 4 8 11 ...
##  $ Pts  : num  80 77 71 64 64 64 61 55 50 45 ...
</code></pre>

<pre><code class="r">head(df_fr)
</code></pre>

<pre><code>##   N               Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1            Bordeaux    38  24     8     6    64    34  80
## 2 2           Marseille    38  22    11     5    67    35  77
## 3 3                Lyon    38  20    11     7    52    29  71
## 4 4            Toulouse    38  16    16     6    45    27  64
## 5 5               Lille    38  17    13     8    51    39  64
## 6 6 Paris Saint Germain    38  19     7    12    49    38  64
</code></pre>

<pre><code class="r">#####Changing the names#####

df_fr$Aggregate &lt;- paste(df_fr$Goals, df_fr$NA..3, sep = &quot;-&quot;)
head(df_fr)
</code></pre>

<pre><code>##   N               Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1            Bordeaux    38  24     8     6    64    34  80     64-34
## 2 2           Marseille    38  22    11     5    67    35  77     67-35
## 3 3                Lyon    38  20    11     7    52    29  71     52-29
## 4 4            Toulouse    38  16    16     6    45    27  64     45-27
## 5 5               Lille    38  17    13     8    51    39  64     51-39
## 6 6 Paris Saint Germain    38  19     7    12    49    38  64     49-38
</code></pre>

<pre><code class="r">df_fr &lt;- df_fr[ ,c(1:6, 10, 9)]
head(df_fr)
</code></pre>

<pre><code>##   N               Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1            Bordeaux    38  24     8     6     64-34  80
## 2 2           Marseille    38  22    11     5     67-35  77
## 3 3                Lyon    38  20    11     7     52-29  71
## 4 4            Toulouse    38  16    16     6     45-27  64
## 5 5               Lille    38  17    13     8     51-39  64
## 6 6 Paris Saint Germain    38  19     7    12     49-38  64
</code></pre>

<pre><code class="r">names(df_fr) &lt;- names(data_9)
head(df_fr)
</code></pre>

<pre><code>##   Index               Teams Games Wins Draws Loss Aggregate Points
## 1     1            Bordeaux    38   24     8    6     64-34     80
## 2     2           Marseille    38   22    11    5     67-35     77
## 3     3                Lyon    38   20    11    7     52-29     71
## 4     4            Toulouse    38   16    16    6     45-27     64
## 5     5               Lille    38   17    13    8     51-39     64
## 6     6 Paris Saint Germain    38   19     7   12     49-38     64
</code></pre>

<pre><code class="r">str(df_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Bordeaux&quot; &quot;Marseille&quot; &quot;Lyon&quot; &quot;Toulouse&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 9 8 5 6 7 4 5 3 1 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 2 2 7 4 9 7 9 2 6 ...
##  $ Loss     : Factor w/ 15 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 12 11 13 12 14 1 13 4 3 2 ...
##  $ Aggregate: chr  &quot;64-34&quot; &quot;67-35&quot; &quot;52-29&quot; &quot;45-27&quot; ...
##  $ Points   : num  80 77 71 64 64 64 61 55 50 45 ...
</code></pre>

<pre><code class="r">df_fr[ ,c(3:6)] &lt;- apply(df_fr[ ,c(3:6)], 2, as.numeric)


#####Manipulating the upper case issue in imported data (data_FRL10)#####

#library(dplyr)

head(data_FRL10)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1   MARSEILLE    38  23     9     6    69    36   14     3     2
## 3  2        LYON    38  20    12     6    64    38   12     4     3
## 4  3     AUXERRE    38  20    11     7    42    29   11     5     3
## 5  4       LILLE    38  21     7    10    72    40   14     3     2
## 6  5 MONTPELLIER    38  20     9     9    50    40   12     4     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      37    14    9     6     4      32    22  78
## 3      32    17    8     8     3      32    21  72
## 4      24    14    9     6     4      18    15  71
## 5      44    15    7     4     8      28    25  70
## 6      24    12    8     5     6      26    28  69
</code></pre>

<pre><code class="r">data_FRL10 &lt;- data_FRL10[-1 , ]

####Converting teams names to lower case
data_FRL10$Team2 &lt;-  tolower(data_FRL10$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL10$Team3 &lt;- sapply(data_FRL10$Team2, simpleCap)

data_FRL10$Team4 &lt;- as.factor(data_FRL10$Team3)

data_FRL10$Team5 &lt;-as.character(data_FRL10$Team4)
rownames(data_FRL10) &lt;- 1:nrow(data_FRL10)
head(data_FRL10)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   MARSEILLE    38  23     9     6    69    36   14     3     2      37
## 2 2        LYON    38  20    12     6    64    38   12     4     3      32
## 3 3     AUXERRE    38  20    11     7    42    29   11     5     3      24
## 4 4       LILLE    38  21     7    10    72    40   14     3     2      44
## 5 5 MONTPELLIER    38  20     9     9    50    40   12     4     3      24
## 6 6    BORDEAUX    38  19     7    12    58    40   12     4     3      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    14    9     6     4      32    22  78   marseille   Marseille
## 2    17    8     8     3      32    21  72        lyon        Lyon
## 3    14    9     6     4      18    15  71     auxerre     Auxerre
## 4    15    7     4     8      28    25  70       lille       Lille
## 5    12    8     5     6      26    28  69 montpellier Montpellier
## 6    13    7     3     9      24    27  64    bordeaux    Bordeaux
##         Team4       Team5
## 1   Marseille   Marseille
## 2        Lyon        Lyon
## 3     Auxerre     Auxerre
## 4       Lille       Lille
## 5 Montpellier Montpellier
## 6    Bordeaux    Bordeaux
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL10)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1   MARSEILLE    38  23     9     6    69    36   14     3     2      37
## 2 2        LYON    38  20    12     6    64    38   12     4     3      32
## 3 3     AUXERRE    38  20    11     7    42    29   11     5     3      24
## 4 4       LILLE    38  21     7    10    72    40   14     3     2      44
## 5 5 MONTPELLIER    38  20     9     9    50    40   12     4     3      24
## 6 6    BORDEAUX    38  19     7    12    58    40   12     4     3      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    14    9     6     4      32    22  78   marseille   Marseille
## 2    17    8     8     3      32    21  72        lyon        Lyon
## 3    14    9     6     4      18    15  71     auxerre     Auxerre
## 4    15    7     4     8      28    25  70       lille       Lille
## 5    12    8     5     6      26    28  69 montpellier Montpellier
## 6    13    7     3     9      24    27  64    bordeaux    Bordeaux
##         Team4       Team5
## 1   Marseille   Marseille
## 2        Lyon        Lyon
## 3     Auxerre     Auxerre
## 4       Lille       Lille
## 5 Montpellier Montpellier
## 6    Bordeaux    Bordeaux
</code></pre>

<pre><code class="r">names(data_FRL10)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df3_fr &lt;- data_FRL10[c(1, 23, 3:8, 19)]

str(df3_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Marseille&quot; &quot;Lyon&quot; &quot;Auxerre&quot; &quot;Lille&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 9 9 10 9 8 7 6 5 5 ...
##  $ NA..1: Factor w/ 7 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 6 3 2 4 6 4 1 1 2 1 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 12 12 13 1 14 2 2 3 3 4 ...
##  $ Goals: Factor w/ 17 levels &quot;27&quot;,&quot;28&quot;,&quot;31&quot;,..: 15 14 8 16 10 13 12 5 11 10 ...
##  $ NA..3: Factor w/ 17 levels &quot;29&quot;,&quot;36&quot;,&quot;38&quot;,..: 2 3 1 4 4 4 6 8 5 10 ...
##  $ Pts  : num  78 72 71 70 69 64 58 55 53 52 ...
</code></pre>

<pre><code class="r">head(df3_fr)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1   Marseille    38  23     9     6    69    36  78
## 2 2        Lyon    38  20    12     6    64    38  72
## 3 3     Auxerre    38  20    11     7    42    29  71
## 4 4       Lille    38  21     7    10    72    40  70
## 5 5 Montpellier    38  20     9     9    50    40  69
## 6 6    Bordeaux    38  19     7    12    58    40  64
</code></pre>

<pre><code class="r">#####Changing the names#####

df3_fr$Aggregate &lt;- paste(df3_fr$Goals, df3_fr$NA..3, sep = &quot;-&quot;)
head(df3_fr)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1   Marseille    38  23     9     6    69    36  78     69-36
## 2 2        Lyon    38  20    12     6    64    38  72     64-38
## 3 3     Auxerre    38  20    11     7    42    29  71     42-29
## 4 4       Lille    38  21     7    10    72    40  70     72-40
## 5 5 Montpellier    38  20     9     9    50    40  69     50-40
## 6 6    Bordeaux    38  19     7    12    58    40  64     58-40
</code></pre>

<pre><code class="r">df3_fr &lt;- df3_fr[ ,c(1:6, 10, 9)]
head(df3_fr)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1   Marseille    38  23     9     6     69-36  78
## 2 2        Lyon    38  20    12     6     64-38  72
## 3 3     Auxerre    38  20    11     7     42-29  71
## 4 4       Lille    38  21     7    10     72-40  70
## 5 5 Montpellier    38  20     9     9     50-40  69
## 6 6    Bordeaux    38  19     7    12     58-40  64
</code></pre>

<pre><code class="r">names(df3_fr) &lt;- names(data_9)
head(df3_fr)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1   Marseille    38   23     9    6     69-36     78
## 2     2        Lyon    38   20    12    6     64-38     72
## 3     3     Auxerre    38   20    11    7     42-29     71
## 4     4       Lille    38   21     7   10     72-40     70
## 5     5 Montpellier    38   20     9    9     50-40     69
## 6     6    Bordeaux    38   19     7   12     58-40     64
</code></pre>

<pre><code class="r">str(df3_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Marseille&quot; &quot;Lyon&quot; &quot;Auxerre&quot; &quot;Lille&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 9 9 10 9 8 7 6 5 5 ...
##  $ Draws    : Factor w/ 7 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 6 3 2 4 6 4 1 1 2 1 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 12 12 13 1 14 2 2 3 3 4 ...
##  $ Aggregate: chr  &quot;69-36&quot; &quot;64-38&quot; &quot;42-29&quot; &quot;72-40&quot; ...
##  $ Points   : num  78 72 71 70 69 64 58 55 53 52 ...
</code></pre>

<pre><code class="r">df3_fr[ ,c(3:6)] &lt;- apply(df3_fr[ ,c(3:6)], 2, as.numeric)

match(df_fr$Teams, df3_fr$Teams)
</code></pre>

<pre><code>##  [1]  6  1  2 14  4 13  9  3 15  7  8 10 20 16 12 18 17 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df_fr$Teams, df3_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Bordeaux&quot;,&quot;Marseille&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Marseille&quot;,&quot;Lyon&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.2222222 1.0000000 0.0000000 0.1111111 0.4444444
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                  Var1      Var2  Distance
## 1            Bordeaux Marseille 0.2222222
## 2           Marseille Marseille 1.0000000
## 3                Lyon Marseille 0.0000000
## 4            Toulouse Marseille 0.1111111
## 5               Lille Marseille 0.4444444
## 6 Paris Saint Germain Marseille 0.2631579
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 25
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##          Var1      Var2 Distance
## 2   Marseille Marseille      1.0
## 23       Lyon      Lyon      1.0
## 48    Auxerre   Auxerre      1.0
## 65      Lille     Lille      1.0
## 101  Bordeaux  Bordeaux      1.0
## 114   Sochaux  Bordeaux      0.5
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1                Var2  Distance
## 1            Marseille           Marseille 1.0000000
## 2                 Lyon                Lyon 1.0000000
## 3              Auxerre             Auxerre 1.0000000
## 4                Lille               Lille 1.0000000
## 5             Bordeaux            Bordeaux 1.0000000
## 7              Lorient             Lorient 1.0000000
## 8               Monaco              Monaco 1.0000000
## 9               Rennes              Rennes 1.0000000
## 11        Valenciennes        Valenciennes 1.0000000
## 14               Nancy               Nancy 1.0000000
## 16 Paris Saint Germain Paris Saint Germain 1.0000000
## 17            Toulouse            Toulouse 1.0000000
## 18                Nice                Nice 1.0000000
## 20             Sochaux             Sochaux 1.0000000
## 21          St Etienne          St Etienne 1.0000000
## 22             Le Mans             Le Mans 1.0000000
## 25            Grenoble            Grenoble 1.0000000
## 24            Toulouse            Boulogne 0.6250000
## 13             Le Mans                Lens 0.5714286
## 6              Sochaux            Bordeaux 0.5000000
## 10              Nantes              Rennes 0.5000000
## 12              Rennes                Lens 0.5000000
## 15              Nantes               Nancy 0.5000000
## 19            Bordeaux             Sochaux 0.5000000
## 23            Le Havre             Le Mans 0.5000000
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
#match(df2_it$Teams, df3_fr$Teams)

###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2008-2009 in France Ligue: https://en.wikipedia.org/wiki/2008-09_Ligue_1##
###To be true, each season in France Ligue are relegated three teams (thesis, Table 3: Values of N, K, and I in European football leagues from 2008 - 2016 (8 seasons))

#####Manipulating the upper case issue in imported data (data_FRL11)#####

#library(dplyr)

head(data_FRL11)
</code></pre>

<pre><code>##    N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA      &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1     LILLE    38  21    13     4    68    36   13     5     1      40
## 3  2 MARSEILLE    38  18    14     6    62    39   10     7     2      34
## 4  3      LYON    38  17    13     8    61    40   11     7     1      35
## 5  4     P S G    38  15    15     8    56    41    9     8     2      33
## 6  5   SOCHAUX    38  17     7    14    60    43   12     4     3      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    17    8     8     3      28    19  76
## 3    19    8     7     4      28    20  68
## 4    12    6     6     7      26    28  64
## 5    20    6     7     6      23    21  60
## 6    17    5     3    11      24    26  58
</code></pre>

<pre><code class="r">data_FRL11 &lt;- data_FRL11[-1 , ]

####Converting teams names to lower case
data_FRL11$Team2 &lt;-  tolower(data_FRL11$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL11$Team3 &lt;- sapply(data_FRL11$Team2, simpleCap)

data_FRL11$Team4 &lt;- as.factor(data_FRL11$Team3)

data_FRL11$Team5 &lt;-as.character(data_FRL11$Team4)
rownames(data_FRL11) &lt;- 1:nrow(data_FRL11)
head(data_FRL11)
</code></pre>

<pre><code>##   N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1     LILLE    38  21    13     4    68    36   13     5     1      40
## 2 2 MARSEILLE    38  18    14     6    62    39   10     7     2      34
## 3 3      LYON    38  17    13     8    61    40   11     7     1      35
## 4 4     P S G    38  15    15     8    56    41    9     8     2      33
## 5 5   SOCHAUX    38  17     7    14    60    43   12     4     3      36
## 6 6    RENNES    38  15    11    12    38    35    9     6     4      22
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts     Team2     Team3     Team4
## 1    17    8     8     3      28    19  76     lille     Lille     Lille
## 2    19    8     7     4      28    20  68 marseille Marseille Marseille
## 3    12    6     6     7      26    28  64      lyon      Lyon      Lyon
## 4    20    6     7     6      23    21  60     p s g     P S G     P S G
## 5    17    5     3    11      24    26  58   sochaux   Sochaux   Sochaux
## 6    13    6     5     8      16    22  56    rennes    Rennes    Rennes
##       Team5
## 1     Lille
## 2 Marseille
## 3      Lyon
## 4     P S G
## 5   Sochaux
## 6    Rennes
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL11)
</code></pre>

<pre><code>##   N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1     LILLE    38  21    13     4    68    36   13     5     1      40
## 2 2 MARSEILLE    38  18    14     6    62    39   10     7     2      34
## 3 3      LYON    38  17    13     8    61    40   11     7     1      35
## 4 4     P S G    38  15    15     8    56    41    9     8     2      33
## 5 5   SOCHAUX    38  17     7    14    60    43   12     4     3      36
## 6 6    RENNES    38  15    11    12    38    35    9     6     4      22
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts     Team2     Team3     Team4
## 1    17    8     8     3      28    19  76     lille     Lille     Lille
## 2    19    8     7     4      28    20  68 marseille Marseille Marseille
## 3    12    6     6     7      26    28  64      lyon      Lyon      Lyon
## 4    20    6     7     6      23    21  60     p s g     P S G     P S G
## 5    17    5     3    11      24    26  58   sochaux   Sochaux   Sochaux
## 6    13    6     5     8      16    22  56    rennes    Rennes    Rennes
##       Team5
## 1     Lille
## 2 Marseille
## 3      Lyon
## 4     P S G
## 5   Sochaux
## 6    Rennes
</code></pre>

<pre><code class="r">names(data_FRL11)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df4_fr &lt;- data_FRL11[c(1, 23, 3:8, 19)]

str(df4_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Lille&quot; &quot;Marseille&quot; &quot;Lyon&quot; &quot;P S G&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 7 6 3 5 1 3 ...
##  $ NA..1: Factor w/ 11 levels &quot;11&quot;,&quot;13&quot;,&quot;14&quot;,..: 2 3 2 4 8 1 4 9 7 2 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 11 12 12 5 3 2 7 13 4 ...
##  $ Goals: Factor w/ 15 levels &quot;21&quot;,&quot;32&quot;,&quot;33&quot;,..: 14 13 12 10 11 6 7 6 8 9 ...
##  $ NA..3: Factor w/ 13 levels &quot;35&quot;,&quot;36&quot;,&quot;39&quot;,..: 2 3 4 5 7 1 6 2 5 8 ...
##  $ Pts  : num  76 68 64 60 58 56 51 50 49 49 ...
</code></pre>

<pre><code class="r">head(df4_fr)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1     Lille    38  21    13     4    68    36  76
## 2 2 Marseille    38  18    14     6    62    39  68
## 3 3      Lyon    38  17    13     8    61    40  64
## 4 4     P S G    38  15    15     8    56    41  60
## 5 5   Sochaux    38  17     7    14    60    43  58
## 6 6    Rennes    38  15    11    12    38    35  56
</code></pre>

<pre><code class="r">#####Changing the names#####

df4_fr$Aggregate &lt;- paste(df4_fr$Goals, df4_fr$NA..3, sep = &quot;-&quot;)
head(df4_fr)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1     Lille    38  21    13     4    68    36  76     68-36
## 2 2 Marseille    38  18    14     6    62    39  68     62-39
## 3 3      Lyon    38  17    13     8    61    40  64     61-40
## 4 4     P S G    38  15    15     8    56    41  60     56-41
## 5 5   Sochaux    38  17     7    14    60    43  58     60-43
## 6 6    Rennes    38  15    11    12    38    35  56     38-35
</code></pre>

<pre><code class="r">df4_fr &lt;- df4_fr[ ,c(1:6, 10, 9)]
head(df4_fr)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1     Lille    38  21    13     4     68-36  76
## 2 2 Marseille    38  18    14     6     62-39  68
## 3 3      Lyon    38  17    13     8     61-40  64
## 4 4     P S G    38  15    15     8     56-41  60
## 5 5   Sochaux    38  17     7    14     60-43  58
## 6 6    Rennes    38  15    11    12     38-35  56
</code></pre>

<pre><code class="r">names(df4_fr) &lt;- names(data_9)
head(df4_fr)
</code></pre>

<pre><code>##   Index     Teams Games Wins Draws Loss Aggregate Points
## 1     1     Lille    38   21    13    4     68-36     76
## 2     2 Marseille    38   18    14    6     62-39     68
## 3     3      Lyon    38   17    13    8     61-40     64
## 4     4     P S G    38   15    15    8     56-41     60
## 5     5   Sochaux    38   17     7   14     60-43     58
## 6     6    Rennes    38   15    11   12     38-35     56
</code></pre>

<pre><code class="r">str(df4_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Lille&quot; &quot;Marseille&quot; &quot;Lyon&quot; &quot;P S G&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 7 6 3 5 1 3 ...
##  $ Draws    : Factor w/ 11 levels &quot;11&quot;,&quot;13&quot;,&quot;14&quot;,..: 2 3 2 4 8 1 4 9 7 2 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 11 12 12 5 3 2 7 13 4 ...
##  $ Aggregate: chr  &quot;68-36&quot; &quot;62-39&quot; &quot;61-40&quot; &quot;56-41&quot; ...
##  $ Points   : num  76 68 64 60 58 56 51 50 49 49 ...
</code></pre>

<pre><code class="r">df4_fr[ ,c(3:6)] &lt;- apply(df4_fr[ ,c(3:6)], 2, as.numeric)

match(df3_fr$Teams, df4_fr$Teams)
</code></pre>

<pre><code>##  [1]  2  3  9  1 14  7 11 18  6 12 19 13 NA  8 17  5 10 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df3_fr$Teams, df4_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Marseille&quot;,&quot;Lyon&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Lille&quot;,&quot;Marseille&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.4444444 0.2000000 0.1428571 1.0000000 0.2727273
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##          Var1  Var2  Distance
## 1   Marseille Lille 0.4444444
## 2        Lyon Lille 0.2000000
## 3     Auxerre Lille 0.1428571
## 4       Lille Lille 1.0000000
## 5 Montpellier Lille 0.2727273
## 6    Bordeaux Lille 0.1250000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.3))
</code></pre>

<pre><code>## [1] 46
</code></pre>

<pre><code class="r">levenshteinSim((df3_fr$Teams[df3_fr$Teams == &quot;Paris Saint Germain&quot;]), (df4_fr$Teams[(df4_fr$Teams == &quot;P S G&quot;)] ))
</code></pre>

<pre><code>## [1] 0.2631579
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.26)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.26, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Paris Saint Germain and P S G###
###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1      Var2  Distance
## 1    Marseille     Lille 0.4444444
## 4        Lille     Lille 1.0000000
## 5  Montpellier     Lille 0.2727273
## 7      Lorient     Lille 0.2857143
## 15        Nice     Lille 0.4000000
## 21   Marseille Marseille 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1           Var2  Distance
## 2                Lille          Lille 1.0000000
## 6            Marseille      Marseille 1.0000000
## 11                Lyon           Lyon 1.0000000
## 17             Sochaux        Sochaux 1.0000000
## 18              Rennes         Rennes 1.0000000
## 23            Bordeaux       Bordeaux 1.0000000
## 26            Toulouse       Toulouse 1.0000000
## 28             Auxerre        Auxerre 1.0000000
## 32          St Etienne     St Etienne 1.0000000
## 36             Lorient        Lorient 1.0000000
## 41        Valenciennes   Valenciennes 1.0000000
## 44               Nancy          Nancy 1.0000000
## 48         Montpellier    Montpellier 1.0000000
## 54                Nice           Nice 1.0000000
## 56              Monaco         Monaco 1.0000000
## 61                Lens           Lens 1.0000000
## 27            Boulogne       Toulouse 0.6250000
## 62             Le Mans           Lens 0.5714286
## 15            Bordeaux        Sochaux 0.5000000
## 20                Lens         Rennes 0.5000000
## 25             Sochaux       Bordeaux 0.5000000
## 60              Rennes           Lens 0.5000000
## 1            Marseille          Lille 0.4444444
## 7                Lille      Marseille 0.4444444
## 37                Lens        Lorient 0.4285714
## 59             Lorient           Lens 0.4285714
## 19        Valenciennes         Rennes 0.4166667
## 31        Valenciennes     St Etienne 0.4166667
## 40              Rennes   Valenciennes 0.4166667
## 42          St Etienne   Valenciennes 0.4166667
## 5                 Nice          Lille 0.4000000
## 45                Nice          Nancy 0.4000000
## 52               Lille           Nice 0.4000000
## 53               Nancy           Nice 0.4000000
## 24             Lorient       Bordeaux 0.3750000
## 35            Bordeaux        Lorient 0.3750000
## 8          Montpellier      Marseille 0.3636364
## 46           Marseille    Montpellier 0.3636364
## 10            Grenoble      Marseille 0.3333333
## 43              Monaco          Nancy 0.3333333
## 57               Nancy         Monaco 0.3333333
## 65              Rennes          Arles 0.3333333
## 21          St Etienne         Rennes 0.3000000
## 29             Lorient     St Etienne 0.3000000
## 30              Rennes     St Etienne 0.3000000
## 38          St Etienne        Lorient 0.3000000
## 4              Lorient          Lille 0.2857143
## 12             Lorient           Lyon 0.2857143
## 13             Le Mans           Lyon 0.2857143
## 16              Monaco        Sochaux 0.2857143
## 22             Le Mans         Rennes 0.2857143
## 33                Lyon        Lorient 0.2857143
## 34               Lille        Lorient 0.2857143
## 39             Le Mans        Lorient 0.2857143
## 50             Lorient           Caen 0.2857143
## 51        Valenciennes Stade Brestois 0.2857143
## 58             Sochaux         Monaco 0.2857143
## 63             Auxerre          Arles 0.2857143
## 64             Lorient          Arles 0.2857143
## 3          Montpellier          Lille 0.2727273
## 47               Lille    Montpellier 0.2727273
## 49              Monaco    Montpellier 0.2727273
## 55         Montpellier         Monaco 0.2727273
## 9  Paris Saint Germain      Marseille 0.2631579
## 14 Paris Saint Germain          P S G 0.2631579
</code></pre>

<pre><code class="r">#####Changing the names#####
df4_fr$Teams[df4_fr$Teams == &quot;P S G&quot;] &lt;- df3_fr$Teams[df3_fr$Teams == &quot;Paris Saint Germain&quot;]

###Checking match funtion after the correction
match(df3_fr$Teams, df4_fr$Teams)
</code></pre>

<pre><code>##  [1]  2  3  9  1 14  7 11 18  6 12 19 13  4  8 17  5 10 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2009-2010 in France Ligue: https://en.wikipedia.org/wiki/2009-10_Ligue_1##
###To be true, each season in France Ligue are relegated three teams (thesis, Table 3: Values of N, K, and I in European football leagues from 2008 - 2016 (8 seasons))

#####Manipulating the upper case issue in imported data (data_FRL12)#####

#library(dplyr)

head(data_FRL12)
</code></pre>

<pre><code>##    N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA        &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 MONTPELLIER    38  25     7     6    68    34   16     2     1
## 3  2       P S G    38  23    10     5    75    41   14     3     2
## 4  3       LILLE    38  21    11     6    72    39   12     5     2
## 5  4        LYON    38  19     7    12    64    51   13     3     3
## 6  5    BORDEAUX    38  16    13     9    53    41    9     8     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      37    11    9     5     5      31    23  82
## 3      42    16    9     7     3      33    25  79
## 4      48    23    9     6     4      24    16  74
## 5      44    27    6     4     9      20    24  64
## 6      25    14    7     5     7      28    27  61
</code></pre>

<pre><code class="r">data_FRL12 &lt;- data_FRL12[-1 , ]

####Converting teams names to lower case
data_FRL12$Team2 &lt;-  tolower(data_FRL12$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL12$Team3 &lt;- sapply(data_FRL12$Team2, simpleCap)

data_FRL12$Team4 &lt;- as.factor(data_FRL12$Team3)

data_FRL12$Team5 &lt;-as.character(data_FRL12$Team4)
rownames(data_FRL12) &lt;- 1:nrow(data_FRL12)
head(data_FRL12)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 MONTPELLIER    38  25     7     6    68    34   16     2     1      37
## 2 2       P S G    38  23    10     5    75    41   14     3     2      42
## 3 3       LILLE    38  21    11     6    72    39   12     5     2      48
## 4 4        LYON    38  19     7    12    64    51   13     3     3      44
## 5 5    BORDEAUX    38  16    13     9    53    41    9     8     2      25
## 6 6      RENNES    38  17     9    12    53    44    8     8     3      30
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    11    9     5     5      31    23  82 montpellier Montpellier
## 2    16    9     7     3      33    25  79       p s g       P S G
## 3    23    9     6     4      24    16  74       lille       Lille
## 4    27    6     4     9      20    24  64        lyon        Lyon
## 5    14    7     5     7      28    27  61    bordeaux    Bordeaux
## 6    19    9     1     9      23    25  60      rennes      Rennes
##         Team4       Team5
## 1 Montpellier Montpellier
## 2       P S G       P S G
## 3       Lille       Lille
## 4        Lyon        Lyon
## 5    Bordeaux    Bordeaux
## 6      Rennes      Rennes
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL12)
</code></pre>

<pre><code>##   N        Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 MONTPELLIER    38  25     7     6    68    34   16     2     1      37
## 2 2       P S G    38  23    10     5    75    41   14     3     2      42
## 3 3       LILLE    38  21    11     6    72    39   12     5     2      48
## 4 4        LYON    38  19     7    12    64    51   13     3     3      44
## 5 5    BORDEAUX    38  16    13     9    53    41    9     8     2      25
## 6 6      RENNES    38  17     9    12    53    44    8     8     3      30
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts       Team2       Team3
## 1    11    9     5     5      31    23  82 montpellier Montpellier
## 2    16    9     7     3      33    25  79       p s g       P S G
## 3    23    9     6     4      24    16  74       lille       Lille
## 4    27    6     4     9      20    24  64        lyon        Lyon
## 5    14    7     5     7      28    27  61    bordeaux    Bordeaux
## 6    19    9     1     9      23    25  60      rennes      Rennes
##         Team4       Team5
## 1 Montpellier Montpellier
## 2       P S G       P S G
## 3       Lille       Lille
## 4        Lyon        Lyon
## 5    Bordeaux    Bordeaux
## 6      Rennes      Rennes
</code></pre>

<pre><code class="r">names(data_FRL12)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df5_fr &lt;- data_FRL12[c(1, 23, 3:8, 19)]

str(df5_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Montpellier&quot; &quot;P S G&quot; &quot;Lille&quot; &quot;Lyon&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 8 6 7 6 5 4 3 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 1 2 7 4 8 8 2 2 3 ...
##  $ NA..2: Factor w/ 13 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 11 10 11 1 12 1 2 1 3 3 ...
##  $ Goals: Factor w/ 16 levels &quot;31&quot;,&quot;35&quot;,&quot;37&quot;,..: 13 15 14 12 10 10 9 3 11 7 ...
##  $ NA..3: Factor w/ 18 levels &quot;34&quot;,&quot;38&quot;,&quot;39&quot;,..: 1 4 3 11 4 5 6 1 12 4 ...
##  $ Pts  : num  82 79 74 64 61 60 57 56 50 48 ...
</code></pre>

<pre><code class="r">head(df5_fr)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Montpellier    38  25     7     6    68    34  82
## 2 2       P S G    38  23    10     5    75    41  79
## 3 3       Lille    38  21    11     6    72    39  74
## 4 4        Lyon    38  19     7    12    64    51  64
## 5 5    Bordeaux    38  16    13     9    53    41  61
## 6 6      Rennes    38  17     9    12    53    44  60
</code></pre>

<pre><code class="r">#####Changing the names#####

df5_fr$Aggregate &lt;- paste(df5_fr$Goals, df5_fr$NA..3, sep = &quot;-&quot;)
head(df5_fr)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Montpellier    38  25     7     6    68    34  82     68-34
## 2 2       P S G    38  23    10     5    75    41  79     75-41
## 3 3       Lille    38  21    11     6    72    39  74     72-39
## 4 4        Lyon    38  19     7    12    64    51  64     64-51
## 5 5    Bordeaux    38  16    13     9    53    41  61     53-41
## 6 6      Rennes    38  17     9    12    53    44  60     53-44
</code></pre>

<pre><code class="r">df5_fr &lt;- df5_fr[ ,c(1:6, 10, 9)]
head(df5_fr)
</code></pre>

<pre><code>##   N       Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Montpellier    38  25     7     6     68-34  82
## 2 2       P S G    38  23    10     5     75-41  79
## 3 3       Lille    38  21    11     6     72-39  74
## 4 4        Lyon    38  19     7    12     64-51  64
## 5 5    Bordeaux    38  16    13     9     53-41  61
## 6 6      Rennes    38  17     9    12     53-44  60
</code></pre>

<pre><code class="r">names(df5_fr) &lt;- names(data_9)
head(df5_fr)
</code></pre>

<pre><code>##   Index       Teams Games Wins Draws Loss Aggregate Points
## 1     1 Montpellier    38   25     7    6     68-34     82
## 2     2       P S G    38   23    10    5     75-41     79
## 3     3       Lille    38   21    11    6     72-39     74
## 4     4        Lyon    38   19     7   12     64-51     64
## 5     5    Bordeaux    38   16    13    9     53-41     61
## 6     6      Rennes    38   17     9   12     53-44     60
</code></pre>

<pre><code class="r">str(df5_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Montpellier&quot; &quot;P S G&quot; &quot;Lille&quot; &quot;Lyon&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 10 9 8 6 7 6 5 4 3 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 1 2 7 4 8 8 2 2 3 ...
##  $ Loss     : Factor w/ 13 levels &quot;12&quot;,&quot;13&quot;,&quot;14&quot;,..: 11 10 11 1 12 1 2 1 3 3 ...
##  $ Aggregate: chr  &quot;68-34&quot; &quot;75-41&quot; &quot;72-39&quot; &quot;64-51&quot; ...
##  $ Points   : num  82 79 74 64 61 60 57 56 50 48 ...
</code></pre>

<pre><code class="r">df5_fr[ ,c(3:6)] &lt;- apply(df5_fr[ ,c(3:6)], 2, as.numeric)

match(df4_fr$Teams, df5_fr$Teams)
</code></pre>

<pre><code>##  [1]  3 10  4 NA 14  6  5  8 20  7 17 12 11  1 18 15 13 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df4_fr$Teams, df5_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Lille&quot;,&quot;Marseille&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;Montpellier&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.27272727 0.36363636 0.09090909 0.15789474 0.09090909
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                  Var1        Var2   Distance
## 1               Lille Montpellier 0.27272727
## 2           Marseille Montpellier 0.36363636
## 3                Lyon Montpellier 0.09090909
## 4 Paris Saint Germain Montpellier 0.15789474
## 5             Sochaux Montpellier 0.09090909
## 6              Rennes Montpellier 0.18181818
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.3))
</code></pre>

<pre><code>## [1] 42
</code></pre>

<pre><code class="r">levenshteinSim((df4_fr$Teams[df4_fr$Teams == &quot;Paris Saint Germain&quot;]), (df5_fr$Teams[(df5_fr$Teams == &quot;P S G&quot;)] ))
</code></pre>

<pre><code>## [1] 0.2631579
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.26)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.26, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Paris Saint Germain and P S G###
###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                   Var1        Var2  Distance
## 1                Lille Montpellier 0.2727273
## 2            Marseille Montpellier 0.3636364
## 14         Montpellier Montpellier 1.0000000
## 18              Monaco Montpellier 0.2727273
## 24 Paris Saint Germain       P S G 0.2631579
## 41               Lille       Lille 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1           Var2  Distance
## 3          Montpellier    Montpellier 1.0000000
## 6                Lille          Lille 1.0000000
## 11                Lyon           Lyon 1.0000000
## 14            Bordeaux       Bordeaux 1.0000000
## 16              Rennes         Rennes 1.0000000
## 22          St Etienne     St Etienne 1.0000000
## 25            Toulouse       Toulouse 1.0000000
## 29           Marseille      Marseille 1.0000000
## 32               Nancy          Nancy 1.0000000
## 37        Valenciennes   Valenciennes 1.0000000
## 41                Nice           Nice 1.0000000
## 42             Sochaux        Sochaux 1.0000000
## 46      Stade Brestois Stade Brestois 1.0000000
## 53             Lorient        Lorient 1.0000000
## 58                Caen           Caen 1.0000000
## 60             Auxerre        Auxerre 1.0000000
## 13             Sochaux       Bordeaux 0.5000000
## 19                Lens         Rennes 0.5000000
## 43            Bordeaux        Sochaux 0.5000000
## 7            Marseille          Lille 0.4444444
## 28               Lille      Marseille 0.4444444
## 55                Lens        Lorient 0.4285714
## 18        Valenciennes         Rennes 0.4166667
## 24        Valenciennes     St Etienne 0.4166667
## 35              Rennes   Valenciennes 0.4166667
## 36          St Etienne   Valenciennes 0.4166667
## 10                Nice          Lille 0.4000000
## 33                Nice          Nancy 0.4000000
## 39               Lille           Nice 0.4000000
## 40               Nancy           Nice 0.4000000
## 59                Lyon          Dijon 0.4000000
## 15             Lorient       Bordeaux 0.3750000
## 51            Bordeaux        Lorient 0.3750000
## 2            Marseille    Montpellier 0.3636364
## 31         Montpellier      Marseille 0.3636364
## 20               Arles         Rennes 0.3333333
## 34              Monaco          Nancy 0.3333333
## 17          St Etienne         Rennes 0.3000000
## 21              Rennes     St Etienne 0.3000000
## 23             Lorient     St Etienne 0.3000000
## 26          St Etienne          Evian 0.3000000
## 52          St Etienne        Lorient 0.3000000
## 8              Lorient          Lille 0.2857143
## 12             Lorient           Lyon 0.2857143
## 27             Lorient          Evian 0.2857143
## 38      Stade Brestois   Valenciennes 0.2857143
## 44              Monaco        Sochaux 0.2857143
## 45        Valenciennes Stade Brestois 0.2857143
## 47               Nancy        Ajaccio 0.2857143
## 48              Monaco        Ajaccio 0.2857143
## 49               Lille        Lorient 0.2857143
## 50                Lyon        Lorient 0.2857143
## 54                Caen        Lorient 0.2857143
## 56               Arles        Lorient 0.2857143
## 57             Lorient           Caen 0.2857143
## 61               Arles        Auxerre 0.2857143
## 1                Lille    Montpellier 0.2727273
## 4               Monaco    Montpellier 0.2727273
## 9          Montpellier          Lille 0.2727273
## 5  Paris Saint Germain          P S G 0.2631579
## 30 Paris Saint Germain      Marseille 0.2631579
</code></pre>

<pre><code class="r">#####Changing the names#####
df5_fr$Teams[df5_fr$Teams == &quot;P S G&quot;] &lt;- df4_fr$Teams[df4_fr$Teams == &quot;Paris Saint Germain&quot;]

###Checking match funtion after the correction
match(df4_fr$Teams, df5_fr$Teams)
</code></pre>

<pre><code>##  [1]  3 10  4  2 14  6  5  8 20  7 17 12 11  1 18 15 13 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2010-2011 in France Ligue: https://en.wikipedia.org/wiki/2010-11_Ligue_1##

#####Manipulating the upper case issue in imported data (data_FRL13)#####

#library(dplyr)

head(data_FRL13)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1      P S G    38  25     8     5    69    23   13     4     2      34
## 3  2  MARSEILLE    38  21     8     9    42    36   12     4     3      25
## 4  3       LYON    38  19    10     9    61    38   11     4     4      34
## 5  4       NICE    38  18    10    10    57    46   11     5     3      35
## 6  5 ST ETIENNE    38  16    15     7    60    32   11     4     4      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    10   12     4     3      35    13  83
## 3    18    9     4     6      17    18  71
## 4    17    8     6     5      27    21  67
## 5    17    7     5     7      22    29  64
## 6    13    5    11     3      24    19  63
</code></pre>

<pre><code class="r">data_FRL13 &lt;- data_FRL13[-1 , ]

####Converting teams names to lower case
data_FRL13$Team2 &lt;-  tolower(data_FRL13$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL13$Team3 &lt;- sapply(data_FRL13$Team2, simpleCap)

data_FRL13$Team4 &lt;- as.factor(data_FRL13$Team3)

data_FRL13$Team5 &lt;-as.character(data_FRL13$Team4)
rownames(data_FRL13) &lt;- 1:nrow(data_FRL13)
head(data_FRL13)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  25     8     5    69    23   13     4     2      34
## 2 2  MARSEILLE    38  21     8     9    42    36   12     4     3      25
## 3 3       LYON    38  19    10     9    61    38   11     4     4      34
## 4 4       NICE    38  18    10    10    57    46   11     5     3      35
## 5 5 ST ETIENNE    38  16    15     7    60    32   11     4     4      36
## 6 6      LILLE    38  16    14     8    59    40    9     7     3      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    10   12     4     3      35    13  83      p s g      P S G
## 2    18    9     4     6      17    18  71  marseille  Marseille
## 3    17    8     6     5      27    21  67       lyon       Lyon
## 4    17    7     5     7      22    29  64       nice       Nice
## 5    13    5    11     3      24    19  63 st etienne St Etienne
## 6    16    7     7     5      27    24  62      lille      Lille
##        Team4      Team5
## 1      P S G      P S G
## 2  Marseille  Marseille
## 3       Lyon       Lyon
## 4       Nice       Nice
## 5 St Etienne St Etienne
## 6      Lille      Lille
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL13)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  25     8     5    69    23   13     4     2      34
## 2 2  MARSEILLE    38  21     8     9    42    36   12     4     3      25
## 3 3       LYON    38  19    10     9    61    38   11     4     4      34
## 4 4       NICE    38  18    10    10    57    46   11     5     3      35
## 5 5 ST ETIENNE    38  16    15     7    60    32   11     4     4      36
## 6 6      LILLE    38  16    14     8    59    40    9     7     3      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    10   12     4     3      35    13  83      p s g      P S G
## 2    18    9     4     6      17    18  71  marseille  Marseille
## 3    17    8     6     5      27    21  67       lyon       Lyon
## 4    17    7     5     7      22    29  64       nice       Nice
## 5    13    5    11     3      24    19  63 st etienne St Etienne
## 6    16    7     7     5      27    24  62      lille      Lille
##        Team4      Team5
## 1      P S G      P S G
## 2  Marseille  Marseille
## 3       Lyon       Lyon
## 4       Nice       Nice
## 5 St Etienne St Etienne
## 6      Lille      Lille
</code></pre>

<pre><code class="r">names(data_FRL13)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df6_fr &lt;- data_FRL13[c(1, 23, 3:8, 19)]

str(df6_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;P S G&quot; &quot;Marseille&quot; &quot;Lyon&quot; &quot;Nice&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 10 9 8 7 6 6 3 4 5 3 ...
##  $ NA..1: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 10 1 1 6 5 7 2 9 3 ...
##  $ NA..2: Factor w/ 13 levels &quot;10&quot;,&quot;13&quot;,&quot;14&quot;,..: 9 12 12 1 10 11 12 2 5 2 ...
##  $ Goals: Factor w/ 19 levels &quot;32&quot;,&quot;33&quot;,&quot;38&quot;,..: 18 7 17 14 16 15 5 14 13 11 ...
##  $ NA..3: Factor w/ 18 levels &quot;23&quot;,&quot;32&quot;,&quot;34&quot;,..: 1 4 5 8 2 6 3 13 10 9 ...
##  $ Pts  : num  83 71 67 64 63 62 55 53 52 51 ...
</code></pre>

<pre><code class="r">head(df6_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1      P S G    38  25     8     5    69    23  83
## 2 2  Marseille    38  21     8     9    42    36  71
## 3 3       Lyon    38  19    10     9    61    38  67
## 4 4       Nice    38  18    10    10    57    46  64
## 5 5 St Etienne    38  16    15     7    60    32  63
## 6 6      Lille    38  16    14     8    59    40  62
</code></pre>

<pre><code class="r">#####Changing the names#####

df6_fr$Aggregate &lt;- paste(df6_fr$Goals, df6_fr$NA..3, sep = &quot;-&quot;)
head(df6_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1      P S G    38  25     8     5    69    23  83     69-23
## 2 2  Marseille    38  21     8     9    42    36  71     42-36
## 3 3       Lyon    38  19    10     9    61    38  67     61-38
## 4 4       Nice    38  18    10    10    57    46  64     57-46
## 5 5 St Etienne    38  16    15     7    60    32  63     60-32
## 6 6      Lille    38  16    14     8    59    40  62     59-40
</code></pre>

<pre><code class="r">df6_fr &lt;- df6_fr[ ,c(1:6, 10, 9)]
head(df6_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1      P S G    38  25     8     5     69-23  83
## 2 2  Marseille    38  21     8     9     42-36  71
## 3 3       Lyon    38  19    10     9     61-38  67
## 4 4       Nice    38  18    10    10     57-46  64
## 5 5 St Etienne    38  16    15     7     60-32  63
## 6 6      Lille    38  16    14     8     59-40  62
</code></pre>

<pre><code class="r">names(df6_fr) &lt;- names(data_9)
head(df6_fr)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1      P S G    38   25     8    5     69-23     83
## 2     2  Marseille    38   21     8    9     42-36     71
## 3     3       Lyon    38   19    10    9     61-38     67
## 4     4       Nice    38   18    10   10     57-46     64
## 5     5 St Etienne    38   16    15    7     60-32     63
## 6     6      Lille    38   16    14    8     59-40     62
</code></pre>

<pre><code class="r">str(df6_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;P S G&quot; &quot;Marseille&quot; &quot;Lyon&quot; &quot;Nice&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 10 9 8 7 6 6 3 4 5 3 ...
##  $ Draws    : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 10 1 1 6 5 7 2 9 3 ...
##  $ Loss     : Factor w/ 13 levels &quot;10&quot;,&quot;13&quot;,&quot;14&quot;,..: 9 12 12 1 10 11 12 2 5 2 ...
##  $ Aggregate: chr  &quot;69-23&quot; &quot;42-36&quot; &quot;61-38&quot; &quot;57-46&quot; ...
##  $ Points   : num  83 71 67 64 63 62 55 53 52 51 ...
</code></pre>

<pre><code class="r">df6_fr[ ,c(3:6)] &lt;- apply(df6_fr[ ,c(3:6)], 2, as.numeric)

match(df5_fr$Teams, df6_fr$Teams)
</code></pre>

<pre><code>##  [1]  9 NA  6  3  7 13  5 10 16  2 18 11  4 15 20 17  8 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df5_fr$Teams, df6_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Montpellier&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;P S G&quot;,&quot;Marseille&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.0000000 0.2631579 0.0000000 0.0000000 0.0000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                  Var1  Var2  Distance
## 1         Montpellier P S G 0.0000000
## 2 Paris Saint Germain P S G 0.2631579
## 3               Lille P S G 0.0000000
## 4                Lyon P S G 0.0000000
## 5            Bordeaux P S G 0.0000000
## 6              Rennes P S G 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.25))
</code></pre>

<pre><code>## [1] 73
</code></pre>

<pre><code class="r">levenshteinSim((df5_fr$Teams[df5_fr$Teams == &quot;Paris Saint Germain&quot;]), (df6_fr$Teams[(df6_fr$Teams == &quot;P S G&quot;)] ))
</code></pre>

<pre><code>## [1] 0.2631579
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.26)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.26, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Paris Saint Germain and P S G###
###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                   Var1      Var2  Distance
## 2  Paris Saint Germain     P S G 0.2631579
## 21         Montpellier Marseille 0.3636364
## 22 Paris Saint Germain Marseille 0.2631579
## 23               Lille Marseille 0.4444444
## 30           Marseille Marseille 1.0000000
## 44                Lyon      Lyon 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1           Var2  Distance
## 5            Marseille      Marseille 1.0000000
## 6                 Lyon           Lyon 1.0000000
## 11                Nice           Nice 1.0000000
## 13          St Etienne     St Etienne 1.0000000
## 18               Lille          Lille 1.0000000
## 22            Bordeaux       Bordeaux 1.0000000
## 30             Lorient        Lorient 1.0000000
## 32         Montpellier    Montpellier 1.0000000
## 35            Toulouse       Toulouse 1.0000000
## 38        Valenciennes   Valenciennes 1.0000000
## 43              Rennes         Rennes 1.0000000
## 48             Sochaux        Sochaux 1.0000000
## 50               Evian          Evian 1.0000000
## 53             Ajaccio        Ajaccio 1.0000000
## 54               Nancy          Nancy 1.0000000
## 58      Stade Brestois Stade Brestois 1.0000000
## 23             Sochaux       Bordeaux 0.5000000
## 46              Rennes          Reims 0.5000000
## 47            Bordeaux        Sochaux 0.5000000
## 4                Lille      Marseille 0.4444444
## 19           Marseille          Lille 0.4444444
## 15        Valenciennes     St Etienne 0.4166667
## 36              Rennes   Valenciennes 0.4166667
## 37          St Etienne   Valenciennes 0.4166667
## 45        Valenciennes         Rennes 0.4166667
## 8                Dijon           Lyon 0.4000000
## 9                Lille           Nice 0.4000000
## 10               Nancy           Nice 0.4000000
## 20                Nice          Lille 0.4000000
## 55                Nice          Nancy 0.4000000
## 24             Lorient       Bordeaux 0.3750000
## 27            Bordeaux        Lorient 0.3750000
## 2          Montpellier      Marseille 0.3636364
## 34           Marseille    Montpellier 0.3636364
## 40           Marseille         Bastia 0.3333333
## 12              Rennes     St Etienne 0.3000000
## 14               Evian     St Etienne 0.3000000
## 16             Lorient     St Etienne 0.3000000
## 28          St Etienne        Lorient 0.3000000
## 44          St Etienne         Rennes 0.3000000
## 49          St Etienne          Evian 0.3000000
## 7              Lorient           Lyon 0.2857143
## 21             Lorient          Lille 0.2857143
## 25               Lille        Lorient 0.2857143
## 26                Lyon        Lorient 0.2857143
## 29               Evian        Lorient 0.2857143
## 31                Caen        Lorient 0.2857143
## 39      Stade Brestois   Valenciennes 0.2857143
## 41      Stade Brestois         Bastia 0.2857143
## 42             Ajaccio         Bastia 0.2857143
## 51             Lorient          Evian 0.2857143
## 52               Nancy        Ajaccio 0.2857143
## 56             Ajaccio          Nancy 0.2857143
## 57        Valenciennes Stade Brestois 0.2857143
## 17         Montpellier          Lille 0.2727273
## 33               Lille    Montpellier 0.2727273
## 1  Paris Saint Germain          P S G 0.2631579
## 3  Paris Saint Germain      Marseille 0.2631579
</code></pre>

<pre><code class="r">#####Changing the names#####
df6_fr$Teams[df6_fr$Teams == &quot;P S G&quot;] &lt;- df5_fr$Teams[df5_fr$Teams == &quot;Paris Saint Germain&quot;]

###Checking match funtion after the correction
match(df5_fr$Teams, df6_fr$Teams)
</code></pre>

<pre><code>##  [1]  9  1  6  3  7 13  5 10 16  2 18 11  4 15 20 17  8 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2011-2012 in France Ligue: https://en.wikipedia.org/wiki/2011-12_Ligue_1##

#####Manipulating the upper case issue in imported data (data_FRL14)#####

#library(dplyr)

head(data_FRL14)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1      P S G    38  27     8     3    84    23   15     3     1      51
## 3  2     MONACO    38  23    11     4    63    31   12     6     1      32
## 4  3      LILLE    38  20    11     7    46    26   13     3     3      25
## 5  4 ST ETIENNE    38  20     9     9    56    34   12     5     2      36
## 6  5       LYON    38  17    10    11    56    44    8     7     4      30
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2     7   12     5     2      33    16  89
## 3    14   11     5     3      31    17  80
## 4    10    7     8     4      21    16  71
## 5    15    8     4     7      20    19  69
## 6    15    9     3     7      26    29  61
</code></pre>

<pre><code class="r">data_FRL14 &lt;- data_FRL14[-1 , ]

####Converting teams names to lower case
data_FRL14$Team2 &lt;-  tolower(data_FRL14$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL14$Team3 &lt;- sapply(data_FRL14$Team2, simpleCap)

data_FRL14$Team4 &lt;- as.factor(data_FRL14$Team3)

data_FRL14$Team5 &lt;-as.character(data_FRL14$Team4)
rownames(data_FRL14) &lt;- 1:nrow(data_FRL14)
head(data_FRL14)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  27     8     3    84    23   15     3     1      51
## 2 2     MONACO    38  23    11     4    63    31   12     6     1      32
## 3 3      LILLE    38  20    11     7    46    26   13     3     3      25
## 4 4 ST ETIENNE    38  20     9     9    56    34   12     5     2      36
## 5 5       LYON    38  17    10    11    56    44    8     7     4      30
## 6 6  MARSEILLE    38  16    12    10    53    40   10     3     6      30
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     7   12     5     2      33    16  89      p s g      P S G
## 2    14   11     5     3      31    17  80     monaco     Monaco
## 3    10    7     8     4      21    16  71      lille      Lille
## 4    15    8     4     7      20    19  69 st etienne St Etienne
## 5    15    9     3     7      26    29  61       lyon       Lyon
## 6    20    6     9     4      23    20  60  marseille  Marseille
##        Team4      Team5
## 1      P S G      P S G
## 2     Monaco     Monaco
## 3      Lille      Lille
## 4 St Etienne St Etienne
## 5       Lyon       Lyon
## 6  Marseille  Marseille
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL14)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  27     8     3    84    23   15     3     1      51
## 2 2     MONACO    38  23    11     4    63    31   12     6     1      32
## 3 3      LILLE    38  20    11     7    46    26   13     3     3      25
## 4 4 ST ETIENNE    38  20     9     9    56    34   12     5     2      36
## 5 5       LYON    38  17    10    11    56    44    8     7     4      30
## 6 6  MARSEILLE    38  16    12    10    53    40   10     3     6      30
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     7   12     5     2      33    16  89      p s g      P S G
## 2    14   11     5     3      31    17  80     monaco     Monaco
## 3    10    7     8     4      21    16  71      lille      Lille
## 4    15    8     4     7      20    19  69 st etienne St Etienne
## 5    15    9     3     7      26    29  61       lyon       Lyon
## 6    20    6     9     4      23    20  60  marseille  Marseille
##        Team4      Team5
## 1      P S G      P S G
## 2     Monaco     Monaco
## 3      Lille      Lille
## 4 St Etienne St Etienne
## 5       Lyon       Lyon
## 6  Marseille  Marseille
</code></pre>

<pre><code class="r">names(data_FRL14)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df7_fr &lt;- data_FRL14[c(1, 23, 3:8, 19)]

str(df7_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;P S G&quot; &quot;Monaco&quot; &quot;Lille&quot; &quot;St Etienne&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 7 6 5 4 4 3 3 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 2 2 9 1 3 5 1 4 2 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 12 13 14 2 1 2 6 4 6 ...
##  $ Goals: Factor w/ 17 levels &quot;30&quot;,&quot;34&quot;,&quot;37&quot;,..: 16 15 9 14 14 13 12 11 9 6 ...
##  $ NA..3: Factor w/ 17 levels &quot;23&quot;,&quot;26&quot;,&quot;31&quot;,..: 1 3 2 4 8 5 7 12 12 13 ...
##  $ Pts  : num  89 80 71 69 61 60 53 49 49 49 ...
</code></pre>

<pre><code class="r">head(df7_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1      P S G    38  27     8     3    84    23  89
## 2 2     Monaco    38  23    11     4    63    31  80
## 3 3      Lille    38  20    11     7    46    26  71
## 4 4 St Etienne    38  20     9     9    56    34  69
## 5 5       Lyon    38  17    10    11    56    44  61
## 6 6  Marseille    38  16    12    10    53    40  60
</code></pre>

<pre><code class="r">#####Changing the names#####

df7_fr$Aggregate &lt;- paste(df7_fr$Goals, df7_fr$NA..3, sep = &quot;-&quot;)
head(df7_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1      P S G    38  27     8     3    84    23  89     84-23
## 2 2     Monaco    38  23    11     4    63    31  80     63-31
## 3 3      Lille    38  20    11     7    46    26  71     46-26
## 4 4 St Etienne    38  20     9     9    56    34  69     56-34
## 5 5       Lyon    38  17    10    11    56    44  61     56-44
## 6 6  Marseille    38  16    12    10    53    40  60     53-40
</code></pre>

<pre><code class="r">df7_fr &lt;- df7_fr[ ,c(1:6, 10, 9)]
head(df7_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1      P S G    38  27     8     3     84-23  89
## 2 2     Monaco    38  23    11     4     63-31  80
## 3 3      Lille    38  20    11     7     46-26  71
## 4 4 St Etienne    38  20     9     9     56-34  69
## 5 5       Lyon    38  17    10    11     56-44  61
## 6 6  Marseille    38  16    12    10     53-40  60
</code></pre>

<pre><code class="r">names(df7_fr) &lt;- names(data_9)
head(df7_fr)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1      P S G    38   27     8    3     84-23     89
## 2     2     Monaco    38   23    11    4     63-31     80
## 3     3      Lille    38   20    11    7     46-26     71
## 4     4 St Etienne    38   20     9    9     56-34     69
## 5     5       Lyon    38   17    10   11     56-44     61
## 6     6  Marseille    38   16    12   10     53-40     60
</code></pre>

<pre><code class="r">str(df7_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;P S G&quot; &quot;Monaco&quot; &quot;Lille&quot; &quot;St Etienne&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 7 6 5 4 4 3 3 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 2 2 9 1 3 5 1 4 2 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 11 12 13 14 2 1 2 6 4 6 ...
##  $ Aggregate: chr  &quot;84-23&quot; &quot;63-31&quot; &quot;46-26&quot; &quot;56-34&quot; ...
##  $ Points   : num  89 80 71 69 61 60 53 49 49 49 ...
</code></pre>

<pre><code class="r">df7_fr[ ,c(3:6)] &lt;- apply(df7_fr[ ,c(3:6)], 2, as.numeric)

match(df6_fr$Teams, df7_fr$Teams)
</code></pre>

<pre><code>##  [1] NA  6  5 17  4  3  7  8 15  9 19 10 12 11 18 14 20 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df6_fr$Teams, df7_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Paris Saint Germain&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;P S G&quot;,&quot;Monaco&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.2631579 0.0000000 0.0000000 0.0000000 0.1000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                  Var1  Var2  Distance
## 1 Paris Saint Germain P S G 0.2631579
## 2           Marseille P S G 0.0000000
## 3                Lyon P S G 0.0000000
## 4                Nice P S G 0.0000000
## 5          St Etienne P S G 0.1000000
## 6               Lille P S G 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.25))
</code></pre>

<pre><code>## [1] 82
</code></pre>

<pre><code class="r">levenshteinSim((df6_fr$Teams[df6_fr$Teams == &quot;Paris Saint Germain&quot;]), (df7_fr$Teams[(df7_fr$Teams == &quot;P S G&quot;)] ))
</code></pre>

<pre><code>## [1] 0.2631579
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.26)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.26, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Paris Saint Germain and P S G###
###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                   Var1   Var2  Distance
## 1  Paris Saint Germain  P S G 0.2631579
## 29         Montpellier Monaco 0.2727273
## 35             Sochaux Monaco 0.2857143
## 37             Ajaccio Monaco 0.2857143
## 38               Nancy Monaco 0.3333333
## 42           Marseille  Lille 0.4444444
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1         Var2  Distance
## 8                Lille        Lille 1.0000000
## 11          St Etienne   St Etienne 1.0000000
## 16                Lyon         Lyon 1.0000000
## 19           Marseille    Marseille 1.0000000
## 23            Bordeaux     Bordeaux 1.0000000
## 30             Lorient      Lorient 1.0000000
## 32            Toulouse     Toulouse 1.0000000
## 34              Bastia       Bastia 1.0000000
## 38               Reims        Reims 1.0000000
## 41              Rennes       Rennes 1.0000000
## 51               Evian        Evian 1.0000000
## 54         Montpellier  Montpellier 1.0000000
## 55                Nice         Nice 1.0000000
## 59             Sochaux      Sochaux 1.0000000
## 61        Valenciennes Valenciennes 1.0000000
## 65             Ajaccio      Ajaccio 1.0000000
## 25             Sochaux     Bordeaux 0.5000000
## 37              Rennes        Reims 0.5000000
## 42               Reims       Rennes 0.5000000
## 47              Rennes       Nantes 0.5000000
## 48               Nancy       Nantes 0.5000000
## 58            Bordeaux      Sochaux 0.5000000
## 6            Marseille        Lille 0.4444444
## 20               Lille    Marseille 0.4444444
## 13        Valenciennes   St Etienne 0.4166667
## 40        Valenciennes       Rennes 0.4166667
## 60          St Etienne Valenciennes 0.4166667
## 62              Rennes Valenciennes 0.4166667
## 7                 Nice        Lille 0.4000000
## 56               Lille         Nice 0.4000000
## 57               Nancy         Nice 0.4000000
## 24             Lorient     Bordeaux 0.3750000
## 29            Bordeaux      Lorient 0.3750000
## 21         Montpellier    Marseille 0.3636364
## 52           Marseille  Montpellier 0.3636364
## 5                Nancy       Monaco 0.3333333
## 22              Bastia    Marseille 0.3333333
## 33           Marseille       Bastia 0.3333333
## 43                Nice       Nantes 0.3333333
## 45        Valenciennes       Nantes 0.3333333
## 46              Bastia       Nantes 0.3333333
## 12             Lorient   St Etienne 0.3000000
## 14              Rennes   St Etienne 0.3000000
## 15               Evian   St Etienne 0.3000000
## 27          St Etienne      Lorient 0.3000000
## 39          St Etienne       Rennes 0.3000000
## 49          St Etienne        Evian 0.3000000
## 3              Sochaux       Monaco 0.2857143
## 4              Ajaccio       Monaco 0.2857143
## 9              Lorient        Lille 0.2857143
## 17             Lorient         Lyon 0.2857143
## 26                Lyon      Lorient 0.2857143
## 28               Lille      Lorient 0.2857143
## 31               Evian      Lorient 0.2857143
## 35             Ajaccio       Bastia 0.2857143
## 36      Stade Brestois       Bastia 0.2857143
## 50             Lorient        Evian 0.2857143
## 63      Stade Brestois Valenciennes 0.2857143
## 64              Bastia      Ajaccio 0.2857143
## 66               Nancy      Ajaccio 0.2857143
## 2          Montpellier       Monaco 0.2727273
## 10         Montpellier        Lille 0.2727273
## 44         Montpellier       Nantes 0.2727273
## 53               Lille  Montpellier 0.2727273
## 1  Paris Saint Germain        P S G 0.2631579
## 18 Paris Saint Germain    Marseille 0.2631579
</code></pre>

<pre><code class="r">#####Changing the names#####
df7_fr$Teams[df7_fr$Teams == &quot;P S G&quot;] &lt;- df6_fr$Teams[df6_fr$Teams == &quot;Paris Saint Germain&quot;]

###Checking match funtion after the correction
match(df6_fr$Teams, df7_fr$Teams)
</code></pre>

<pre><code>##  [1]  1  6  5 17  4  3  7  8 15  9 19 10 12 11 18 14 20 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2012-2013 in France Ligue: https://en.wikipedia.org/wiki/2012-13_Ligue_1##

#####Manipulating the upper case issue in imported data (data_FRL15)#####

#library(dplyr)

head(data_FRL15)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1      P S G    38  24    11     3    83    36   15     4     0      52
## 3  2       LYON    38  22     9     7    72    33   14     3     2      40
## 4  3     MONACO    38  20    11     7    51    26    8     9     2      23
## 5  4  MARSEILLE    38  21     6    11    76    42   13     2     4      40
## 6  5 ST ETIENNE    38  19    12     7    51    30   12     5     2      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    14    9     7     3      31    22  83
## 3    11    8     6     5      32    22  75
## 4    10   12     2     5      28    16  71
## 5    22    8     4     7      36    20  69
## 6    11    7     7     5      19    19  69
</code></pre>

<pre><code class="r">data_FRL15 &lt;- data_FRL15[-1 , ]

####Converting teams names to lower case
data_FRL15$Team2 &lt;-  tolower(data_FRL15$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL15$Team3 &lt;- sapply(data_FRL15$Team2, simpleCap)

data_FRL15$Team4 &lt;- as.factor(data_FRL15$Team3)

data_FRL15$Team5 &lt;-as.character(data_FRL15$Team4)
rownames(data_FRL15) &lt;- 1:nrow(data_FRL15)
head(data_FRL15)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  24    11     3    83    36   15     4     0      52
## 2 2       LYON    38  22     9     7    72    33   14     3     2      40
## 3 3     MONACO    38  20    11     7    51    26    8     9     2      23
## 4 4  MARSEILLE    38  21     6    11    76    42   13     2     4      40
## 5 5 ST ETIENNE    38  19    12     7    51    30   12     5     2      32
## 6 6   BORDEAUX    38  17    12     9    47    44   12     5     2      31
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    14    9     7     3      31    22  83      p s g      P S G
## 2    11    8     6     5      32    22  75       lyon       Lyon
## 3    10   12     2     5      28    16  71     monaco     Monaco
## 4    22    8     4     7      36    20  69  marseille  Marseille
## 5    11    7     7     5      19    19  69 st etienne St Etienne
## 6    23    5     7     7      16    21  63   bordeaux   Bordeaux
##        Team4      Team5
## 1      P S G      P S G
## 2       Lyon       Lyon
## 3     Monaco     Monaco
## 4  Marseille  Marseille
## 5 St Etienne St Etienne
## 6   Bordeaux   Bordeaux
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL15)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  24    11     3    83    36   15     4     0      52
## 2 2       LYON    38  22     9     7    72    33   14     3     2      40
## 3 3     MONACO    38  20    11     7    51    26    8     9     2      23
## 4 4  MARSEILLE    38  21     6    11    76    42   13     2     4      40
## 5 5 ST ETIENNE    38  19    12     7    51    30   12     5     2      32
## 6 6   BORDEAUX    38  17    12     9    47    44   12     5     2      31
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    14    9     7     3      31    22  83      p s g      P S G
## 2    11    8     6     5      32    22  75       lyon       Lyon
## 3    10   12     2     5      28    16  71     monaco     Monaco
## 4    22    8     4     7      36    20  69  marseille  Marseille
## 5    11    7     7     5      19    19  69 st etienne St Etienne
## 6    23    5     7     7      16    21  63   bordeaux   Bordeaux
##        Team4      Team5
## 1      P S G      P S G
## 2       Lyon       Lyon
## 3     Monaco     Monaco
## 4  Marseille  Marseille
## 5 St Etienne St Etienne
## 6   Bordeaux   Bordeaux
</code></pre>

<pre><code class="r">names(data_FRL15)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df8_fr &lt;- data_FRL15[c(1, 23, 3:8, 19)]

str(df8_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;P S G&quot; &quot;Lyon&quot; &quot;Monaco&quot; &quot;Marseille&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 10 8 9 7 6 5 5 3 4 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 2 8 2 5 3 3 7 7 2 4 ...
##  $ NA..2: Factor w/ 13 levels &quot;11&quot;,&quot;14&quot;,&quot;15&quot;,..: 10 11 11 1 11 12 2 2 2 6 ...
##  $ Goals: Factor w/ 16 levels &quot;29&quot;,&quot;31&quot;,&quot;32&quot;,..: 15 13 11 14 11 10 9 7 4 6 ...
##  $ NA..3: Factor w/ 17 levels &quot;26&quot;,&quot;30&quot;,&quot;33&quot;,..: 4 3 1 7 2 8 5 7 7 12 ...
##  $ Pts  : num  83 75 71 69 69 63 56 56 50 49 ...
</code></pre>

<pre><code class="r">head(df8_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1      P S G    38  24    11     3    83    36  83
## 2 2       Lyon    38  22     9     7    72    33  75
## 3 3     Monaco    38  20    11     7    51    26  71
## 4 4  Marseille    38  21     6    11    76    42  69
## 5 5 St Etienne    38  19    12     7    51    30  69
## 6 6   Bordeaux    38  17    12     9    47    44  63
</code></pre>

<pre><code class="r">#####Changing the names#####

df8_fr$Aggregate &lt;- paste(df8_fr$Goals, df8_fr$NA..3, sep = &quot;-&quot;)
head(df8_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1      P S G    38  24    11     3    83    36  83     83-36
## 2 2       Lyon    38  22     9     7    72    33  75     72-33
## 3 3     Monaco    38  20    11     7    51    26  71     51-26
## 4 4  Marseille    38  21     6    11    76    42  69     76-42
## 5 5 St Etienne    38  19    12     7    51    30  69     51-30
## 6 6   Bordeaux    38  17    12     9    47    44  63     47-44
</code></pre>

<pre><code class="r">df8_fr &lt;- df8_fr[ ,c(1:6, 10, 9)]
head(df8_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1      P S G    38  24    11     3     83-36  83
## 2 2       Lyon    38  22     9     7     72-33  75
## 3 3     Monaco    38  20    11     7     51-26  71
## 4 4  Marseille    38  21     6    11     76-42  69
## 5 5 St Etienne    38  19    12     7     51-30  69
## 6 6   Bordeaux    38  17    12     9     47-44  63
</code></pre>

<pre><code class="r">names(df8_fr) &lt;- names(data_9)
head(df8_fr)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1      P S G    38   24    11    3     83-36     83
## 2     2       Lyon    38   22     9    7     72-33     75
## 3     3     Monaco    38   20    11    7     51-26     71
## 4     4  Marseille    38   21     6   11     76-42     69
## 5     5 St Etienne    38   19    12    7     51-30     69
## 6     6   Bordeaux    38   17    12    9     47-44     63
</code></pre>

<pre><code class="r">str(df8_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;P S G&quot; &quot;Lyon&quot; &quot;Monaco&quot; &quot;Marseille&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 11 10 8 9 7 6 5 5 3 4 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 2 8 2 5 3 3 7 7 2 4 ...
##  $ Loss     : Factor w/ 13 levels &quot;11&quot;,&quot;14&quot;,&quot;15&quot;,..: 10 11 11 1 11 12 2 2 2 6 ...
##  $ Aggregate: chr  &quot;83-36&quot; &quot;72-33&quot; &quot;51-26&quot; &quot;76-42&quot; ...
##  $ Points   : num  83 75 71 69 69 63 56 56 50 49 ...
</code></pre>

<pre><code class="r">df8_fr[ ,c(3:6)] &lt;- apply(df8_fr[ ,c(3:6)], 2, as.numeric)

match(df7_fr$Teams, df8_fr$Teams)
</code></pre>

<pre><code>##  [1] NA  3  8  5  2  4  6 16 17 12 15  9 14 18  7 10 11 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df7_fr$Teams, df8_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Paris Saint Germain&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;P S G&quot;,&quot;Lyon&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.2631579 0.0000000 0.0000000 0.1000000 0.0000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                  Var1  Var2  Distance
## 1 Paris Saint Germain P S G 0.2631579
## 2              Monaco P S G 0.0000000
## 3               Lille P S G 0.0000000
## 4          St Etienne P S G 0.1000000
## 5                Lyon P S G 0.0000000
## 6           Marseille P S G 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.25))
</code></pre>

<pre><code>## [1] 87
</code></pre>

<pre><code class="r">levenshteinSim((df7_fr$Teams[df7_fr$Teams == &quot;Paris Saint Germain&quot;]), (df8_fr$Teams[(df8_fr$Teams == &quot;P S G&quot;)] ))
</code></pre>

<pre><code>## [1] 0.2631579
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.26)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.26, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Paris Saint Germain and P S G###
###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                   Var1   Var2  Distance
## 1  Paris Saint Germain  P S G 0.2631579
## 25                Lyon   Lyon 1.0000000
## 28             Lorient   Lyon 0.2857143
## 42              Monaco Monaco 1.0000000
## 55         Montpellier Monaco 0.2727273
## 58             Sochaux Monaco 0.2857143
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1        Var2  Distance
## 2                 Lyon        Lyon 1.0000000
## 4               Monaco      Monaco 1.0000000
## 10           Marseille   Marseille 1.0000000
## 13          St Etienne  St Etienne 1.0000000
## 18            Bordeaux    Bordeaux 1.0000000
## 25         Montpellier Montpellier 1.0000000
## 26               Lille       Lille 1.0000000
## 33              Rennes      Rennes 1.0000000
## 36            Guingamp    Guingamp 1.0000000
## 39                Nice        Nice 1.0000000
## 41              Bastia      Bastia 1.0000000
## 48              Nantes      Nantes 1.0000000
## 52               Reims       Reims 1.0000000
## 58             Lorient     Lorient 1.0000000
## 60            Toulouse    Toulouse 1.0000000
## 63               Evian       Evian 1.0000000
## 20             Sochaux    Bordeaux 0.5000000
## 32               Reims      Rennes 0.5000000
## 34              Nantes      Rennes 0.5000000
## 47              Rennes      Nantes 0.5000000
## 53              Rennes       Reims 0.5000000
## 66              Rennes        Lens 0.5000000
## 9                Lille   Marseille 0.4444444
## 27           Marseille       Lille 0.4444444
## 64             Lorient        Lens 0.4285714
## 17        Valenciennes  St Etienne 0.4166667
## 35        Valenciennes      Rennes 0.4166667
## 30                Nice       Lille 0.4000000
## 37               Lille        Nice 0.4000000
## 65               Reims        Lens 0.4000000
## 19             Lorient    Bordeaux 0.3750000
## 57            Bordeaux     Lorient 0.3750000
## 12         Montpellier   Marseille 0.3636364
## 23           Marseille Montpellier 0.3636364
## 11              Bastia   Marseille 0.3333333
## 38              Nantes        Nice 0.3333333
## 40           Marseille      Bastia 0.3333333
## 42              Nantes      Bastia 0.3333333
## 45              Nantes        Caen 0.3333333
## 46              Bastia      Nantes 0.3333333
## 50                Nice      Nantes 0.3333333
## 51        Valenciennes      Nantes 0.3333333
## 67              Nantes        Lens 0.3333333
## 14             Lorient  St Etienne 0.3000000
## 15              Rennes  St Etienne 0.3000000
## 16               Evian  St Etienne 0.3000000
## 31          St Etienne      Rennes 0.3000000
## 55          St Etienne     Lorient 0.3000000
## 61          St Etienne       Evian 0.3000000
## 3              Lorient        Lyon 0.2857143
## 6              Sochaux      Monaco 0.2857143
## 7              Ajaccio      Monaco 0.2857143
## 28             Lorient       Lille 0.2857143
## 43             Ajaccio      Bastia 0.2857143
## 44             Lorient        Caen 0.2857143
## 54               Lille     Lorient 0.2857143
## 56                Lyon     Lorient 0.2857143
## 59               Evian     Lorient 0.2857143
## 62             Lorient       Evian 0.2857143
## 5          Montpellier      Monaco 0.2727273
## 21              Monaco Montpellier 0.2727273
## 22               Lille Montpellier 0.2727273
## 24              Nantes Montpellier 0.2727273
## 29         Montpellier       Lille 0.2727273
## 49         Montpellier      Nantes 0.2727273
## 1  Paris Saint Germain       P S G 0.2631579
## 8  Paris Saint Germain   Marseille 0.2631579
</code></pre>

<pre><code class="r">#####Changing the names#####
df8_fr$Teams[df8_fr$Teams == &quot;P S G&quot;] &lt;- df7_fr$Teams[df7_fr$Teams == &quot;Paris Saint Germain&quot;]

###Checking match funtion after the correction
match(df7_fr$Teams, df8_fr$Teams)
</code></pre>

<pre><code>##  [1]  1  3  8  5  2  4  6 16 17 12 15  9 14 18  7 10 11 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2013-2014 in France Ligue: https://en.wikipedia.org/wiki/2013-14_Ligue_1##

#####Manipulating the upper case issue in imported data (data_FRL15)#####

#library(dplyr)

head(data_FRL16)
</code></pre>

<pre><code>##    N   Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA   &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1  P S G    38  30     6     2   102    19   15     3     1      59
## 3  2   LYON    38  19     8    11    67    43   12     4     3      42
## 4  3 MONACO    38  17    14     7    57    50   10     6     3      30
## 5  4   NICE    38  18     9    11    58    41   12     2     5      32
## 6  5  LILLE    38  15    15     8    39    27    9     6     4      21
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    12   15     3     1      43     7  96
## 3    16    7     4     8      25    27  65
## 4    19    7     8     4      27    31  65
## 5    16    6     7     6      26    25  63
## 6    11    6     9     4      18    16  60
</code></pre>

<pre><code class="r">data_FRL16 &lt;- data_FRL16[-1 , ]

####Converting teams names to lower case
data_FRL16$Team2 &lt;-  tolower(data_FRL16$Team)

####Converting the starting letter of the teams names to upper case 
data_FRL16$Team3 &lt;- sapply(data_FRL16$Team2, simpleCap)

data_FRL16$Team4 &lt;- as.factor(data_FRL16$Team3)

data_FRL16$Team5 &lt;-as.character(data_FRL16$Team4)
rownames(data_FRL16) &lt;- 1:nrow(data_FRL16)
head(data_FRL16)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  30     6     2   102    19   15     3     1      59
## 2 2       LYON    38  19     8    11    67    43   12     4     3      42
## 3 3     MONACO    38  17    14     7    57    50   10     6     3      30
## 4 4       NICE    38  18     9    11    58    41   12     2     5      32
## 5 5      LILLE    38  15    15     8    39    27    9     6     4      21
## 6 6 ST ETIENNE    38  17     7    14    42    37   10     4     5      25
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    12   15     3     1      43     7  96      p s g      P S G
## 2    16    7     4     8      25    27  65       lyon       Lyon
## 3    19    7     8     4      27    31  65     monaco     Monaco
## 4    16    6     7     6      26    25  63       nice       Nice
## 5    11    6     9     4      18    16  60      lille      Lille
## 6    15    7     3     9      17    22  58 st etienne St Etienne
##        Team4      Team5
## 1      P S G      P S G
## 2       Lyon       Lyon
## 3     Monaco     Monaco
## 4       Nice       Nice
## 5      Lille      Lille
## 6 St Etienne St Etienne
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_FRL16)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      P S G    38  30     6     2   102    19   15     3     1      59
## 2 2       LYON    38  19     8    11    67    43   12     4     3      42
## 3 3     MONACO    38  17    14     7    57    50   10     6     3      30
## 4 4       NICE    38  18     9    11    58    41   12     2     5      32
## 5 5      LILLE    38  15    15     8    39    27    9     6     4      21
## 6 6 ST ETIENNE    38  17     7    14    42    37   10     4     5      25
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    12   15     3     1      43     7  96      p s g      P S G
## 2    16    7     4     8      25    27  65       lyon       Lyon
## 3    19    7     8     4      27    31  65     monaco     Monaco
## 4    16    6     7     6      26    25  63       nice       Nice
## 5    11    6     9     4      18    16  60      lille      Lille
## 6    15    7     3     9      17    22  58 st etienne St Etienne
##        Team4      Team5
## 1      P S G      P S G
## 2       Lyon       Lyon
## 3     Monaco     Monaco
## 4       Nice       Nice
## 5      Lille      Lille
## 6 St Etienne St Etienne
</code></pre>

<pre><code class="r">names(data_FRL16)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df9_fr &lt;- data_FRL16[c(1, 23, 3:8, 19)]

str(df9_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;P S G&quot; &quot;Lyon&quot; &quot;Monaco&quot; &quot;Nice&quot; ...
##  $ Total: Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 12 10 8 9 6 8 7 4 4 5 ...
##  $ NA..1: Factor w/ 11 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 7 9 4 10 5 8 7 3 1 9 ...
##  $ NA..2: Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 2 10 2 11 4 5 3 4 5 ...
##  $ Goals: Factor w/ 19 levels &quot;102&quot;,&quot;28&quot;,&quot;33&quot;,..: 1 18 16 17 6 8 6 15 7 4 ...
##  $ NA..3: Factor w/ 18 levels &quot;19&quot;,&quot;27&quot;,&quot;37&quot;,..: 1 7 10 5 2 3 11 12 4 6 ...
##  $ Pts  : num  96 65 65 63 60 58 54 52 50 50 ...
</code></pre>

<pre><code class="r">head(df9_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1      P S G    38  30     6     2   102    19  96
## 2 2       Lyon    38  19     8    11    67    43  65
## 3 3     Monaco    38  17    14     7    57    50  65
## 4 4       Nice    38  18     9    11    58    41  63
## 5 5      Lille    38  15    15     8    39    27  60
## 6 6 St Etienne    38  17     7    14    42    37  58
</code></pre>

<pre><code class="r">#####Changing the names#####

df9_fr$Aggregate &lt;- paste(df9_fr$Goals, df9_fr$NA..3, sep = &quot;-&quot;)
head(df9_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1      P S G    38  30     6     2   102    19  96    102-19
## 2 2       Lyon    38  19     8    11    67    43  65     67-43
## 3 3     Monaco    38  17    14     7    57    50  65     57-50
## 4 4       Nice    38  18     9    11    58    41  63     58-41
## 5 5      Lille    38  15    15     8    39    27  60     39-27
## 6 6 St Etienne    38  17     7    14    42    37  58     42-37
</code></pre>

<pre><code class="r">df9_fr &lt;- df9_fr[ ,c(1:6, 10, 9)]
head(df9_fr)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1      P S G    38  30     6     2    102-19  96
## 2 2       Lyon    38  19     8    11     67-43  65
## 3 3     Monaco    38  17    14     7     57-50  65
## 4 4       Nice    38  18     9    11     58-41  63
## 5 5      Lille    38  15    15     8     39-27  60
## 6 6 St Etienne    38  17     7    14     42-37  58
</code></pre>

<pre><code class="r">names(df9_fr) &lt;- names(data_9)
head(df9_fr)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1      P S G    38   30     6    2    102-19     96
## 2     2       Lyon    38   19     8   11     67-43     65
## 3     3     Monaco    38   17    14    7     57-50     65
## 4     4       Nice    38   18     9   11     58-41     63
## 5     5      Lille    38   15    15    8     39-27     60
## 6     6 St Etienne    38   17     7   14     42-37     58
</code></pre>

<pre><code class="r">str(df9_fr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    20 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;P S G&quot; &quot;Lyon&quot; &quot;Monaco&quot; &quot;Nice&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;38&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 12 10 8 9 6 8 7 4 4 5 ...
##  $ Draws    : Factor w/ 11 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 7 9 4 10 5 8 7 3 1 9 ...
##  $ Loss     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 2 10 2 11 4 5 3 4 5 ...
##  $ Aggregate: chr  &quot;102-19&quot; &quot;67-43&quot; &quot;57-50&quot; &quot;58-41&quot; ...
##  $ Points   : num  96 65 65 63 60 58 54 52 50 50 ...
</code></pre>

<pre><code class="r">df9_fr[ ,c(3:6)] &lt;- apply(df9_fr[ ,c(3:6)], 2, as.numeric)

match(df8_fr$Teams, df9_fr$Teams)
</code></pre>

<pre><code>##  [1] NA  2  3 13  6 11 12  5  8 16  4 10  7 14 18 15 17 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df8_fr$Teams, df9_fr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    400 obs. of  2 variables:
##  $ Var1: Factor w/ 20 levels &quot;Paris Saint Germain&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 20 levels &quot;P S G&quot;,&quot;Lyon&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.2631579 0.0000000 0.0000000 0.0000000 0.1000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##                  Var1  Var2  Distance
## 1 Paris Saint Germain P S G 0.2631579
## 2                Lyon P S G 0.0000000
## 3              Monaco P S G 0.0000000
## 4           Marseille P S G 0.0000000
## 5          St Etienne P S G 0.1000000
## 6            Bordeaux P S G 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.25))
</code></pre>

<pre><code>## [1] 82
</code></pre>

<pre><code class="r">levenshteinSim((df8_fr$Teams[df8_fr$Teams == &quot;Paris Saint Germain&quot;]), (df9_fr$Teams[(df9_fr$Teams == &quot;P S G&quot;)] ))
</code></pre>

<pre><code>## [1] 0.2631579
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.26)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.26, drop = TRUE)

###As we observe the names of the teams which have to change due to taxonomy are###
###Paris Saint Germain and P S G###
###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                   Var1   Var2  Distance
## 1  Paris Saint Germain  P S G 0.2631579
## 22                Lyon   Lyon 1.0000000
## 36             Lorient   Lyon 0.2857143
## 43              Monaco Monaco 1.0000000
## 47         Montpellier Monaco 0.2727273
## 68               Lille   Nice 0.4000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                   Var1        Var2  Distance
## 2                 Lyon        Lyon 1.0000000
## 4               Monaco      Monaco 1.0000000
## 7                 Nice        Nice 1.0000000
## 11               Lille       Lille 1.0000000
## 14          St Etienne  St Etienne 1.0000000
## 18                Caen        Caen 1.0000000
## 22              Rennes      Rennes 1.0000000
## 30              Bastia      Bastia 1.0000000
## 32            Bordeaux    Bordeaux 1.0000000
## 36         Montpellier Montpellier 1.0000000
## 40           Marseille   Marseille 1.0000000
## 49              Nantes      Nantes 1.0000000
## 56             Lorient     Lorient 1.0000000
## 59            Guingamp    Guingamp 1.0000000
## 60            Toulouse    Toulouse 1.0000000
## 62               Reims       Reims 1.0000000
## 23              Nantes      Rennes 0.5000000
## 24               Reims      Rennes 0.5000000
## 25                Lens      Rennes 0.5000000
## 45              Rennes      Nantes 0.5000000
## 61              Rennes       Reims 0.5000000
## 9            Marseille       Lille 0.4444444
## 42               Lille   Marseille 0.4444444
## 58                Lens     Lorient 0.4285714
## 6                Lille        Nice 0.4000000
## 12                Nice       Lille 0.4000000
## 63                Lens       Reims 0.4000000
## 33             Lorient    Bordeaux 0.3750000
## 53            Bordeaux     Lorient 0.3750000
## 35           Marseille Montpellier 0.3636364
## 41         Montpellier   Marseille 0.3636364
## 8               Nantes        Nice 0.3333333
## 19              Nantes        Caen 0.3333333
## 26              Rennes      Angers 0.3333333
## 27              Nantes      Angers 0.3333333
## 28                Lens      Angers 0.3333333
## 29           Marseille      Bastia 0.3333333
## 31              Nantes      Bastia 0.3333333
## 43              Bastia   Marseille 0.3333333
## 46                Nice      Nantes 0.3333333
## 47              Bastia      Nantes 0.3333333
## 48                Caen      Nantes 0.3333333
## 50                Lens      Nantes 0.3333333
## 15              Rennes  St Etienne 0.3000000
## 16             Lorient  St Etienne 0.3000000
## 17               Evian  St Etienne 0.3000000
## 21          St Etienne      Rennes 0.3000000
## 52          St Etienne     Lorient 0.3000000
## 3              Lorient        Lyon 0.2857143
## 13             Lorient       Lille 0.2857143
## 20             Lorient        Caen 0.2857143
## 51                Lyon     Lorient 0.2857143
## 54               Lille     Lorient 0.2857143
## 55                Caen     Lorient 0.2857143
## 57               Evian     Lorient 0.2857143
## 5          Montpellier      Monaco 0.2727273
## 10         Montpellier       Lille 0.2727273
## 34              Monaco Montpellier 0.2727273
## 37               Lille Montpellier 0.2727273
## 38              Nantes Montpellier 0.2727273
## 44         Montpellier      Nantes 0.2727273
## 64              Monaco Gfc Ajaccio 0.2727273
## 1  Paris Saint Germain       P S G 0.2631579
## 39 Paris Saint Germain   Marseille 0.2631579
</code></pre>

<pre><code class="r">#####Changing the names#####
df9_fr$Teams[df9_fr$Teams == &quot;P S G&quot;] &lt;- df8_fr$Teams[df8_fr$Teams == &quot;Paris Saint Germain&quot;]

###Checking match funtion after the correction
match(df8_fr$Teams, df9_fr$Teams)
</code></pre>

<pre><code>##  [1]  1  2  3 13  6 11 12  5  8 16  4 10  7 14 18 15 17 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2014-2015 in France Ligue: https://en.wikipedia.org/wiki/2014-15_Ligue_1##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_NTL09)#####
####NTL09 = Netherlands League season 2008-2009####

library(dplyr)

head(data_NTL09)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1 AZ ALKMAAR    34  25     5     4    66    22   14     1     2      38
## 3  2     TWENTE    34  20     9     5    62    31   12     4     1      40
## 4  3       AJAX    34  21     5     8    74    41   13     3     1      41
## 5  4        PSV    34  19     8     7    71    33   11     4     2      41
## 6  5 HEERENVEEN    34  17     9     8    66    57   11     5     1      41
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2     7   11     4     2      28    15  80
## 3    13    8     5     4      22    18  69
## 4     9    8     2     7      33    32  68
## 5    15    8     4     5      30    18  65
## 6    22    6     4     7      25    35  60
</code></pre>

<pre><code class="r">data_NTL09 &lt;- data_NTL09[-1 , ]

####Converting teams names to lower case
data_NTL09$Team2 &lt;-  tolower(data_NTL09$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL09$Team3 &lt;- sapply(data_NTL09$Team2, simpleCap)

data_NTL09$Team4 &lt;- as.factor(data_NTL09$Team3)

data_NTL09$Team5 &lt;-as.character(data_NTL09$Team4)
rownames(data_NTL09) &lt;- 1:nrow(data_NTL09)
head(data_NTL09)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 AZ ALKMAAR    34  25     5     4    66    22   14     1     2      38
## 2 2     TWENTE    34  20     9     5    62    31   12     4     1      40
## 3 3       AJAX    34  21     5     8    74    41   13     3     1      41
## 4 4        PSV    34  19     8     7    71    33   11     4     2      41
## 5 5 HEERENVEEN    34  17     9     8    66    57   11     5     1      41
## 6 6  GRONINGEN    34  17     5    12    53    36   11     1     5      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     7   11     4     2      28    15  80 az alkmaar Az Alkmaar
## 2    13    8     5     4      22    18  69     twente     Twente
## 3     9    8     2     7      33    32  68       ajax       Ajax
## 4    15    8     4     5      30    18  65        psv        Psv
## 5    22    6     4     7      25    35  60 heerenveen Heerenveen
## 6    14    6     4     7      21    22  56  groningen  Groningen
##        Team4      Team5
## 1 Az Alkmaar Az Alkmaar
## 2     Twente     Twente
## 3       Ajax       Ajax
## 4        Psv        Psv
## 5 Heerenveen Heerenveen
## 6  Groningen  Groningen
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL09)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1 AZ ALKMAAR    34  25     5     4    66    22   14     1     2      38
## 2 2     TWENTE    34  20     9     5    62    31   12     4     1      40
## 3 3       AJAX    34  21     5     8    74    41   13     3     1      41
## 4 4        PSV    34  19     8     7    71    33   11     4     2      41
## 5 5 HEERENVEEN    34  17     9     8    66    57   11     5     1      41
## 6 6  GRONINGEN    34  17     5    12    53    36   11     1     5      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     7   11     4     2      28    15  80 az alkmaar Az Alkmaar
## 2    13    8     5     4      22    18  69     twente     Twente
## 3     9    8     2     7      33    32  68       ajax       Ajax
## 4    15    8     4     5      30    18  65        psv        Psv
## 5    22    6     4     7      25    35  60 heerenveen Heerenveen
## 6    14    6     4     7      21    22  56  groningen  Groningen
##        Team4      Team5
## 1 Az Alkmaar Az Alkmaar
## 2     Twente     Twente
## 3       Ajax       Ajax
## 4        Psv        Psv
## 5 Heerenveen Heerenveen
## 6  Groningen  Groningen
</code></pre>

<pre><code class="r">names(data_NTL09)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df_nt &lt;- data_NTL09[c(1, 23, 3:8, 19)]

str(df_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Az Alkmaar&quot; &quot;Twente&quot; &quot;Ajax&quot; &quot;Psv&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 7 8 6 5 5 3 4 2 2 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;15&quot;,..: 4 8 4 7 8 4 8 5 2 1 ...
##  $ NA..2: Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 10 12 11 12 2 3 4 2 3 ...
##  $ Goals: Factor w/ 13 levels &quot;24&quot;,&quot;35&quot;,&quot;38&quot;,..: 10 9 12 11 10 7 8 5 4 4 ...
##  $ NA..3: Factor w/ 16 levels &quot;22&quot;,&quot;31&quot;,&quot;33&quot;,..: 1 2 6 3 12 4 8 11 7 9 ...
##  $ Pts  : num  80 69 68 65 60 56 45 45 44 43 ...
</code></pre>

<pre><code class="r">head(df_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Az Alkmaar    34  25     5     4    66    22  80
## 2 2     Twente    34  20     9     5    62    31  69
## 3 3       Ajax    34  21     5     8    74    41  68
## 4 4        Psv    34  19     8     7    71    33  65
## 5 5 Heerenveen    34  17     9     8    66    57  60
## 6 6  Groningen    34  17     5    12    53    36  56
</code></pre>

<pre><code class="r">#####Changing the names#####

df_nt$Aggregate &lt;- paste(df_nt$Goals, df_nt$NA..3, sep = &quot;-&quot;)
head(df_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Az Alkmaar    34  25     5     4    66    22  80     66-22
## 2 2     Twente    34  20     9     5    62    31  69     62-31
## 3 3       Ajax    34  21     5     8    74    41  68     74-41
## 4 4        Psv    34  19     8     7    71    33  65     71-33
## 5 5 Heerenveen    34  17     9     8    66    57  60     66-57
## 6 6  Groningen    34  17     5    12    53    36  56     53-36
</code></pre>

<pre><code class="r">df_nt &lt;- df_nt[ ,c(1:6, 10, 9)]
head(df_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Az Alkmaar    34  25     5     4     66-22  80
## 2 2     Twente    34  20     9     5     62-31  69
## 3 3       Ajax    34  21     5     8     74-41  68
## 4 4        Psv    34  19     8     7     71-33  65
## 5 5 Heerenveen    34  17     9     8     66-57  60
## 6 6  Groningen    34  17     5    12     53-36  56
</code></pre>

<pre><code class="r">names(df_nt) &lt;- names(data_9)
head(df_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1 Az Alkmaar    34   25     5    4     66-22     80
## 2     2     Twente    34   20     9    5     62-31     69
## 3     3       Ajax    34   21     5    8     74-41     68
## 4     4        Psv    34   19     8    7     71-33     65
## 5     5 Heerenveen    34   17     9    8     66-57     60
## 6     6  Groningen    34   17     5   12     53-36     56
</code></pre>

<pre><code class="r">str(df_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Az Alkmaar&quot; &quot;Twente&quot; &quot;Ajax&quot; &quot;Psv&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 7 8 6 5 5 3 4 2 2 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;15&quot;,..: 4 8 4 7 8 4 8 5 2 1 ...
##  $ Loss     : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 10 12 11 12 2 3 4 2 3 ...
##  $ Aggregate: chr  &quot;66-22&quot; &quot;62-31&quot; &quot;74-41&quot; &quot;71-33&quot; ...
##  $ Points   : num  80 69 68 65 60 56 45 45 44 43 ...
</code></pre>

<pre><code class="r">df_nt[ ,c(3:6)] &lt;- apply(df_nt[ ,c(3:6)], 2, as.numeric)


#####Manipulating the upper case issue in imported data (data_NTL10)#####

#library(dplyr)

head(data_NTL10)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1     TWENTE    34  27     5     2    63    23   16     1     0      37
## 3  2       AJAX    34  27     4     3   106    20   16     1     0      64
## 4  3        PSV    34  23     9     2    72    29   13     4     0      40
## 5  4  FEYENOORD    34  17    12     5    54    31    9     6     2      32
## 6  5 AZ ALKMAAR    34  19     5    10    64    34   11     2     4      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    10   11     4     2      26    13  86
## 3     4   11     3     3      42    16  85
## 4    13   10     5     2      32    16  78
## 5    14    8     6     3      22    17  63
## 6    16    8     3     6      31    18  62
</code></pre>

<pre><code class="r">data_NTL10 &lt;- data_NTL10[-1 , ]

####Converting teams names to lower case
data_NTL10$Team2 &lt;-  tolower(data_NTL10$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL10$Team3 &lt;- sapply(data_NTL10$Team2, simpleCap)

data_NTL10$Team4 &lt;- as.factor(data_NTL10$Team3)

data_NTL10$Team5 &lt;-as.character(data_NTL10$Team4)
rownames(data_NTL10) &lt;- 1:nrow(data_NTL10)
head(data_NTL10)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1     TWENTE    34  27     5     2    63    23   16     1     0      37
## 2 2       AJAX    34  27     4     3   106    20   16     1     0      64
## 3 3        PSV    34  23     9     2    72    29   13     4     0      40
## 4 4  FEYENOORD    34  17    12     5    54    31    9     6     2      32
## 5 5 AZ ALKMAAR    34  19     5    10    64    34   11     2     4      33
## 6 6   HERACLES    34  17     5    12    54    49   11     1     5      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    10   11     4     2      26    13  86     twente     Twente
## 2     4   11     3     3      42    16  85       ajax       Ajax
## 3    13   10     5     2      32    16  78        psv        Psv
## 4    14    8     6     3      22    17  63  feyenoord  Feyenoord
## 5    16    8     3     6      31    18  62 az alkmaar Az Alkmaar
## 6    25    6     4     7      18    24  56   heracles   Heracles
##        Team4      Team5
## 1     Twente     Twente
## 2       Ajax       Ajax
## 3        Psv        Psv
## 4  Feyenoord  Feyenoord
## 5 Az Alkmaar Az Alkmaar
## 6   Heracles   Heracles
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL10)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1     TWENTE    34  27     5     2    63    23   16     1     0      37
## 2 2       AJAX    34  27     4     3   106    20   16     1     0      64
## 3 3        PSV    34  23     9     2    72    29   13     4     0      40
## 4 4  FEYENOORD    34  17    12     5    54    31    9     6     2      32
## 5 5 AZ ALKMAAR    34  19     5    10    64    34   11     2     4      33
## 6 6   HERACLES    34  17     5    12    54    49   11     1     5      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    10   11     4     2      26    13  86     twente     Twente
## 2     4   11     3     3      42    16  85       ajax       Ajax
## 3    13   10     5     2      32    16  78        psv        Psv
## 4    14    8     6     3      22    17  63  feyenoord  Feyenoord
## 5    16    8     3     6      31    18  62 az alkmaar Az Alkmaar
## 6    25    6     4     7      18    24  56   heracles   Heracles
##        Team4      Team5
## 1     Twente     Twente
## 2       Ajax       Ajax
## 3        Psv        Psv
## 4  Feyenoord  Feyenoord
## 5 Az Alkmaar Az Alkmaar
## 6   Heracles   Heracles
</code></pre>

<pre><code class="r">names(data_NTL10)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df3_nt &lt;- data_NTL10[c(1, 23, 3:8, 19)]

str(df3_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Twente&quot; &quot;Ajax&quot; &quot;Psv&quot; &quot;Feyenoord&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 7 7 6 4 5 4 3 3 3 2 ...
##  $ NA..1: Factor w/ 11 levels &quot;0&quot;,&quot;10&quot;,&quot;11&quot;,..: 7 6 10 4 7 7 3 8 7 2 ...
##  $ NA..2: Factor w/ 15 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 12 8 13 1 2 14 3 4 2 ...
##  $ Goals: Factor w/ 16 levels &quot;106&quot;,&quot;30&quot;,&quot;35&quot;,..: 13 1 15 11 14 11 6 10 12 7 ...
##  $ NA..3: Factor w/ 17 levels &quot;20&quot;,&quot;23&quot;,&quot;29&quot;,..: 2 1 3 4 6 8 5 7 11 8 ...
##  $ Pts  : num  86 85 78 63 62 56 53 49 47 46 ...
</code></pre>

<pre><code class="r">head(df3_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1     Twente    34  27     5     2    63    23  86
## 2 2       Ajax    34  27     4     3   106    20  85
## 3 3        Psv    34  23     9     2    72    29  78
## 4 4  Feyenoord    34  17    12     5    54    31  63
## 5 5 Az Alkmaar    34  19     5    10    64    34  62
## 6 6   Heracles    34  17     5    12    54    49  56
</code></pre>

<pre><code class="r">#####Changing the names#####

df3_nt$Aggregate &lt;- paste(df3_nt$Goals, df3_nt$NA..3, sep = &quot;-&quot;)
head(df3_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1     Twente    34  27     5     2    63    23  86     63-23
## 2 2       Ajax    34  27     4     3   106    20  85    106-20
## 3 3        Psv    34  23     9     2    72    29  78     72-29
## 4 4  Feyenoord    34  17    12     5    54    31  63     54-31
## 5 5 Az Alkmaar    34  19     5    10    64    34  62     64-34
## 6 6   Heracles    34  17     5    12    54    49  56     54-49
</code></pre>

<pre><code class="r">df3_nt &lt;- df3_nt[ ,c(1:6, 10, 9)]
head(df3_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1     Twente    34  27     5     2     63-23  86
## 2 2       Ajax    34  27     4     3    106-20  85
## 3 3        Psv    34  23     9     2     72-29  78
## 4 4  Feyenoord    34  17    12     5     54-31  63
## 5 5 Az Alkmaar    34  19     5    10     64-34  62
## 6 6   Heracles    34  17     5    12     54-49  56
</code></pre>

<pre><code class="r">names(df3_nt) &lt;- names(data_9)
head(df3_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1     Twente    34   27     5    2     63-23     86
## 2     2       Ajax    34   27     4    3    106-20     85
## 3     3        Psv    34   23     9    2     72-29     78
## 4     4  Feyenoord    34   17    12    5     54-31     63
## 5     5 Az Alkmaar    34   19     5   10     64-34     62
## 6     6   Heracles    34   17     5   12     54-49     56
</code></pre>

<pre><code class="r">str(df3_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Twente&quot; &quot;Ajax&quot; &quot;Psv&quot; &quot;Feyenoord&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 7 7 6 4 5 4 3 3 3 2 ...
##  $ Draws    : Factor w/ 11 levels &quot;0&quot;,&quot;10&quot;,&quot;11&quot;,..: 7 6 10 4 7 7 3 8 7 2 ...
##  $ Loss     : Factor w/ 15 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 12 8 13 1 2 14 3 4 2 ...
##  $ Aggregate: chr  &quot;63-23&quot; &quot;106-20&quot; &quot;72-29&quot; &quot;54-31&quot; ...
##  $ Points   : num  86 85 78 63 62 56 53 49 47 46 ...
</code></pre>

<pre><code class="r">df3_nt[ ,c(3:6)] &lt;- apply(df3_nt[ ,c(3:6)], 2, as.numeric)

match(df_nt$Teams, df3_nt$Teams)
</code></pre>

<pre><code>##  [1]  5  1  2  3 11  8  4 10  7 14 13 17 16 15  6  9 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df_nt$Teams, df3_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Az Alkmaar&quot;,&quot;Twente&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Twente&quot;,&quot;Ajax&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.0 1.0 0.0 0.0 0.3
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1   Var2  Distance
## 1 Az Alkmaar Twente 0.0000000
## 2     Twente Twente 1.0000000
## 3       Ajax Twente 0.0000000
## 4        Psv Twente 0.0000000
## 5 Heerenveen Twente 0.3000000
## 6  Groningen Twente 0.2222222
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1       Var2 Distance
## 2       Twente     Twente        1
## 21        Ajax       Ajax        1
## 40         Psv        Psv        1
## 61   Feyenoord  Feyenoord        1
## 73  Az Alkmaar Az Alkmaar        1
## 105   Heracles   Heracles        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2 Distance
## 1            Twente           Twente        1
## 2              Ajax             Ajax        1
## 3               Psv              Psv        1
## 4         Feyenoord        Feyenoord        1
## 5        Az Alkmaar       Az Alkmaar        1
## 6          Heracles         Heracles        1
## 7           Utrecht          Utrecht        1
## 8         Groningen        Groningen        1
## 9              Roda             Roda        1
## 10        Nac Breda        Nac Breda        1
## 11       Heerenveen       Heerenveen        1
## 12     Nec Nijmegen     Nec Nijmegen        1
## 13          Vitesse          Vitesse        1
## 14     Ado Den Haag     Ado Den Haag        1
## 15 Sparta Rotterdam Sparta Rotterdam        1
## 16        Willem Ii        Willem Ii        1
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
#match(df2_it$Teams, df3_nt$Teams)

###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2008-2009 in Netherlands League: https://en.wikipedia.org/wiki/2008-09_Eredivisie##
###To be true, six seasons in Netherlands league have been relegated two teams (thesis, Table 3: Values of N, K, and I in European football leagues from 2008 - 2016 (8 seasons))

#####Manipulating the upper case issue in imported data (data_NTL11)#####

#library(dplyr)

head(data_NTL11)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1       AJAX    34  22     7     5    72    30   13     2     2      38
## 3  2     TWENTE    34  21     8     5    65    34   12     4     1      38
## 4  3        PSV    34  20     9     5    79    34   12     3     2      49
## 5  4 AZ ALKMAAR    34  17     8     9    55    44   10     5     2      37
## 6  5  GRONINGEN    34  17     6    11    65    52   12     2     3      37
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2     9    9     5     3      34    21  73
## 3    13    9     4     4      27    21  71
## 4    15    8     6     3      30    19  69
## 5    20    7     3     7      18    24  59
## 6    20    5     4     8      28    32  57
</code></pre>

<pre><code class="r">data_NTL11 &lt;- data_NTL11[-1 , ]

####Converting teams names to lower case
data_NTL11$Team2 &lt;-  tolower(data_NTL11$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL11$Team3 &lt;- sapply(data_NTL11$Team2, simpleCap)

data_NTL11$Team4 &lt;- as.factor(data_NTL11$Team3)

data_NTL11$Team5 &lt;-as.character(data_NTL11$Team4)
rownames(data_NTL11) &lt;- 1:nrow(data_NTL11)
head(data_NTL11)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1       AJAX    34  22     7     5    72    30   13     2     2      38
## 2 2     TWENTE    34  21     8     5    65    34   12     4     1      38
## 3 3        PSV    34  20     9     5    79    34   12     3     2      49
## 4 4 AZ ALKMAAR    34  17     8     9    55    44   10     5     2      37
## 5 5  GRONINGEN    34  17     6    11    65    52   12     2     3      37
## 6 6       RODA    34  14    13     7    65    50    7     9     1      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     9    9     5     3      34    21  73       ajax       Ajax
## 2    13    9     4     4      27    21  71     twente     Twente
## 3    15    8     6     3      30    19  69        psv        Psv
## 4    20    7     3     7      18    24  59 az alkmaar Az Alkmaar
## 5    20    5     4     8      28    32  57  groningen  Groningen
## 6    16    7     4     6      31    34  55       roda       Roda
##        Team4      Team5
## 1       Ajax       Ajax
## 2     Twente     Twente
## 3        Psv        Psv
## 4 Az Alkmaar Az Alkmaar
## 5  Groningen  Groningen
## 6       Roda       Roda
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL11)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1       AJAX    34  22     7     5    72    30   13     2     2      38
## 2 2     TWENTE    34  21     8     5    65    34   12     4     1      38
## 3 3        PSV    34  20     9     5    79    34   12     3     2      49
## 4 4 AZ ALKMAAR    34  17     8     9    55    44   10     5     2      37
## 5 5  GRONINGEN    34  17     6    11    65    52   12     2     3      37
## 6 6       RODA    34  14    13     7    65    50    7     9     1      34
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     9    9     5     3      34    21  73       ajax       Ajax
## 2    13    9     4     4      27    21  71     twente     Twente
## 3    15    8     6     3      30    19  69        psv        Psv
## 4    20    7     3     7      18    24  59 az alkmaar Az Alkmaar
## 5    20    5     4     8      28    32  57  groningen  Groningen
## 6    16    7     4     6      31    34  55       roda       Roda
##        Team4      Team5
## 1       Ajax       Ajax
## 2     Twente     Twente
## 3        Psv        Psv
## 4 Az Alkmaar Az Alkmaar
## 5  Groningen  Groningen
## 6       Roda       Roda
</code></pre>

<pre><code class="r">names(data_NTL11)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df4_nt &lt;- data_NTL11[c(1, 23, 3:8, 19)]

str(df4_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Ajax&quot; &quot;Twente&quot; &quot;Psv&quot; &quot;Az Alkmaar&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 6 6 4 5 4 3 2 ...
##  $ NA..1: Factor w/ 9 levels &quot;11&quot;,&quot;13&quot;,&quot;3&quot;,..: 6 7 8 7 5 2 5 6 7 7 ...
##  $ NA..2: Factor w/ 11 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 8 8 10 1 9 2 3 3 4 ...
##  $ Goals: Factor w/ 15 levels &quot;31&quot;,&quot;34&quot;,&quot;37&quot;,..: 13 12 14 8 12 12 11 12 8 7 ...
##  $ NA..3: Factor w/ 15 levels &quot;30&quot;,&quot;34&quot;,&quot;44&quot;,..: 1 2 2 3 6 4 8 9 5 7 ...
##  $ Pts  : num  73 71 69 59 57 55 54 49 47 44 ...
</code></pre>

<pre><code class="r">head(df4_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1       Ajax    34  22     7     5    72    30  73
## 2 2     Twente    34  21     8     5    65    34  71
## 3 3        Psv    34  20     9     5    79    34  69
## 4 4 Az Alkmaar    34  17     8     9    55    44  59
## 5 5  Groningen    34  17     6    11    65    52  57
## 6 6       Roda    34  14    13     7    65    50  55
</code></pre>

<pre><code class="r">#####Changing the names#####

df4_nt$Aggregate &lt;- paste(df4_nt$Goals, df4_nt$NA..3, sep = &quot;-&quot;)
head(df4_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1       Ajax    34  22     7     5    72    30  73     72-30
## 2 2     Twente    34  21     8     5    65    34  71     65-34
## 3 3        Psv    34  20     9     5    79    34  69     79-34
## 4 4 Az Alkmaar    34  17     8     9    55    44  59     55-44
## 5 5  Groningen    34  17     6    11    65    52  57     65-52
## 6 6       Roda    34  14    13     7    65    50  55     65-50
</code></pre>

<pre><code class="r">df4_nt &lt;- df4_nt[ ,c(1:6, 10, 9)]
head(df4_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1       Ajax    34  22     7     5     72-30  73
## 2 2     Twente    34  21     8     5     65-34  71
## 3 3        Psv    34  20     9     5     79-34  69
## 4 4 Az Alkmaar    34  17     8     9     55-44  59
## 5 5  Groningen    34  17     6    11     65-52  57
## 6 6       Roda    34  14    13     7     65-50  55
</code></pre>

<pre><code class="r">names(df4_nt) &lt;- names(data_9)
head(df4_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1       Ajax    34   22     7    5     72-30     73
## 2     2     Twente    34   21     8    5     65-34     71
## 3     3        Psv    34   20     9    5     79-34     69
## 4     4 Az Alkmaar    34   17     8    9     55-44     59
## 5     5  Groningen    34   17     6   11     65-52     57
## 6     6       Roda    34   14    13    7     65-50     55
</code></pre>

<pre><code class="r">str(df4_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Ajax&quot; &quot;Twente&quot; &quot;Psv&quot; &quot;Az Alkmaar&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 6 6 4 5 4 3 2 ...
##  $ Draws    : Factor w/ 9 levels &quot;11&quot;,&quot;13&quot;,&quot;3&quot;,..: 6 7 8 7 5 2 5 6 7 7 ...
##  $ Loss     : Factor w/ 11 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 8 8 10 1 9 2 3 3 4 ...
##  $ Aggregate: chr  &quot;72-30&quot; &quot;65-34&quot; &quot;79-34&quot; &quot;55-44&quot; ...
##  $ Points   : num  73 71 69 59 57 55 54 49 47 44 ...
</code></pre>

<pre><code class="r">df4_nt[ ,c(3:6)] &lt;- apply(df4_nt[ ,c(3:6)], 2, as.numeric)

match(df3_nt$Teams, df4_nt$Teams)
</code></pre>

<pre><code>##  [1]  2  1  3 10  4  8  9  5  6 13 12 17 11 15  7 NA 18 NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df3_nt$Teams, df4_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Twente&quot;,&quot;Ajax&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Twente&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.0 1.0 0.0 0.0 0.2
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1 Var2 Distance
## 1     Twente Ajax    0.000
## 2       Ajax Ajax    1.000
## 3        Psv Ajax    0.000
## 4  Feyenoord Ajax    0.000
## 5 Az Alkmaar Ajax    0.200
## 6   Heracles Ajax    0.125
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##          Var1       Var2 Distance
## 2        Ajax       Ajax        1
## 19     Twente     Twente        1
## 39        Psv        Psv        1
## 59 Az Alkmaar Az Alkmaar        1
## 80  Groningen  Groningen        1
## 99       Roda       Roda        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##            Var1         Var2 Distance
## 1          Ajax         Ajax        1
## 2        Twente       Twente        1
## 3           Psv          Psv        1
## 4    Az Alkmaar   Az Alkmaar        1
## 5     Groningen    Groningen        1
## 6          Roda         Roda        1
## 7  Ado Den Haag Ado Den Haag        1
## 8      Heracles     Heracles        1
## 9       Utrecht      Utrecht        1
## 10    Feyenoord    Feyenoord        1
## 11 Nec Nijmegen Nec Nijmegen        1
## 12   Heerenveen   Heerenveen        1
## 13    Nac Breda    Nac Breda        1
## 14      Vitesse      Vitesse        1
## 15    Vvv Venlo    Vvv Venlo        1
## 16    Willem Ii    Willem Ii        1
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
#match(df3_it$Teams, df4_nt$Teams)

###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2009-2010 in Netherlands League: https://en.wikipedia.org/wiki/2009-10_Eredivisie##

#####Manipulating the upper case issue in imported data (data_NTL12)#####

#library(dplyr)

head(data_NTL12)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1       AJAX    34  23     7     4    93    36   12     4     1      49
## 3  2  FEYENOORD    34  21     7     6    70    37   12     3     2      39
## 4  3        PSV    34  21     6     7    87    47   15     1     1      57
## 5  4 AZ ALKMAAR    34  19     8     7    64    35   13     4     0      38
## 6  5 HEERENVEEN    34  18    10     6    79    59    8     5     4      37
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    14   11     3     3      44    22  76
## 3    15    9     4     4      31    22  70
## 4    20    6     5     6      30    27  69
## 5    10    6     4     7      26    25  65
## 6    31   10     5     2      42    28  64
</code></pre>

<pre><code class="r">data_NTL12 &lt;- data_NTL12[-1 , ]

####Converting teams names to lower case
data_NTL12$Team2 &lt;-  tolower(data_NTL12$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL12$Team3 &lt;- sapply(data_NTL12$Team2, simpleCap)

data_NTL12$Team4 &lt;- as.factor(data_NTL12$Team3)

data_NTL12$Team5 &lt;-as.character(data_NTL12$Team4)
rownames(data_NTL12) &lt;- 1:nrow(data_NTL12)
head(data_NTL12)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1       AJAX    34  23     7     4    93    36   12     4     1      49
## 2 2  FEYENOORD    34  21     7     6    70    37   12     3     2      39
## 3 3        PSV    34  21     6     7    87    47   15     1     1      57
## 4 4 AZ ALKMAAR    34  19     8     7    64    35   13     4     0      38
## 5 5 HEERENVEEN    34  18    10     6    79    59    8     5     4      37
## 6 6     TWENTE    34  17     9     8    82    46    9     4     4      41
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    14   11     3     3      44    22  76       ajax       Ajax
## 2    15    9     4     4      31    22  70  feyenoord  Feyenoord
## 3    20    6     5     6      30    27  69        psv        Psv
## 4    10    6     4     7      26    25  65 az alkmaar Az Alkmaar
## 5    31   10     5     2      42    28  64 heerenveen Heerenveen
## 6    21    8     5     4      41    25  60     twente     Twente
##        Team4      Team5
## 1       Ajax       Ajax
## 2  Feyenoord  Feyenoord
## 3        Psv        Psv
## 4 Az Alkmaar Az Alkmaar
## 5 Heerenveen Heerenveen
## 6     Twente     Twente
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL12)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1       AJAX    34  23     7     4    93    36   12     4     1      49
## 2 2  FEYENOORD    34  21     7     6    70    37   12     3     2      39
## 3 3        PSV    34  21     6     7    87    47   15     1     1      57
## 4 4 AZ ALKMAAR    34  19     8     7    64    35   13     4     0      38
## 5 5 HEERENVEEN    34  18    10     6    79    59    8     5     4      37
## 6 6     TWENTE    34  17     9     8    82    46    9     4     4      41
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    14   11     3     3      44    22  76       ajax       Ajax
## 2    15    9     4     4      31    22  70  feyenoord  Feyenoord
## 3    20    6     5     6      30    27  69        psv        Psv
## 4    10    6     4     7      26    25  65 az alkmaar Az Alkmaar
## 5    31   10     5     2      42    28  64 heerenveen Heerenveen
## 6    21    8     5     4      41    25  60     twente     Twente
##        Team4      Team5
## 1       Ajax       Ajax
## 2  Feyenoord  Feyenoord
## 3        Psv        Psv
## 4 Az Alkmaar Az Alkmaar
## 5 Heerenveen Heerenveen
## 6     Twente     Twente
</code></pre>

<pre><code class="r">names(data_NTL12)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df5_nt &lt;- data_NTL12[c(1, 23, 3:8, 19)]

str(df5_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Ajax&quot; &quot;Feyenoord&quot; &quot;Psv&quot; &quot;Az Alkmaar&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 9 9 8 7 6 5 3 3 4 ...
##  $ NA..1: Factor w/ 8 levels &quot;10&quot;,&quot;2&quot;,&quot;4&quot;,&quot;6&quot;,..: 5 5 4 6 1 7 6 4 4 2 ...
##  $ NA..2: Factor w/ 14 levels &quot;11&quot;,&quot;13&quot;,&quot;15&quot;,..: 10 11 12 12 11 13 1 3 3 6 ...
##  $ Goals: Factor w/ 17 levels &quot;28&quot;,&quot;36&quot;,&quot;38&quot;,..: 16 12 15 11 13 14 8 6 4 10 ...
##  $ NA..3: Factor w/ 19 levels &quot;35&quot;,&quot;36&quot;,&quot;37&quot;,..: 2 3 7 1 11 6 4 5 8 15 ...
##  $ Pts  : num  76 70 69 65 64 60 53 45 45 44 ...
</code></pre>

<pre><code class="r">head(df5_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1       Ajax    34  23     7     4    93    36  76
## 2 2  Feyenoord    34  21     7     6    70    37  70
## 3 3        Psv    34  21     6     7    87    47  69
## 4 4 Az Alkmaar    34  19     8     7    64    35  65
## 5 5 Heerenveen    34  18    10     6    79    59  64
## 6 6     Twente    34  17     9     8    82    46  60
</code></pre>

<pre><code class="r">#####Changing the names#####

df5_nt$Aggregate &lt;- paste(df5_nt$Goals, df5_nt$NA..3, sep = &quot;-&quot;)
head(df5_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1       Ajax    34  23     7     4    93    36  76     93-36
## 2 2  Feyenoord    34  21     7     6    70    37  70     70-37
## 3 3        Psv    34  21     6     7    87    47  69     87-47
## 4 4 Az Alkmaar    34  19     8     7    64    35  65     64-35
## 5 5 Heerenveen    34  18    10     6    79    59  64     79-59
## 6 6     Twente    34  17     9     8    82    46  60     82-46
</code></pre>

<pre><code class="r">df5_nt &lt;- df5_nt[ ,c(1:6, 10, 9)]
head(df5_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1       Ajax    34  23     7     4     93-36  76
## 2 2  Feyenoord    34  21     7     6     70-37  70
## 3 3        Psv    34  21     6     7     87-47  69
## 4 4 Az Alkmaar    34  19     8     7     64-35  65
## 5 5 Heerenveen    34  18    10     6     79-59  64
## 6 6     Twente    34  17     9     8     82-46  60
</code></pre>

<pre><code class="r">names(df5_nt) &lt;- names(data_9)
head(df5_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1       Ajax    34   23     7    4     93-36     76
## 2     2  Feyenoord    34   21     7    6     70-37     70
## 3     3        Psv    34   21     6    7     87-47     69
## 4     4 Az Alkmaar    34   19     8    7     64-35     65
## 5     5 Heerenveen    34   18    10    6     79-59     64
## 6     6     Twente    34   17     9    8     82-46     60
</code></pre>

<pre><code class="r">str(df5_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Ajax&quot; &quot;Feyenoord&quot; &quot;Psv&quot; &quot;Az Alkmaar&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 9 9 8 7 6 5 3 3 4 ...
##  $ Draws    : Factor w/ 8 levels &quot;10&quot;,&quot;2&quot;,&quot;4&quot;,&quot;6&quot;,..: 5 5 4 6 1 7 6 4 4 2 ...
##  $ Loss     : Factor w/ 14 levels &quot;11&quot;,&quot;13&quot;,&quot;15&quot;,..: 10 11 12 12 11 13 1 3 3 6 ...
##  $ Aggregate: chr  &quot;93-36&quot; &quot;70-37&quot; &quot;87-47&quot; &quot;64-35&quot; ...
##  $ Points   : num  76 70 69 65 64 60 53 45 45 44 ...
</code></pre>

<pre><code class="r">df5_nt[ ,c(3:6)] &lt;- apply(df5_nt[ ,c(3:6)], 2, as.numeric)

match(df4_nt$Teams, df5_nt$Teams)
</code></pre>

<pre><code>##  [1]  1  6  3  4 14 10 15 12 11  2  8  5 13 17  7 18 16 NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df4_nt$Teams, df5_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Twente&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Feyenoord&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.0 0.0 0.0 0.2 0.0
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1 Var2 Distance
## 1       Ajax Ajax      1.0
## 2     Twente Ajax      0.0
## 3        Psv Ajax      0.0
## 4 Az Alkmaar Ajax      0.2
## 5  Groningen Ajax      0.0
## 6       Roda Ajax      0.0
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 17
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##          Var1       Var2 Distance
## 1        Ajax       Ajax        1
## 28  Feyenoord  Feyenoord        1
## 39        Psv        Psv        1
## 58 Az Alkmaar Az Alkmaar        1
## 84 Heerenveen Heerenveen        1
## 92     Twente     Twente        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##             Var1          Var2 Distance
## 1           Ajax          Ajax        1
## 2      Feyenoord     Feyenoord        1
## 3            Psv           Psv        1
## 4     Az Alkmaar    Az Alkmaar        1
## 5     Heerenveen    Heerenveen        1
## 6         Twente        Twente        1
## 7        Vitesse       Vitesse        1
## 8   Nec Nijmegen  Nec Nijmegen        1
## 9           Roda          Roda        1
## 10       Utrecht       Utrecht        1
## 11      Heracles      Heracles        1
## 12     Nac Breda     Nac Breda        1
## 13     Groningen     Groningen        1
## 14  Ado Den Haag  Ado Den Haag        1
## 15     Vvv Venlo     Vvv Venlo        1
## 16 De Graafschap De Graafschap        1
## 17     Excelsior     Excelsior        1
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
#match(df4_it$Teams, df5_nt$Teams)

###The result is right due to the relegation promotion - relegation rule, 1 team has
###been relegated the season 2010-2011 in Netherlands League: https://en.wikipedia.org/wiki/2010-11_Eredivisie##

#####Manipulating the upper case issue in imported data (data_NTL13)#####

#library(dplyr)

head(data_NTL13)
</code></pre>

<pre><code>##    N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA      &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1      AJAX    34  22    10     2    83    31   11     5     1      40
## 3  2       PSV    34  22     3     9   103    43   14     0     3      58
## 4  3 FEYENOORD    34  21     6     7    64    38   14     3     0      42
## 5  4   VITESSE    34  19     7     8    68    42    9     6     2      34
## 6  5   UTRECHT    34  19     6     9    55    41   11     3     3      27
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    10   11     5     1      43    21  76
## 3    17    8     3     6      45    26  69
## 4    12    7     3     7      22    26  69
## 5    18   10     1     6      34    24  64
## 6    12    8     3     6      28    29  63
</code></pre>

<pre><code class="r">data_NTL13 &lt;- data_NTL13[-1 , ]

####Converting teams names to lower case
data_NTL13$Team2 &lt;-  tolower(data_NTL13$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL13$Team3 &lt;- sapply(data_NTL13$Team2, simpleCap)

data_NTL13$Team4 &lt;- as.factor(data_NTL13$Team3)

data_NTL13$Team5 &lt;-as.character(data_NTL13$Team4)
rownames(data_NTL13) &lt;- 1:nrow(data_NTL13)
head(data_NTL13)
</code></pre>

<pre><code>##   N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      AJAX    34  22    10     2    83    31   11     5     1      40
## 2 2       PSV    34  22     3     9   103    43   14     0     3      58
## 3 3 FEYENOORD    34  21     6     7    64    38   14     3     0      42
## 4 4   VITESSE    34  19     7     8    68    42    9     6     2      34
## 5 5   UTRECHT    34  19     6     9    55    41   11     3     3      27
## 6 6    TWENTE    34  17    11     6    60    33   10     4     3      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts     Team2     Team3     Team4
## 1    10   11     5     1      43    21  76      ajax      Ajax      Ajax
## 2    17    8     3     6      45    26  69       psv       Psv       Psv
## 3    12    7     3     7      22    26  69 feyenoord Feyenoord Feyenoord
## 4    18   10     1     6      34    24  64   vitesse   Vitesse   Vitesse
## 5    12    8     3     6      28    29  63   utrecht   Utrecht   Utrecht
## 6    17    7     7     3      27    16  62    twente    Twente    Twente
##       Team5
## 1      Ajax
## 2       Psv
## 3 Feyenoord
## 4   Vitesse
## 5   Utrecht
## 6    Twente
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL13)
</code></pre>

<pre><code>##   N      Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1      AJAX    34  22    10     2    83    31   11     5     1      40
## 2 2       PSV    34  22     3     9   103    43   14     0     3      58
## 3 3 FEYENOORD    34  21     6     7    64    38   14     3     0      42
## 4 4   VITESSE    34  19     7     8    68    42    9     6     2      34
## 5 5   UTRECHT    34  19     6     9    55    41   11     3     3      27
## 6 6    TWENTE    34  17    11     6    60    33   10     4     3      33
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts     Team2     Team3     Team4
## 1    10   11     5     1      43    21  76      ajax      Ajax      Ajax
## 2    17    8     3     6      45    26  69       psv       Psv       Psv
## 3    12    7     3     7      22    26  69 feyenoord Feyenoord Feyenoord
## 4    18   10     1     6      34    24  64   vitesse   Vitesse   Vitesse
## 5    12    8     3     6      28    29  63   utrecht   Utrecht   Utrecht
## 6    17    7     7     3      27    16  62    twente    Twente    Twente
##       Team5
## 1      Ajax
## 2       Psv
## 3 Feyenoord
## 4   Vitesse
## 5   Utrecht
## 6    Twente
</code></pre>

<pre><code class="r">names(data_NTL13)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df6_nt &lt;- data_NTL13[c(1, 23, 3:8, 19)]

str(df6_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Ajax&quot; &quot;Psv&quot; &quot;Feyenoord&quot; &quot;Vitesse&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 7 6 5 5 4 3 2 11 1 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 5 6 7 6 2 7 9 4 9 ...
##  $ NA..2: Factor w/ 13 levels &quot;12&quot;,&quot;14&quot;,&quot;15&quot;,..: 7 12 10 11 12 9 3 2 1 3 ...
##  $ Goals: Factor w/ 18 levels &quot;103&quot;,&quot;33&quot;,&quot;36&quot;,..: 17 1 15 16 11 14 3 9 8 12 ...
##  $ NA..3: Factor w/ 18 levels &quot;31&quot;,&quot;33&quot;,&quot;38&quot;,..: 1 6 3 5 4 2 8 13 13 9 ...
##  $ Pts  : num  76 69 69 64 63 62 43 42 40 39 ...
</code></pre>

<pre><code class="r">head(df6_nt)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1      Ajax    34  22    10     2    83    31  76
## 2 2       Psv    34  22     3     9   103    43  69
## 3 3 Feyenoord    34  21     6     7    64    38  69
## 4 4   Vitesse    34  19     7     8    68    42  64
## 5 5   Utrecht    34  19     6     9    55    41  63
## 6 6    Twente    34  17    11     6    60    33  62
</code></pre>

<pre><code class="r">#####Changing the names#####

df6_nt$Aggregate &lt;- paste(df6_nt$Goals, df6_nt$NA..3, sep = &quot;-&quot;)
head(df6_nt)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1      Ajax    34  22    10     2    83    31  76     83-31
## 2 2       Psv    34  22     3     9   103    43  69    103-43
## 3 3 Feyenoord    34  21     6     7    64    38  69     64-38
## 4 4   Vitesse    34  19     7     8    68    42  64     68-42
## 5 5   Utrecht    34  19     6     9    55    41  63     55-41
## 6 6    Twente    34  17    11     6    60    33  62     60-33
</code></pre>

<pre><code class="r">df6_nt &lt;- df6_nt[ ,c(1:6, 10, 9)]
head(df6_nt)
</code></pre>

<pre><code>##   N     Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1      Ajax    34  22    10     2     83-31  76
## 2 2       Psv    34  22     3     9    103-43  69
## 3 3 Feyenoord    34  21     6     7     64-38  69
## 4 4   Vitesse    34  19     7     8     68-42  64
## 5 5   Utrecht    34  19     6     9     55-41  63
## 6 6    Twente    34  17    11     6     60-33  62
</code></pre>

<pre><code class="r">names(df6_nt) &lt;- names(data_9)
head(df6_nt)
</code></pre>

<pre><code>##   Index     Teams Games Wins Draws Loss Aggregate Points
## 1     1      Ajax    34   22    10    2     83-31     76
## 2     2       Psv    34   22     3    9    103-43     69
## 3     3 Feyenoord    34   21     6    7     64-38     69
## 4     4   Vitesse    34   19     7    8     68-42     64
## 5     5   Utrecht    34   19     6    9     55-41     63
## 6     6    Twente    34   17    11    6     60-33     62
</code></pre>

<pre><code class="r">str(df6_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Ajax&quot; &quot;Psv&quot; &quot;Feyenoord&quot; &quot;Vitesse&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 7 6 5 5 4 3 2 11 1 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 1 5 6 7 6 2 7 9 4 9 ...
##  $ Loss     : Factor w/ 13 levels &quot;12&quot;,&quot;14&quot;,&quot;15&quot;,..: 7 12 10 11 12 9 3 2 1 3 ...
##  $ Aggregate: chr  &quot;83-31&quot; &quot;103-43&quot; &quot;64-38&quot; &quot;68-42&quot; ...
##  $ Points   : num  76 69 69 64 63 62 43 42 40 39 ...
</code></pre>

<pre><code class="r">df6_nt[ ,c(3:6)] &lt;- apply(df6_nt[ ,c(3:6)], 2, as.numeric)

match(df5_nt$Teams, df6_nt$Teams)
</code></pre>

<pre><code>##  [1]  1  3  2 10  8  6  4 15 14 16  5 12 13  7  9 17 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df5_nt$Teams, df6_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Feyenoord&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Psv&quot;,&quot;Feyenoord&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.0 0.0 0.0 0.2 0.0
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1 Var2 Distance
## 1       Ajax Ajax      1.0
## 2  Feyenoord Ajax      0.0
## 3        Psv Ajax      0.0
## 4 Az Alkmaar Ajax      0.2
## 5 Heerenveen Ajax      0.0
## 6     Twente Ajax      0.0
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##         Var1      Var2 Distance
## 1       Ajax      Ajax        1
## 21       Psv       Psv        1
## 38 Feyenoord Feyenoord        1
## 61   Vitesse   Vitesse        1
## 83   Utrecht   Utrecht        1
## 96    Twente    Twente        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##            Var1         Var2 Distance
## 1          Ajax         Ajax        1
## 2           Psv          Psv        1
## 3     Feyenoord    Feyenoord        1
## 4       Vitesse      Vitesse        1
## 5       Utrecht      Utrecht        1
## 6        Twente       Twente        1
## 7     Groningen    Groningen        1
## 8    Heerenveen   Heerenveen        1
## 9  Ado Den Haag Ado Den Haag        1
## 10   Az Alkmaar   Az Alkmaar        1
## 11     Heracles     Heracles        1
## 12    Nac Breda    Nac Breda        1
## 13     Waalwijk     Waalwijk        1
## 14 Nec Nijmegen Nec Nijmegen        1
## 15         Roda         Roda        1
## 16    Vvv Venlo    Vvv Venlo        1
</code></pre>

<pre><code class="r">#####No need to Change the names#####


###Checking match funtion after the correction
#match(df5_it$Teams, df6_nt$Teams)

###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2011-2012 in Netherlands League: https://en.wikipedia.org/wiki/2011-12_Eredivisie##

#####Manipulating the upper case issue in imported data (data_NTL14)#####

#library(dplyr)

head(data_NTL14)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1       AJAX    34  20    11     3    69    28   13     3     1      42
## 3  2  FEYENOORD    34  20     7     7    76    40   12     2     3      44
## 4  3     TWENTE    34  17    12     5    72    37    9     8     0      43
## 5  4        PSV    34  18     5    11    60    45   11     3     3      34
## 6  5 HEERENVEEN    34  16     9     9    72    51    9     4     4      43
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2     9    7     8     2      27    19  71
## 3    17    8     5     4      32    23  67
## 4    17    8     4     5      29    20  63
## 5    18    7     2     8      26    27  59
## 6    27    7     5     5      29    24  57
</code></pre>

<pre><code class="r">data_NTL14 &lt;- data_NTL14[-1 , ]

####Converting teams names to lower case
data_NTL14$Team2 &lt;-  tolower(data_NTL14$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL14$Team3 &lt;- sapply(data_NTL14$Team2, simpleCap)

data_NTL14$Team4 &lt;- as.factor(data_NTL14$Team3)

data_NTL14$Team5 &lt;-as.character(data_NTL14$Team4)
rownames(data_NTL14) &lt;- 1:nrow(data_NTL14)
head(data_NTL14)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1       AJAX    34  20    11     3    69    28   13     3     1      42
## 2 2  FEYENOORD    34  20     7     7    76    40   12     2     3      44
## 3 3     TWENTE    34  17    12     5    72    37    9     8     0      43
## 4 4        PSV    34  18     5    11    60    45   11     3     3      34
## 5 5 HEERENVEEN    34  16     9     9    72    51    9     4     4      43
## 6 6    VITESSE    34  15    10     9    65    49    8     6     3      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     9    7     8     2      27    19  71       ajax       Ajax
## 2    17    8     5     4      32    23  67  feyenoord  Feyenoord
## 3    17    8     4     5      29    20  63     twente     Twente
## 4    18    7     2     8      26    27  59        psv        Psv
## 5    27    7     5     5      29    24  57 heerenveen Heerenveen
## 6    19    7     4     6      33    30  55    vitesse    Vitesse
##        Team4      Team5
## 1       Ajax       Ajax
## 2  Feyenoord  Feyenoord
## 3     Twente     Twente
## 4        Psv        Psv
## 5 Heerenveen Heerenveen
## 6    Vitesse    Vitesse
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL14)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1       AJAX    34  20    11     3    69    28   13     3     1      42
## 2 2  FEYENOORD    34  20     7     7    76    40   12     2     3      44
## 3 3     TWENTE    34  17    12     5    72    37    9     8     0      43
## 4 4        PSV    34  18     5    11    60    45   11     3     3      34
## 5 5 HEERENVEEN    34  16     9     9    72    51    9     4     4      43
## 6 6    VITESSE    34  15    10     9    65    49    8     6     3      32
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1     9    7     8     2      27    19  71       ajax       Ajax
## 2    17    8     5     4      32    23  67  feyenoord  Feyenoord
## 3    17    8     4     5      29    20  63     twente     Twente
## 4    18    7     2     8      26    27  59        psv        Psv
## 5    27    7     5     5      29    24  57 heerenveen Heerenveen
## 6    19    7     4     6      33    30  55    vitesse    Vitesse
##        Team4      Team5
## 1       Ajax       Ajax
## 2  Feyenoord  Feyenoord
## 3     Twente     Twente
## 4        Psv        Psv
## 5 Heerenveen Heerenveen
## 6    Vitesse    Vitesse
</code></pre>

<pre><code class="r">names(data_NTL14)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df7_nt &lt;- data_NTL14[c(1, 23, 3:8, 19)]

str(df7_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Ajax&quot; &quot;Feyenoord&quot; &quot;Twente&quot; &quot;Psv&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 10 8 9 7 6 5 4 3 2 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 2 7 3 6 9 1 9 8 7 8 ...
##  $ NA..2: Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 11 10 1 12 12 1 3 5 5 ...
##  $ Goals: Factor w/ 14 levels &quot;40&quot;,&quot;43&quot;,&quot;44&quot;,..: 11 13 12 9 12 10 8 7 4 5 ...
##  $ NA..3: Factor w/ 15 levels &quot;28&quot;,&quot;37&quot;,&quot;40&quot;,..: 1 3 2 4 7 5 8 6 11 12 ...
##  $ Pts  : num  71 67 63 59 57 55 51 47 43 41 ...
</code></pre>

<pre><code class="r">head(df7_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1       Ajax    34  20    11     3    69    28  71
## 2 2  Feyenoord    34  20     7     7    76    40  67
## 3 3     Twente    34  17    12     5    72    37  63
## 4 4        Psv    34  18     5    11    60    45  59
## 5 5 Heerenveen    34  16     9     9    72    51  57
## 6 6    Vitesse    34  15    10     9    65    49  55
</code></pre>

<pre><code class="r">#####Changing the names#####

df7_nt$Aggregate &lt;- paste(df7_nt$Goals, df7_nt$NA..3, sep = &quot;-&quot;)
head(df7_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1       Ajax    34  20    11     3    69    28  71     69-28
## 2 2  Feyenoord    34  20     7     7    76    40  67     76-40
## 3 3     Twente    34  17    12     5    72    37  63     72-37
## 4 4        Psv    34  18     5    11    60    45  59     60-45
## 5 5 Heerenveen    34  16     9     9    72    51  57     72-51
## 6 6    Vitesse    34  15    10     9    65    49  55     65-49
</code></pre>

<pre><code class="r">df7_nt &lt;- df7_nt[ ,c(1:6, 10, 9)]
head(df7_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1       Ajax    34  20    11     3     69-28  71
## 2 2  Feyenoord    34  20     7     7     76-40  67
## 3 3     Twente    34  17    12     5     72-37  63
## 4 4        Psv    34  18     5    11     60-45  59
## 5 5 Heerenveen    34  16     9     9     72-51  57
## 6 6    Vitesse    34  15    10     9     65-49  55
</code></pre>

<pre><code class="r">names(df7_nt) &lt;- names(data_9)
head(df7_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1       Ajax    34   20    11    3     69-28     71
## 2     2  Feyenoord    34   20     7    7     76-40     67
## 3     3     Twente    34   17    12    5     72-37     63
## 4     4        Psv    34   18     5   11     60-45     59
## 5     5 Heerenveen    34   16     9    9     72-51     57
## 6     6    Vitesse    34   15    10    9     65-49     55
</code></pre>

<pre><code class="r">str(df7_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Ajax&quot; &quot;Feyenoord&quot; &quot;Twente&quot; &quot;Psv&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 15 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 10 8 9 7 6 5 4 3 2 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 2 7 3 6 9 1 9 8 7 8 ...
##  $ Loss     : Factor w/ 13 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 11 10 1 12 12 1 3 5 5 ...
##  $ Aggregate: chr  &quot;69-28&quot; &quot;76-40&quot; &quot;72-37&quot; &quot;60-45&quot; ...
##  $ Points   : num  71 67 63 59 57 55 51 47 43 41 ...
</code></pre>

<pre><code class="r">df7_nt[ ,c(3:6)] &lt;- apply(df7_nt[ ,c(3:6)], 2, as.numeric)

match(df6_nt$Teams, df7_nt$Teams)
</code></pre>

<pre><code>##  [1]  1  4  2  6 10  3  7  5  9  8 NA 14 15 16 17 18 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df6_nt$Teams, df7_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Psv&quot;,&quot;Feyenoord&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Feyenoord&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1 0 0 0 0
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##        Var1 Var2 Distance
## 1      Ajax Ajax        1
## 2       Psv Ajax        0
## 3 Feyenoord Ajax        0
## 4   Vitesse Ajax        0
## 5   Utrecht Ajax        0
## 6    Twente Ajax        0
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##          Var1       Var2 Distance
## 1        Ajax       Ajax        1
## 21  Feyenoord  Feyenoord        1
## 42     Twente     Twente        1
## 56        Psv        Psv        1
## 80 Heerenveen Heerenveen        1
## 94    Vitesse    Vitesse        1
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##            Var1         Var2 Distance
## 1          Ajax         Ajax      1.0
## 2     Feyenoord    Feyenoord      1.0
## 3        Twente       Twente      1.0
## 4           Psv          Psv      1.0
## 5    Heerenveen   Heerenveen      1.0
## 6       Vitesse      Vitesse      1.0
## 7     Groningen    Groningen      1.0
## 8    Az Alkmaar   Az Alkmaar      1.0
## 9  Ado Den Haag Ado Den Haag      1.0
## 10      Utrecht      Utrecht      1.0
## 12     Heracles     Heracles      1.0
## 13    Nac Breda    Nac Breda      1.0
## 14     Waalwijk     Waalwijk      1.0
## 15 Nec Nijmegen Nec Nijmegen      1.0
## 16         Roda         Roda      1.0
## 11       Zwolle   Pec Zwolle      0.6
</code></pre>

<pre><code class="r">#####Changing the names#####
df7_nt$Teams[df7_nt$Teams == &quot;Pec Zwolle&quot;] &lt;- df6_nt$Teams[df6_nt$Teams == &quot;Zwolle&quot;]

###Checking match funtion after the correction
match(df6_nt$Teams, df7_nt$Teams)
</code></pre>

<pre><code>##  [1]  1  4  2  6 10  3  7  5  9  8 11 14 15 16 17 18 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2012-2013 in Netherlands League: https://en.wikipedia.org/wiki/2012-13_Eredivisie##


#####Manipulating the upper case issue in imported data (data_NTL15)#####

#library(dplyr)

head(data_NTL15)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1        PSV    34  29     1     4    92    31   16     0     1      50
## 3  2       AJAX    34  21     8     5    69    29   12     3     2      37
## 4  3 AZ ALKMAAR    34  19     5    10    63    56    9     3     5      30
## 5  4  FEYENOORD    34  17     8     9    56    39   10     2     5      31
## 6  5    VITESSE    34  16    10     8    66    43    8     8     1      36
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    12   13     1     3      42    19  88
## 3    11    9     5     3      32    18  71
## 4    27   10     2     5      33    29  62
## 5    20    7     6     4      25    19  59
## 6    18    8     2     7      30    25  58
</code></pre>

<pre><code class="r">data_NTL15 &lt;- data_NTL15[-1 , ]

####Converting teams names to lower case
data_NTL15$Team2 &lt;-  tolower(data_NTL15$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL15$Team3 &lt;- sapply(data_NTL15$Team2, simpleCap)

data_NTL15$Team4 &lt;- as.factor(data_NTL15$Team3)

data_NTL15$Team5 &lt;-as.character(data_NTL15$Team4)
rownames(data_NTL15) &lt;- 1:nrow(data_NTL15)
head(data_NTL15)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1        PSV    34  29     1     4    92    31   16     0     1      50
## 2 2       AJAX    34  21     8     5    69    29   12     3     2      37
## 3 3 AZ ALKMAAR    34  19     5    10    63    56    9     3     5      30
## 4 4  FEYENOORD    34  17     8     9    56    39   10     2     5      31
## 5 5    VITESSE    34  16    10     8    66    43    8     8     1      36
## 6 6 PEC ZWOLLE    34  16     5    13    59    43   11     4     2      40
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    12   13     1     3      42    19  88        psv        Psv
## 2    11    9     5     3      32    18  71       ajax       Ajax
## 3    27   10     2     5      33    29  62 az alkmaar Az Alkmaar
## 4    20    7     6     4      25    19  59  feyenoord  Feyenoord
## 5    18    8     2     7      30    25  58    vitesse    Vitesse
## 6    15    5     1    11      19    28  53 pec zwolle Pec Zwolle
##        Team4      Team5
## 1        Psv        Psv
## 2       Ajax       Ajax
## 3 Az Alkmaar Az Alkmaar
## 4  Feyenoord  Feyenoord
## 5    Vitesse    Vitesse
## 6 Pec Zwolle Pec Zwolle
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL15)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1        PSV    34  29     1     4    92    31   16     0     1      50
## 2 2       AJAX    34  21     8     5    69    29   12     3     2      37
## 3 3 AZ ALKMAAR    34  19     5    10    63    56    9     3     5      30
## 4 4  FEYENOORD    34  17     8     9    56    39   10     2     5      31
## 5 5    VITESSE    34  16    10     8    66    43    8     8     1      36
## 6 6 PEC ZWOLLE    34  16     5    13    59    43   11     4     2      40
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    12   13     1     3      42    19  88        psv        Psv
## 2    11    9     5     3      32    18  71       ajax       Ajax
## 3    27   10     2     5      33    29  62 az alkmaar Az Alkmaar
## 4    20    7     6     4      25    19  59  feyenoord  Feyenoord
## 5    18    8     2     7      30    25  58    vitesse    Vitesse
## 6    15    5     1    11      19    28  53 pec zwolle Pec Zwolle
##        Team4      Team5
## 1        Psv        Psv
## 2       Ajax       Ajax
## 3 Az Alkmaar Az Alkmaar
## 4  Feyenoord  Feyenoord
## 5    Vitesse    Vitesse
## 6 Pec Zwolle Pec Zwolle
</code></pre>

<pre><code class="r">names(data_NTL15)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df8_nt &lt;- data_NTL15[c(1, 23, 3:8, 19)]

str(df8_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Psv&quot; &quot;Ajax&quot; &quot;Az Alkmaar&quot; &quot;Feyenoord&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;11&quot;,&quot;13&quot;,&quot;16&quot;,..: 7 6 5 4 3 3 2 1 2 2 ...
##  $ NA..1: Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 10 7 10 2 7 3 4 9 2 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 11 1 13 12 3 1 1 4 2 ...
##  $ Goals: Factor w/ 16 levels &quot;24&quot;,&quot;29&quot;,&quot;36&quot;,..: 15 14 12 9 13 10 8 7 5 9 ...
##  $ NA..3: Factor w/ 16 levels &quot;29&quot;,&quot;31&quot;,&quot;39&quot;,..: 2 1 9 3 4 4 5 8 6 7 ...
##  $ Pts  : num  88 71 62 59 58 53 50 46 46 43 ...
</code></pre>

<pre><code class="r">head(df8_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1        Psv    34  29     1     4    92    31  88
## 2 2       Ajax    34  21     8     5    69    29  71
## 3 3 Az Alkmaar    34  19     5    10    63    56  62
## 4 4  Feyenoord    34  17     8     9    56    39  59
## 5 5    Vitesse    34  16    10     8    66    43  58
## 6 6 Pec Zwolle    34  16     5    13    59    43  53
</code></pre>

<pre><code class="r">#####Changing the names#####

df8_nt$Aggregate &lt;- paste(df8_nt$Goals, df8_nt$NA..3, sep = &quot;-&quot;)
head(df8_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1        Psv    34  29     1     4    92    31  88     92-31
## 2 2       Ajax    34  21     8     5    69    29  71     69-29
## 3 3 Az Alkmaar    34  19     5    10    63    56  62     63-56
## 4 4  Feyenoord    34  17     8     9    56    39  59     56-39
## 5 5    Vitesse    34  16    10     8    66    43  58     66-43
## 6 6 Pec Zwolle    34  16     5    13    59    43  53     59-43
</code></pre>

<pre><code class="r">df8_nt &lt;- df8_nt[ ,c(1:6, 10, 9)]
head(df8_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1        Psv    34  29     1     4     92-31  88
## 2 2       Ajax    34  21     8     5     69-29  71
## 3 3 Az Alkmaar    34  19     5    10     63-56  62
## 4 4  Feyenoord    34  17     8     9     56-39  59
## 5 5    Vitesse    34  16    10     8     66-43  58
## 6 6 Pec Zwolle    34  16     5    13     59-43  53
</code></pre>

<pre><code class="r">names(df8_nt) &lt;- names(data_9)
head(df8_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1        Psv    34   29     1    4     92-31     88
## 2     2       Ajax    34   21     8    5     69-29     71
## 3     3 Az Alkmaar    34   19     5   10     63-56     62
## 4     4  Feyenoord    34   17     8    9     56-39     59
## 5     5    Vitesse    34   16    10    8     66-43     58
## 6     6 Pec Zwolle    34   16     5   13     59-43     53
</code></pre>

<pre><code class="r">str(df8_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Psv&quot; &quot;Ajax&quot; &quot;Az Alkmaar&quot; &quot;Feyenoord&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;11&quot;,&quot;13&quot;,&quot;16&quot;,..: 7 6 5 4 3 3 2 1 2 2 ...
##  $ Draws    : Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 10 7 10 2 7 3 4 9 2 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 10 11 1 13 12 3 1 1 4 2 ...
##  $ Aggregate: chr  &quot;92-31&quot; &quot;69-29&quot; &quot;63-56&quot; &quot;56-39&quot; ...
##  $ Points   : num  88 71 62 59 58 53 50 46 46 43 ...
</code></pre>

<pre><code class="r">df8_nt[ ,c(3:6)] &lt;- apply(df8_nt[ ,c(3:6)], 2, as.numeric)

match(df7_nt$Teams, df8_nt$Teams)
</code></pre>

<pre><code>##  [1]  2  4 10  1  7  5  8  3 13 11 NA 12 17 14 16 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df7_nt$Teams, df8_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Ajax&quot;,&quot;Feyenoord&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Psv&quot;,&quot;Ajax&quot;,&quot;Az Alkmaar&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.0 0.0 0.0 1.0 0.1
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1 Var2  Distance
## 1       Ajax  Psv 0.0000000
## 2  Feyenoord  Psv 0.0000000
## 3     Twente  Psv 0.0000000
## 4        Psv  Psv 1.0000000
## 5 Heerenveen  Psv 0.1000000
## 6    Vitesse  Psv 0.1428571
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##           Var1       Var2 Distance
## 4          Psv        Psv      1.0
## 19        Ajax       Ajax      1.0
## 44  Az Alkmaar Az Alkmaar      1.0
## 56   Feyenoord  Feyenoord      1.0
## 78     Vitesse    Vitesse      1.0
## 101     Zwolle Pec Zwolle      0.6
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##               Var1            Var2  Distance
## 1              Psv             Psv 1.0000000
## 2             Ajax            Ajax 1.0000000
## 3       Az Alkmaar      Az Alkmaar 1.0000000
## 4        Feyenoord       Feyenoord 1.0000000
## 5          Vitesse         Vitesse 1.0000000
## 7       Heerenveen      Heerenveen 1.0000000
## 8        Groningen       Groningen 1.0000000
## 9           Twente          Twente 1.0000000
## 10         Utrecht         Utrecht 1.0000000
## 11         Cambuur         Cambuur 1.0000000
## 12    Ado Den Haag    Ado Den Haag 1.0000000
## 13        Heracles        Heracles 1.0000000
## 14       Nac Breda       Nac Breda 1.0000000
## 15 Go Ahead Eagles Go Ahead Eagles 1.0000000
## 6           Zwolle      Pec Zwolle 0.6000000
## 16         Utrecht       Dordrecht 0.5555556
</code></pre>

<pre><code class="r">#####Changing the names#####
df8_nt$Teams[df8_nt$Teams == &quot;Pec Zwolle&quot;] &lt;- df7_nt$Teams[df7_nt$Teams == &quot;Zwolle&quot;]

###Checking match funtion after the correction
match(df7_nt$Teams, df8_nt$Teams)
</code></pre>

<pre><code>##  [1]  2  4 10  1  7  5  8  3 13 11  6 12 17 14 16 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2013-2014 in Netherlands League: https://en.wikipedia.org/wiki/2013-14_Eredivisie##

#####Manipulating the upper case issue in imported data (data_NTL16)#####

#library(dplyr)

head(data_NTL16)
</code></pre>

<pre><code>##    N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 NA       &lt;NA&gt;     U   P     N     I     D     P    P     N     I       D
## 2  1        PSV    34  26     6     2    88    32   13     3     1      41
## 3  2       AJAX    34  25     7     2    81    21   13     3     1      49
## 4  3  FEYENOORD    34  19     6     9    62    40   11     3     3      33
## 5  4 AZ ALKMAAR    34  18     5    11    70    53   10     2     5      38
## 6  5    UTRECHT    34  15     8    11    57    48    9     4     4      30
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1     P    P     N     I       D     P  NA
## 2    16   13     3     1      47    16  84
## 3    12   12     4     1      32     9  82
## 4    14    8     3     6      29    26  63
## 5    24    8     3     6      32    29  59
## 6    24    6     4     7      27    24  53
</code></pre>

<pre><code class="r">data_NTL16 &lt;- data_NTL16[-1 , ]

####Converting teams names to lower case
data_NTL16$Team2 &lt;-  tolower(data_NTL16$Team)

####Converting the starting letter of the teams names to upper case 
data_NTL16$Team3 &lt;- sapply(data_NTL16$Team2, simpleCap)

data_NTL16$Team4 &lt;- as.factor(data_NTL16$Team3)

data_NTL16$Team5 &lt;-as.character(data_NTL16$Team4)
rownames(data_NTL16) &lt;- 1:nrow(data_NTL16)
head(data_NTL16)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1        PSV    34  26     6     2    88    32   13     3     1      41
## 2 2       AJAX    34  25     7     2    81    21   13     3     1      49
## 3 3  FEYENOORD    34  19     6     9    62    40   11     3     3      33
## 4 4 AZ ALKMAAR    34  18     5    11    70    53   10     2     5      38
## 5 5    UTRECHT    34  15     8    11    57    48    9     4     4      30
## 6 6   HERACLES    34  14     9    11    47    49    9     5     3      28
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    16   13     3     1      47    16  84        psv        Psv
## 2    12   12     4     1      32     9  82       ajax       Ajax
## 3    14    8     3     6      29    26  63  feyenoord  Feyenoord
## 4    24    8     3     6      32    29  59 az alkmaar Az Alkmaar
## 5    24    6     4     7      27    24  53    utrecht    Utrecht
## 6    23    5     4     8      19    26  51   heracles   Heracles
##        Team4      Team5
## 1        Psv        Psv
## 2       Ajax       Ajax
## 3  Feyenoord  Feyenoord
## 4 Az Alkmaar Az Alkmaar
## 5    Utrecht    Utrecht
## 6   Heracles   Heracles
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_NTL16)
</code></pre>

<pre><code>##   N       Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5 Goals.1
## 1 1        PSV    34  26     6     2    88    32   13     3     1      41
## 2 2       AJAX    34  25     7     2    81    21   13     3     1      49
## 3 3  FEYENOORD    34  19     6     9    62    40   11     3     3      33
## 4 4 AZ ALKMAAR    34  18     5    11    70    53   10     2     5      38
## 5 5    UTRECHT    34  15     8    11    57    48    9     4     4      30
## 6 6   HERACLES    34  14     9    11    47    49    9     5     3      28
##   NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts      Team2      Team3
## 1    16   13     3     1      47    16  84        psv        Psv
## 2    12   12     4     1      32     9  82       ajax       Ajax
## 3    14    8     3     6      29    26  63  feyenoord  Feyenoord
## 4    24    8     3     6      32    29  59 az alkmaar Az Alkmaar
## 5    24    6     4     7      27    24  53    utrecht    Utrecht
## 6    23    5     4     8      19    26  51   heracles   Heracles
##        Team4      Team5
## 1        Psv        Psv
## 2       Ajax       Ajax
## 3  Feyenoord  Feyenoord
## 4 Az Alkmaar Az Alkmaar
## 5    Utrecht    Utrecht
## 6   Heracles   Heracles
</code></pre>

<pre><code class="r">names(data_NTL16)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df9_nt &lt;- data_NTL16[c(1, 23, 3:8, 19)]

str(df9_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Psv&quot; &quot;Ajax&quot; &quot;Feyenoord&quot; &quot;Az Alkmaar&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 16 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 9 8 7 6 5 5 5 3 4 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 5 6 5 4 7 8 7 5 1 6 ...
##  $ NA..2: Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 8 8 11 1 1 1 2 3 2 3 ...
##  $ Goals: Factor w/ 18 levels &quot;33&quot;,&quot;34&quot;,&quot;35&quot;,..: 17 16 14 15 13 8 6 12 11 4 ...
##  $ NA..3: Factor w/ 16 levels &quot;21&quot;,&quot;32&quot;,&quot;38&quot;,..: 2 1 4 8 6 7 6 9 3 5 ...
##  $ Pts  : num  84 82 63 59 53 51 50 48 46 46 ...
</code></pre>

<pre><code class="r">head(df9_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1        Psv    34  26     6     2    88    32  84
## 2 2       Ajax    34  25     7     2    81    21  82
## 3 3  Feyenoord    34  19     6     9    62    40  63
## 4 4 Az Alkmaar    34  18     5    11    70    53  59
## 5 5    Utrecht    34  15     8    11    57    48  53
## 6 6   Heracles    34  14     9    11    47    49  51
</code></pre>

<pre><code class="r">#####Changing the names#####

df9_nt$Aggregate &lt;- paste(df9_nt$Goals, df9_nt$NA..3, sep = &quot;-&quot;)
head(df9_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1        Psv    34  26     6     2    88    32  84     88-32
## 2 2       Ajax    34  25     7     2    81    21  82     81-21
## 3 3  Feyenoord    34  19     6     9    62    40  63     62-40
## 4 4 Az Alkmaar    34  18     5    11    70    53  59     70-53
## 5 5    Utrecht    34  15     8    11    57    48  53     57-48
## 6 6   Heracles    34  14     9    11    47    49  51     47-49
</code></pre>

<pre><code class="r">df9_nt &lt;- df9_nt[ ,c(1:6, 10, 9)]
head(df9_nt)
</code></pre>

<pre><code>##   N      Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1        Psv    34  26     6     2     88-32  84
## 2 2       Ajax    34  25     7     2     81-21  82
## 3 3  Feyenoord    34  19     6     9     62-40  63
## 4 4 Az Alkmaar    34  18     5    11     70-53  59
## 5 5    Utrecht    34  15     8    11     57-48  53
## 6 6   Heracles    34  14     9    11     47-49  51
</code></pre>

<pre><code class="r">names(df9_nt) &lt;- names(data_9)
head(df9_nt)
</code></pre>

<pre><code>##   Index      Teams Games Wins Draws Loss Aggregate Points
## 1     1        Psv    34   26     6    2     88-32     84
## 2     2       Ajax    34   25     7    2     81-21     82
## 3     3  Feyenoord    34   19     6    9     62-40     63
## 4     4 Az Alkmaar    34   18     5   11     70-53     59
## 5     5    Utrecht    34   15     8   11     57-48     53
## 6     6   Heracles    34   14     9   11     47-49     51
</code></pre>

<pre><code class="r">str(df9_nt)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Psv&quot; &quot;Ajax&quot; &quot;Feyenoord&quot; &quot;Az Alkmaar&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 16 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 9 8 7 6 5 5 5 3 4 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 5 6 5 4 7 8 7 5 1 6 ...
##  $ Loss     : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;14&quot;,..: 8 8 11 1 1 1 2 3 2 3 ...
##  $ Aggregate: chr  &quot;88-32&quot; &quot;81-21&quot; &quot;62-40&quot; &quot;70-53&quot; ...
##  $ Points   : num  84 82 63 59 53 51 50 48 46 46 ...
</code></pre>

<pre><code class="r">df9_nt[ ,c(3:6)] &lt;- apply(df9_nt[ ,c(3:6)], 2, as.numeric)

match(df8_nt$Teams, df9_nt$Teams)
</code></pre>

<pre><code>##  [1]  1  2  4  3  9 NA 12  7 16 13  5 18 11  6 15 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df8_nt$Teams, df9_nt$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Psv&quot;,&quot;Ajax&quot;,&quot;Az Alkmaar&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Psv&quot;,&quot;Ajax&quot;,&quot;Feyenoord&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 1.0000000 0.0000000 0.0000000 0.0000000 0.1428571
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##         Var1 Var2  Distance
## 1        Psv  Psv 1.0000000
## 2       Ajax  Psv 0.0000000
## 3 Az Alkmaar  Psv 0.0000000
## 4  Feyenoord  Psv 0.0000000
## 5    Vitesse  Psv 0.1428571
## 6     Zwolle  Psv 0.0000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 16
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##          Var1       Var2  Distance
## 1         Psv        Psv 1.0000000
## 20       Ajax       Ajax 1.0000000
## 40  Feyenoord  Feyenoord 1.0000000
## 57 Az Alkmaar Az Alkmaar 1.0000000
## 83    Utrecht    Utrecht 1.0000000
## 90  Dordrecht    Utrecht 0.5555556
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##            Var1         Var2  Distance
## 1           Psv          Psv 1.0000000
## 2          Ajax         Ajax 1.0000000
## 3     Feyenoord    Feyenoord 1.0000000
## 4    Az Alkmaar   Az Alkmaar 1.0000000
## 5       Utrecht      Utrecht 1.0000000
## 7      Heracles     Heracles 1.0000000
## 8     Groningen    Groningen 1.0000000
## 10      Vitesse      Vitesse 1.0000000
## 11 Ado Den Haag Ado Den Haag 1.0000000
## 12   Heerenveen   Heerenveen 1.0000000
## 13       Twente       Twente 1.0000000
## 14    Excelsior    Excelsior 1.0000000
## 15    Willem Ii    Willem Ii 1.0000000
## 16      Cambuur      Cambuur 1.0000000
## 9        Zwolle   Pec Zwolle 0.6000000
## 6     Dordrecht      Utrecht 0.5555556
</code></pre>

<pre><code class="r">#####Changing the names#####
df9_nt$Teams[df9_nt$Teams == &quot;Pec Zwolle&quot;] &lt;- df8_nt$Teams[df8_nt$Teams == &quot;Zwolle&quot;]

###Checking match funtion after the correction
match(df8_nt$Teams, df9_nt$Teams)
</code></pre>

<pre><code>##  [1]  1  2  4  3  9  8 12  7 16 13  5 18 11  6 15 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2014-2015 in Netherlands League: https://en.wikipedia.org/wiki/2014-15_Eredivisie##
</code></pre>

<pre><code class="r">#####Manipulating the upper case issue in imported data (data_GRL09)#####
####GRL09 = Greek League season 2008-2009####

library(dplyr)

head(data_GRL09)
</code></pre>

<pre><code>##    N               Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA               &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 OLYMPIAKOS PIRAEUS    30  22     5     3    50    14   13     1     1
## 3  2               PAOK    30  18     9     3    39    16   11     4     0
## 4  3      PANATHINAIKOS    30  17    10     3    51    18   10     4     1
## 5  4         AEK ATHENS    30  14    13     3    40    24   11     2     2
## 6  5             LARISA    30  12    13     5    36    26    6     7     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      33     8    9     4     2      17     6  71
## 3      23     5    7     5     3      16    11  63
## 4      33     8    7     6     2      18    10  61
## 5      21     9    3    11     1      19    15  55
## 6      22    15    6     6     3      14    11  49
</code></pre>

<pre><code class="r">data_GRL09 &lt;- data_GRL09[-1 , ]

####Converting teams names to lower case
data_GRL09$Team2 &lt;-  tolower(data_GRL09$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL09$Team3 &lt;- sapply(data_GRL09$Team2, simpleCap)

data_GRL09$Team4 &lt;- as.factor(data_GRL09$Team3)

data_GRL09$Team5 &lt;-as.character(data_GRL09$Team4)
rownames(data_GRL09) &lt;- 1:nrow(data_GRL09)
head(data_GRL09)
</code></pre>

<pre><code>##   N               Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 OLYMPIAKOS PIRAEUS    30  22     5     3    50    14   13     1     1
## 2 2               PAOK    30  18     9     3    39    16   11     4     0
## 3 3      PANATHINAIKOS    30  17    10     3    51    18   10     4     1
## 4 4         AEK ATHENS    30  14    13     3    40    24   11     2     2
## 5 5             LARISA    30  12    13     5    36    26    6     7     2
## 6 6               ARIS    30  13     8     9    30    31    8     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts              Team2
## 1      33     8    9     4     2      17     6  71 olympiakos piraeus
## 2      23     5    7     5     3      16    11  63               paok
## 3      33     8    7     6     2      18    10  61      panathinaikos
## 4      21     9    3    11     1      19    15  55         aek athens
## 5      22    15    6     6     3      14    11  49             larisa
## 6      19     9    5     3     7      11    22  47               aris
##                Team3              Team4              Team5
## 1 Olympiakos Piraeus Olympiakos Piraeus Olympiakos Piraeus
## 2               Paok               Paok               Paok
## 3      Panathinaikos      Panathinaikos      Panathinaikos
## 4         Aek Athens         Aek Athens         Aek Athens
## 5             Larisa             Larisa             Larisa
## 6               Aris               Aris               Aris
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL09)
</code></pre>

<pre><code>##   N               Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 OLYMPIAKOS PIRAEUS    30  22     5     3    50    14   13     1     1
## 2 2               PAOK    30  18     9     3    39    16   11     4     0
## 3 3      PANATHINAIKOS    30  17    10     3    51    18   10     4     1
## 4 4         AEK ATHENS    30  14    13     3    40    24   11     2     2
## 5 5             LARISA    30  12    13     5    36    26    6     7     2
## 6 6               ARIS    30  13     8     9    30    31    8     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts              Team2
## 1      33     8    9     4     2      17     6  71 olympiakos piraeus
## 2      23     5    7     5     3      16    11  63               paok
## 3      33     8    7     6     2      18    10  61      panathinaikos
## 4      21     9    3    11     1      19    15  55         aek athens
## 5      22    15    6     6     3      14    11  49             larisa
## 6      19     9    5     3     7      11    22  47               aris
##                Team3              Team4              Team5
## 1 Olympiakos Piraeus Olympiakos Piraeus Olympiakos Piraeus
## 2               Paok               Paok               Paok
## 3      Panathinaikos      Panathinaikos      Panathinaikos
## 4         Aek Athens         Aek Athens         Aek Athens
## 5             Larisa             Larisa             Larisa
## 6               Aris               Aris               Aris
</code></pre>

<pre><code class="r">names(data_GRL09)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df_gr &lt;- data_GRL09[c(1, 23, 3:8, 19)]

str(df_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos Piraeus&quot; &quot;Paok&quot; &quot;Panathinaikos&quot; &quot;Aek Athens&quot; ...
##  $ Total: Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 7 6 5 4 2 3 12 1 12 10 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 9 1 4 4 8 2 7 9 3 ...
##  $ NA..2: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 8 8 8 9 10 1 4 3 2 ...
##  $ Goals: Factor w/ 14 levels &quot;19&quot;,&quot;22&quot;,&quot;23&quot;,..: 12 10 13 11 9 6 4 11 7 8 ...
##  $ NA..3: Factor w/ 16 levels &quot;14&quot;,&quot;16&quot;,&quot;18&quot;,..: 1 2 3 5 6 7 4 12 11 7 ...
##  $ Pts  : num  71 63 61 55 49 47 38 37 36 33 ...
</code></pre>

<pre><code class="r">head(df_gr)
</code></pre>

<pre><code>##   N              Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Olympiakos Piraeus    30  22     5     3    50    14  71
## 2 2               Paok    30  18     9     3    39    16  63
## 3 3      Panathinaikos    30  17    10     3    51    18  61
## 4 4         Aek Athens    30  14    13     3    40    24  55
## 5 5             Larisa    30  12    13     5    36    26  49
## 6 6               Aris    30  13     8     9    30    31  47
</code></pre>

<pre><code class="r">#####Changing the names#####

df_gr$Aggregate &lt;- paste(df_gr$Goals, df_gr$NA..3, sep = &quot;-&quot;)
head(df_gr)
</code></pre>

<pre><code>##   N              Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Olympiakos Piraeus    30  22     5     3    50    14  71     50-14
## 2 2               Paok    30  18     9     3    39    16  63     39-16
## 3 3      Panathinaikos    30  17    10     3    51    18  61     51-18
## 4 4         Aek Athens    30  14    13     3    40    24  55     40-24
## 5 5             Larisa    30  12    13     5    36    26  49     36-26
## 6 6               Aris    30  13     8     9    30    31  47     30-31
</code></pre>

<pre><code class="r">df_gr &lt;- df_gr[ ,c(1:6, 10, 9)]
head(df_gr)
</code></pre>

<pre><code>##   N              Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Olympiakos Piraeus    30  22     5     3     50-14  71
## 2 2               Paok    30  18     9     3     39-16  63
## 3 3      Panathinaikos    30  17    10     3     51-18  61
## 4 4         Aek Athens    30  14    13     3     40-24  55
## 5 5             Larisa    30  12    13     5     36-26  49
## 6 6               Aris    30  13     8     9     30-31  47
</code></pre>

<pre><code class="r">names(df_gr) &lt;- names(data_9)
head(df_gr)
</code></pre>

<pre><code>##   Index              Teams Games Wins Draws Loss Aggregate Points
## 1     1 Olympiakos Piraeus    30   22     5    3     50-14     71
## 2     2               Paok    30   18     9    3     39-16     63
## 3     3      Panathinaikos    30   17    10    3     51-18     61
## 4     4         Aek Athens    30   14    13    3     40-24     55
## 5     5             Larisa    30   12    13    5     36-26     49
## 6     6               Aris    30   13     8    9     30-31     47
</code></pre>

<pre><code class="r">str(df_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos Piraeus&quot; &quot;Paok&quot; &quot;Panathinaikos&quot; &quot;Aek Athens&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 7 6 5 4 2 3 12 1 12 10 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 5 9 1 4 4 8 2 7 9 3 ...
##  $ Loss     : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 8 8 8 9 10 1 4 3 2 ...
##  $ Aggregate: chr  &quot;50-14&quot; &quot;39-16&quot; &quot;51-18&quot; &quot;40-24&quot; ...
##  $ Points   : num  71 63 61 55 49 47 38 37 36 33 ...
</code></pre>

<pre><code class="r">df_gr[ ,c(3:6)] &lt;- apply(df_gr[ ,c(3:6)], 2, as.numeric)


#####Manipulating the upper case issue in imported data (data_GRL10)#####

#library(dplyr)

head(data_GRL10)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 PANATHINAIKOS    30  22     4     4    54    17   11     2     2
## 3  2    OLYMPIAKOS    30  19     7     4    47    18    9     4     2
## 4  3          PAOK    30  19     5     6    41    16   13     0     2
## 5  4    AEK ATHENS    30  15     8     7    43    31   11     2     2
## 6  5          ARIS    30  12    10     8    35    28    9     4     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      31    10   11     2     2      23     7  70
## 3      26    10   10     3     2      21     8  64
## 4      26     6    6     5     4      15    10  62
## 5      29    14    4     6     5      14    17  53
## 6      17     8    3     6     6      18    20  46
</code></pre>

<pre><code class="r">data_GRL10 &lt;- data_GRL10[-1 , ]

####Converting teams names to lower case
data_GRL10$Team2 &lt;-  tolower(data_GRL10$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL10$Team3 &lt;- sapply(data_GRL10$Team2, simpleCap)

data_GRL10$Team4 &lt;- as.factor(data_GRL10$Team3)

data_GRL10$Team5 &lt;-as.character(data_GRL10$Team4)
rownames(data_GRL10) &lt;- 1:nrow(data_GRL10)
head(data_GRL10)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 PANATHINAIKOS    30  22     4     4    54    17   11     2     2
## 2 2    OLYMPIAKOS    30  19     7     4    47    18    9     4     2
## 3 3          PAOK    30  19     5     6    41    16   13     0     2
## 4 4    AEK ATHENS    30  15     8     7    43    31   11     2     2
## 5 5          ARIS    30  12    10     8    35    28    9     4     2
## 6 6        KAVALA    30  10     9    11    31    32    6     7     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      31    10   11     2     2      23     7  70 panathinaikos
## 2      26    10   10     3     2      21     8  64    olympiakos
## 3      26     6    6     5     4      15    10  62          paok
## 4      29    14    4     6     5      14    17  53    aek athens
## 5      17     8    3     6     6      18    20  46          aris
## 6      21    16    4     2     9      10    16  39        kavala
##           Team3         Team4         Team5
## 1 Panathinaikos Panathinaikos Panathinaikos
## 2    Olympiakos    Olympiakos    Olympiakos
## 3          Paok          Paok          Paok
## 4    Aek Athens    Aek Athens    Aek Athens
## 5          Aris          Aris          Aris
## 6        Kavala        Kavala        Kavala
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL10)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 PANATHINAIKOS    30  22     4     4    54    17   11     2     2
## 2 2    OLYMPIAKOS    30  19     7     4    47    18    9     4     2
## 3 3          PAOK    30  19     5     6    41    16   13     0     2
## 4 4    AEK ATHENS    30  15     8     7    43    31   11     2     2
## 5 5          ARIS    30  12    10     8    35    28    9     4     2
## 6 6        KAVALA    30  10     9    11    31    32    6     7     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      31    10   11     2     2      23     7  70 panathinaikos
## 2      26    10   10     3     2      21     8  64    olympiakos
## 3      26     6    6     5     4      15    10  62          paok
## 4      29    14    4     6     5      14    17  53    aek athens
## 5      17     8    3     6     6      18    20  46          aris
## 6      21    16    4     2     9      10    16  39        kavala
##           Team3         Team4         Team5
## 1 Panathinaikos Panathinaikos Panathinaikos
## 2    Olympiakos    Olympiakos    Olympiakos
## 3          Paok          Paok          Paok
## 4    Aek Athens    Aek Athens    Aek Athens
## 5          Aris          Aris          Aris
## 6        Kavala        Kavala        Kavala
</code></pre>

<pre><code class="r">names(data_GRL10)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df3_gr &lt;- data_GRL10[c(1, 23, 3:8, 19)]

str(df3_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Panathinaikos&quot; &quot;Olympiakos&quot; &quot;Paok&quot; &quot;Aek Athens&quot; ...
##  $ Total: Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 9 levels &quot;10&quot;,&quot;12&quot;,&quot;15&quot;,..: 5 4 4 3 2 1 1 8 1 1 ...
##  $ NA..1: Factor w/ 9 levels &quot;10&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,..: 3 6 4 7 1 8 7 1 6 6 ...
##  $ NA..2: Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 8 9 10 11 1 2 1 3 3 ...
##  $ Goals: Factor w/ 13 levels &quot;21&quot;,&quot;27&quot;,&quot;29&quot;,..: 12 11 9 10 6 4 5 5 8 4 ...
##  $ NA..3: Factor w/ 14 levels &quot;16&quot;,&quot;17&quot;,&quot;18&quot;,..: 2 3 1 5 4 6 8 7 9 10 ...
##  $ Pts  : num  70 64 62 53 46 39 38 37 37 37 ...
</code></pre>

<pre><code class="r">head(df3_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Panathinaikos    30  22     4     4    54    17  70
## 2 2    Olympiakos    30  19     7     4    47    18  64
## 3 3          Paok    30  19     5     6    41    16  62
## 4 4    Aek Athens    30  15     8     7    43    31  53
## 5 5          Aris    30  12    10     8    35    28  46
## 6 6        Kavala    30  10     9    11    31    32  39
</code></pre>

<pre><code class="r">#####Changing the names#####

df3_gr$Aggregate &lt;- paste(df3_gr$Goals, df3_gr$NA..3, sep = &quot;-&quot;)
head(df3_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Panathinaikos    30  22     4     4    54    17  70     54-17
## 2 2    Olympiakos    30  19     7     4    47    18  64     47-18
## 3 3          Paok    30  19     5     6    41    16  62     41-16
## 4 4    Aek Athens    30  15     8     7    43    31  53     43-31
## 5 5          Aris    30  12    10     8    35    28  46     35-28
## 6 6        Kavala    30  10     9    11    31    32  39     31-32
</code></pre>

<pre><code class="r">df3_gr &lt;- df3_gr[ ,c(1:6, 10, 9)]
head(df3_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Panathinaikos    30  22     4     4     54-17  70
## 2 2    Olympiakos    30  19     7     4     47-18  64
## 3 3          Paok    30  19     5     6     41-16  62
## 4 4    Aek Athens    30  15     8     7     43-31  53
## 5 5          Aris    30  12    10     8     35-28  46
## 6 6        Kavala    30  10     9    11     31-32  39
</code></pre>

<pre><code class="r">names(df3_gr) &lt;- names(data_9)
head(df3_gr)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Panathinaikos    30   22     4    4     54-17     70
## 2     2    Olympiakos    30   19     7    4     47-18     64
## 3     3          Paok    30   19     5    6     41-16     62
## 4     4    Aek Athens    30   15     8    7     43-31     53
## 5     5          Aris    30   12    10    8     35-28     46
## 6     6        Kavala    30   10     9   11     31-32     39
</code></pre>

<pre><code class="r">str(df3_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Panathinaikos&quot; &quot;Olympiakos&quot; &quot;Paok&quot; &quot;Aek Athens&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 9 levels &quot;10&quot;,&quot;12&quot;,&quot;15&quot;,..: 5 4 4 3 2 1 1 8 1 1 ...
##  $ Draws    : Factor w/ 9 levels &quot;10&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;,..: 3 6 4 7 1 8 7 1 6 6 ...
##  $ Loss     : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 8 8 9 10 11 1 2 1 3 3 ...
##  $ Aggregate: chr  &quot;54-17&quot; &quot;47-18&quot; &quot;41-16&quot; &quot;43-31&quot; ...
##  $ Points   : num  70 64 62 53 46 39 38 37 37 37 ...
</code></pre>

<pre><code class="r">df3_gr[ ,c(3:6)] &lt;- apply(df3_gr[ ,c(3:6)], 2, as.numeric)

match(df_gr$Teams, df3_gr$Teams)
</code></pre>

<pre><code>##  [1] NA  3  1  4 10  5 13  8 11 12 16  9 14 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df2_gr$Teams, df3_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    256 obs. of  2 variables:
##  $ Var1: Factor w/ 16 levels &quot;Olympiakos&quot;,&quot;Paok&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 16 levels &quot;Panathinaikos&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.3846154 0.2307692 1.0000000 0.2307692 0.2307692
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##            Var1          Var2  Distance
## 1    Olympiakos Panathinaikos 0.3846154
## 2          Paok Panathinaikos 0.2307692
## 3 Panathinaikos Panathinaikos 1.0000000
## 4    Aek Athens Panathinaikos 0.2307692
## 5        Larisa Panathinaikos 0.2307692
## 6          Aris Panathinaikos 0.1538462
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 26
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 3  Panathinaikos Panathinaikos 1.0000000
## 8      Panionios Panathinaikos 0.5384615
## 11  Panthrakikos Panathinaikos 0.6923077
## 15  Panserraikos Panathinaikos 0.6153846
## 17    Olympiakos    Olympiakos 1.0000000
## 29    Levadiakos    Olympiakos 0.5000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 1     Panathinaikos    Panathinaikos 1.0000000
## 5        Olympiakos       Olympiakos 1.0000000
## 7              Paok             Paok 1.0000000
## 8        Aek Athens       Aek Athens 1.0000000
## 10             Aris             Aris 1.0000000
## 12        Panionios        Panionios 1.0000000
## 15          Iraklis          Iraklis 1.0000000
## 16           Larisa           Larisa 1.0000000
## 18        Ergotelis        Ergotelis 1.0000000
## 19 Asteras Tripolis Asteras Tripolis 1.0000000
## 20     Skoda Xanthi     Skoda Xanthi 1.0000000
## 22       Levadiakos       Levadiakos 1.0000000
## 25     Panthrakikos     Panthrakikos 1.0000000
## 3      Panthrakikos    Panathinaikos 0.6923077
## 23    Panathinaikos     Panthrakikos 0.6923077
## 26     Panserraikos     Panthrakikos 0.6666667
## 4      Panserraikos    Panathinaikos 0.6153846
## 2         Panionios    Panathinaikos 0.5384615
## 11    Panathinaikos        Panionios 0.5384615
## 6        Levadiakos       Olympiakos 0.5000000
## 9            Larisa             Aris 0.5000000
## 13     Panthrakikos        Panionios 0.5000000
## 14     Panserraikos        Panionios 0.5000000
## 17             Aris           Larisa 0.5000000
## 21       Olympiakos       Levadiakos 0.5000000
## 24        Panionios     Panthrakikos 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df_gr$Teams[df_gr$Teams == &quot;Olympiakos Piraeus&quot;] &lt;- df3_gr$Teams[df3_gr$Teams == &quot;Olympiakos&quot;]

###Checking match funtion after the correction
match(df_gr$Teams, df3_gr$Teams)
</code></pre>

<pre><code>##  [1]  2  3  1  4 10  5 13  8 11 12 16  9 14 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2008-2009 in Superleague Greece: https://en.wikipedia.org/wiki/2008-09_Superleague_Greece##

#####Manipulating the upper case issue in imported data (data_GRL11)#####

#library(dplyr)

head(data_GRL11)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 OLYMPIAKOS P.    30  24     1     5    65    18   15     0     0
## 3  2 PANATHINAIKOS    30  18     6     6    47    26   11     3     1
## 4  3    AEK ATHENS    30  15     5    10    46    37    9     4     2
## 5  4          PAOK    30  14     6    10    32    29   10     1     4
## 6  5  OLYMP. VOLOU    30  12    11     7    40    28    6     6     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      46     6    9     1     5      19    12  73
## 3      27    12    7     3     5      20    14  60
## 4      22    10    6     1     8      24    27  50
## 5      20    12    4     5     6      12    17  48
## 6      20    13    6     5     4      20    15  47
</code></pre>

<pre><code class="r">data_GRL11 &lt;- data_GRL11[-1 , ]

####Converting teams names to lower case
data_GRL11$Team2 &lt;-  tolower(data_GRL11$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL11$Team3 &lt;- sapply(data_GRL11$Team2, simpleCap)

data_GRL11$Team4 &lt;- as.factor(data_GRL11$Team3)

data_GRL11$Team5 &lt;-as.character(data_GRL11$Team4)
rownames(data_GRL11) &lt;- 1:nrow(data_GRL11)
head(data_GRL11)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 OLYMPIAKOS P.    30  24     1     5    65    18   15     0     0
## 2 2 PANATHINAIKOS    30  18     6     6    47    26   11     3     1
## 3 3    AEK ATHENS    30  15     5    10    46    37    9     4     2
## 4 4          PAOK    30  14     6    10    32    29   10     1     4
## 5 5  OLYMP. VOLOU    30  12    11     7    40    28    6     6     3
## 6 6          ARIS    30  13     6    11    29    29    7     2     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      46     6    9     1     5      19    12  73 olympiakos p.
## 2      27    12    7     3     5      20    14  60 panathinaikos
## 3      22    10    6     1     8      24    27  50    aek athens
## 4      20    12    4     5     6      12    17  48          paok
## 5      20    13    6     5     4      20    15  47  olymp. volou
## 6      14    15    6     4     5      15    14  45          aris
##           Team3         Team4         Team5
## 1 Olympiakos P. Olympiakos P. Olympiakos P.
## 2 Panathinaikos Panathinaikos Panathinaikos
## 3    Aek Athens    Aek Athens    Aek Athens
## 4          Paok          Paok          Paok
## 5  Olymp. Volou  Olymp. Volou  Olymp. Volou
## 6          Aris          Aris          Aris
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL11)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 OLYMPIAKOS P.    30  24     1     5    65    18   15     0     0
## 2 2 PANATHINAIKOS    30  18     6     6    47    26   11     3     1
## 3 3    AEK ATHENS    30  15     5    10    46    37    9     4     2
## 4 4          PAOK    30  14     6    10    32    29   10     1     4
## 5 5  OLYMP. VOLOU    30  12    11     7    40    28    6     6     3
## 6 6          ARIS    30  13     6    11    29    29    7     2     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      46     6    9     1     5      19    12  73 olympiakos p.
## 2      27    12    7     3     5      20    14  60 panathinaikos
## 3      22    10    6     1     8      24    27  50    aek athens
## 4      20    12    4     5     6      12    17  48          paok
## 5      20    13    6     5     4      20    15  47  olymp. volou
## 6      14    15    6     4     5      15    14  45          aris
##           Team3         Team4         Team5
## 1 Olympiakos P. Olympiakos P. Olympiakos P.
## 2 Panathinaikos Panathinaikos Panathinaikos
## 3    Aek Athens    Aek Athens    Aek Athens
## 4          Paok          Paok          Paok
## 5  Olymp. Volou  Olymp. Volou  Olymp. Volou
## 6          Aris          Aris          Aris
</code></pre>

<pre><code class="r">names(data_GRL11)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df4_gr &lt;- data_GRL11[c(1, 23, 3:8, 19)]

str(df4_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos P.&quot; &quot;Panathinaikos&quot; &quot;Aek Athens&quot; &quot;Paok&quot; ...
##  $ Total: Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 6 5 3 4 1 2 13 11 ...
##  $ NA..1: Factor w/ 9 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 7 6 7 3 7 2 7 8 5 ...
##  $ NA..2: Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 8 1 1 9 2 1 4 3 10 ...
##  $ Goals: Factor w/ 11 levels &quot;21&quot;,&quot;22&quot;,&quot;25&quot;,..: 10 9 8 6 7 4 4 6 4 2 ...
##  $ NA..3: Factor w/ 13 levels &quot;18&quot;,&quot;26&quot;,&quot;27&quot;,..: 1 2 8 5 4 5 3 9 7 4 ...
##  $ Pts  : num  73 60 50 48 47 45 40 39 36 35 ...
</code></pre>

<pre><code class="r">head(df4_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Olympiakos P.    30  24     1     5    65    18  73
## 2 2 Panathinaikos    30  18     6     6    47    26  60
## 3 3    Aek Athens    30  15     5    10    46    37  50
## 4 4          Paok    30  14     6    10    32    29  48
## 5 5  Olymp. Volou    30  12    11     7    40    28  47
## 6 6          Aris    30  13     6    11    29    29  45
</code></pre>

<pre><code class="r">#####Changing the names#####

df4_gr$Aggregate &lt;- paste(df4_gr$Goals, df4_gr$NA..3, sep = &quot;-&quot;)
head(df4_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Olympiakos P.    30  24     1     5    65    18  73     65-18
## 2 2 Panathinaikos    30  18     6     6    47    26  60     47-26
## 3 3    Aek Athens    30  15     5    10    46    37  50     46-37
## 4 4          Paok    30  14     6    10    32    29  48     32-29
## 5 5  Olymp. Volou    30  12    11     7    40    28  47     40-28
## 6 6          Aris    30  13     6    11    29    29  45     29-29
</code></pre>

<pre><code class="r">df4_gr &lt;- df4_gr[ ,c(1:6, 10, 9)]
head(df4_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Olympiakos P.    30  24     1     5     65-18  73
## 2 2 Panathinaikos    30  18     6     6     47-26  60
## 3 3    Aek Athens    30  15     5    10     46-37  50
## 4 4          Paok    30  14     6    10     32-29  48
## 5 5  Olymp. Volou    30  12    11     7     40-28  47
## 6 6          Aris    30  13     6    11     29-29  45
</code></pre>

<pre><code class="r">names(df4_gr) &lt;- names(data_9)
head(df4_gr)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Olympiakos P.    30   24     1    5     65-18     73
## 2     2 Panathinaikos    30   18     6    6     47-26     60
## 3     3    Aek Athens    30   15     5   10     46-37     50
## 4     4          Paok    30   14     6   10     32-29     48
## 5     5  Olymp. Volou    30   12    11    7     40-28     47
## 6     6          Aris    30   13     6   11     29-29     45
</code></pre>

<pre><code class="r">str(df4_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos P.&quot; &quot;Panathinaikos&quot; &quot;Aek Athens&quot; &quot;Paok&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 8 7 6 5 3 4 1 2 13 11 ...
##  $ Draws    : Factor w/ 9 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 7 6 7 3 7 2 7 8 5 ...
##  $ Loss     : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 8 1 1 9 2 1 4 3 10 ...
##  $ Aggregate: chr  &quot;65-18&quot; &quot;47-26&quot; &quot;46-37&quot; &quot;32-29&quot; ...
##  $ Points   : num  73 60 50 48 47 45 40 39 36 35 ...
</code></pre>

<pre><code class="r">df4_gr[ ,c(3:6)] &lt;- apply(df4_gr[ ,c(3:6)], 2, as.numeric)

match(df3_gr$Teams, df4_gr$Teams)
</code></pre>

<pre><code>##  [1]  2 NA  4  3  6  7 12 11 10 15  8 14  9 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df3_gr$Teams, df4_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    256 obs. of  2 variables:
##  $ Var1: Factor w/ 16 levels &quot;Panathinaikos&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 16 levels &quot;Olympiakos P.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.15384615 0.76923077 0.15384615 0.07692308 0.15384615
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##            Var1          Var2   Distance
## 1 Panathinaikos Olympiakos P. 0.15384615
## 2    Olympiakos Olympiakos P. 0.76923077
## 3          Paok Olympiakos P. 0.15384615
## 4    Aek Athens Olympiakos P. 0.07692308
## 5          Aris Olympiakos P. 0.15384615
## 6        Kavala Olympiakos P. 0.07692308
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 23
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 2     Olympiakos Olympiakos P. 0.7692308
## 17 Panathinaikos Panathinaikos 1.0000000
## 24     Panionios Panathinaikos 0.5384615
## 32  Panthrakikos Panathinaikos 0.6923077
## 36    Aek Athens    Aek Athens 1.0000000
## 51          Paok          Paok 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 2     Panathinaikos    Panathinaikos 1.0000000
## 5        Aek Athens       Aek Athens 1.0000000
## 6              Paok             Paok 1.0000000
## 8              Aris             Aris 1.0000000
## 10           Kavala           Kavala 1.0000000
## 11        Ergotelis        Ergotelis 1.0000000
## 12     Skoda Xanthi     Skoda Xanthi 1.0000000
## 13          Iraklis          Iraklis 1.0000000
## 15        Panionios        Panionios 1.0000000
## 17        Atromitos        Atromitos 1.0000000
## 18 Asteras Tripolis Asteras Tripolis 1.0000000
## 20           Larisa           Larisa 1.0000000
## 1        Olympiakos    Olympiakos P. 0.7692308
## 4      Panthrakikos    Panathinaikos 0.6923077
## 23     Panthrakikos     Panserraikos 0.6666667
## 21    Panathinaikos     Panserraikos 0.6153846
## 3         Panionios    Panathinaikos 0.5384615
## 14    Panathinaikos        Panionios 0.5384615
## 7        Olympiakos     Olymp. Volou 0.5000000
## 9            Larisa             Aris 0.5000000
## 16     Panthrakikos        Panionios 0.5000000
## 19             Aris           Larisa 0.5000000
## 22        Panionios     Panserraikos 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df4_gr$Teams[df4_gr$Teams == &quot;Olympiakos P.&quot;] &lt;- df3_gr$Teams[df3_gr$Teams == &quot;Olympiakos&quot;]

###Checking match funtion after the correction
match(df3_gr$Teams, df4_gr$Teams)
</code></pre>

<pre><code>##  [1]  2  1  4  3  6  7 12 11 10 15  8 14  9 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2009-2010 in Superleague Greece: https://en.wikipedia.org/wiki/2009-10_Superleague_Greece##

#####Manipulating the upper case issue in imported data (data_GRL12)#####

#library(dplyr)

head(data_GRL12)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 OLYMPIAKOS P.    30  23     4     3    70    17   12     2     1
## 3  2 PANATHINAIKOS    30  22     3     5    54    23   13     0     2
## 4  3          PAOK    30  14     8     8    45    27    8     3     4
## 5  4     ATROMITOS    30  13    11     6    32    26    9     4     2
## 6  5    AEK ATHENS    30  13     9     8    36    30    9     5     1
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      38     9   11     2     2      32     8  73
## 3      33    10    9     3     3      21    13  66
## 4      22    13    6     5     4      23    14  50
## 5      17     8    4     7     4      15    18  50
## 6      18     7    4     4     7      18    23  48
</code></pre>

<pre><code class="r">data_GRL12 &lt;- data_GRL12[-1 , ]

####Converting teams names to lower case
data_GRL12$Team2 &lt;-  tolower(data_GRL12$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL12$Team3 &lt;- sapply(data_GRL12$Team2, simpleCap)

data_GRL12$Team4 &lt;- as.factor(data_GRL12$Team3)

data_GRL12$Team5 &lt;-as.character(data_GRL12$Team4)
rownames(data_GRL12) &lt;- 1:nrow(data_GRL12)
head(data_GRL12)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    30  23     4     3    70    17   12     2     1
## 2 2    PANATHINAIKOS    30  22     3     5    54    23   13     0     2
## 3 3             PAOK    30  14     8     8    45    27    8     3     4
## 4 4        ATROMITOS    30  13    11     6    32    26    9     4     2
## 5 5       AEK ATHENS    30  13     9     8    36    30    9     5     1
## 6 6 ASTERAS TRIPOLIS    30  13     6    11    30    34    8     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      38     9   11     2     2      32     8  73    olympiakos p.
## 2      33    10    9     3     3      21    13  66    panathinaikos
## 3      22    13    6     5     4      23    14  50             paok
## 4      17     8    4     7     4      15    18  50        atromitos
## 5      18     7    4     4     7      18    23  48       aek athens
## 6      17     8    5     1     9      13    26  45 asteras tripolis
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2    Panathinaikos    Panathinaikos    Panathinaikos
## 3             Paok             Paok             Paok
## 4        Atromitos        Atromitos        Atromitos
## 5       Aek Athens       Aek Athens       Aek Athens
## 6 Asteras Tripolis Asteras Tripolis Asteras Tripolis
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL12)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    30  23     4     3    70    17   12     2     1
## 2 2    PANATHINAIKOS    30  22     3     5    54    23   13     0     2
## 3 3             PAOK    30  14     8     8    45    27    8     3     4
## 4 4        ATROMITOS    30  13    11     6    32    26    9     4     2
## 5 5       AEK ATHENS    30  13     9     8    36    30    9     5     1
## 6 6 ASTERAS TRIPOLIS    30  13     6    11    30    34    8     5     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      38     9   11     2     2      32     8  73    olympiakos p.
## 2      33    10    9     3     3      21    13  66    panathinaikos
## 3      22    13    6     5     4      23    14  50             paok
## 4      17     8    4     7     4      15    18  50        atromitos
## 5      18     7    4     4     7      18    23  48       aek athens
## 6      17     8    5     1     9      13    26  45 asteras tripolis
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2    Panathinaikos    Panathinaikos    Panathinaikos
## 3             Paok             Paok             Paok
## 4        Atromitos        Atromitos        Atromitos
## 5       Aek Athens       Aek Athens       Aek Athens
## 6 Asteras Tripolis Asteras Tripolis Asteras Tripolis
</code></pre>

<pre><code class="r">names(data_GRL12)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df5_gr &lt;- data_GRL12[c(1, 23, 3:8, 19)]

str(df5_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos P.&quot; &quot;Panathinaikos&quot; &quot;Paok&quot; &quot;Atromitos&quot; ...
##  $ Total: Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 6 5 4 3 3 3 2 1 1 1 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;3&quot;,..: 4 3 8 2 9 6 6 8 1 7 ...
##  $ NA..2: Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 10 12 11 12 2 4 3 1 4 ...
##  $ Goals: Factor w/ 14 levels &quot;11&quot;,&quot;23&quot;,&quot;26&quot;,..: 13 12 11 8 10 6 9 6 5 4 ...
##  $ NA..3: Factor w/ 13 levels &quot;17&quot;,&quot;23&quot;,&quot;26&quot;,..: 1 2 4 3 5 8 11 9 7 6 ...
##  $ Pts  : num  73 66 50 50 48 45 39 38 37 37 ...
</code></pre>

<pre><code class="r">head(df5_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1    Olympiakos P.    30  23     4     3    70    17  73
## 2 2    Panathinaikos    30  22     3     5    54    23  66
## 3 3             Paok    30  14     8     8    45    27  50
## 4 4        Atromitos    30  13    11     6    32    26  50
## 5 5       Aek Athens    30  13     9     8    36    30  48
## 6 6 Asteras Tripolis    30  13     6    11    30    34  45
</code></pre>

<pre><code class="r">#####Changing the names#####

df5_gr$Aggregate &lt;- paste(df5_gr$Goals, df5_gr$NA..3, sep = &quot;-&quot;)
head(df5_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1    Olympiakos P.    30  23     4     3    70    17  73     70-17
## 2 2    Panathinaikos    30  22     3     5    54    23  66     54-23
## 3 3             Paok    30  14     8     8    45    27  50     45-27
## 4 4        Atromitos    30  13    11     6    32    26  50     32-26
## 5 5       Aek Athens    30  13     9     8    36    30  48     36-30
## 6 6 Asteras Tripolis    30  13     6    11    30    34  45     30-34
</code></pre>

<pre><code class="r">df5_gr &lt;- df5_gr[ ,c(1:6, 10, 9)]
head(df5_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1    Olympiakos P.    30  23     4     3     70-17  73
## 2 2    Panathinaikos    30  22     3     5     54-23  66
## 3 3             Paok    30  14     8     8     45-27  50
## 4 4        Atromitos    30  13    11     6     32-26  50
## 5 5       Aek Athens    30  13     9     8     36-30  48
## 6 6 Asteras Tripolis    30  13     6    11     30-34  45
</code></pre>

<pre><code class="r">names(df5_gr) &lt;- names(data_9)
head(df5_gr)
</code></pre>

<pre><code>##   Index            Teams Games Wins Draws Loss Aggregate Points
## 1     1    Olympiakos P.    30   23     4    3     70-17     73
## 2     2    Panathinaikos    30   22     3    5     54-23     66
## 3     3             Paok    30   14     8    8     45-27     50
## 4     4        Atromitos    30   13    11    6     32-26     50
## 5     5       Aek Athens    30   13     9    8     36-30     48
## 6     6 Asteras Tripolis    30   13     6   11     30-34     45
</code></pre>

<pre><code class="r">str(df5_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos P.&quot; &quot;Panathinaikos&quot; &quot;Paok&quot; &quot;Atromitos&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 6 5 4 3 3 3 2 1 1 1 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;3&quot;,..: 4 3 8 2 9 6 6 8 1 7 ...
##  $ Loss     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 10 12 11 12 2 4 3 1 4 ...
##  $ Aggregate: chr  &quot;70-17&quot; &quot;54-23&quot; &quot;45-27&quot; &quot;32-26&quot; ...
##  $ Points   : num  73 66 50 50 48 45 39 38 37 37 ...
</code></pre>

<pre><code class="r">df5_gr[ ,c(3:6)] &lt;- apply(df5_gr[ ,c(3:6)], 2, as.numeric)

match(df4_gr$Teams, df5_gr$Teams)
</code></pre>

<pre><code>##  [1] NA  2  5  3 NA  9 NA 14 11 NA 12  4 13  6 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df4_gr$Teams, df5_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    256 obs. of  2 variables:
##  $ Var1: Factor w/ 16 levels &quot;Olympiakos&quot;,&quot;Panathinaikos&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 16 levels &quot;Olympiakos P.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.76923077 0.15384615 0.07692308 0.15384615 0.46153846
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##            Var1          Var2   Distance
## 1    Olympiakos Olympiakos P. 0.76923077
## 2 Panathinaikos Olympiakos P. 0.15384615
## 3    Aek Athens Olympiakos P. 0.07692308
## 4          Paok Olympiakos P. 0.15384615
## 5  Olymp. Volou Olympiakos P. 0.46153846
## 6          Aris Olympiakos P. 0.15384615
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 20
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 1     Olympiakos Olympiakos P. 0.7692308
## 18 Panathinaikos Panathinaikos 1.0000000
## 27     Panionios Panathinaikos 0.5384615
## 32  Panserraikos Panathinaikos 0.6153846
## 36          Paok          Paok 1.0000000
## 60     Atromitos     Atromitos 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 2     Panathinaikos    Panathinaikos 1.0000000
## 5              Paok             Paok 1.0000000
## 6         Atromitos        Atromitos 1.0000000
## 7        Aek Athens       Aek Athens 1.0000000
## 8  Asteras Tripolis Asteras Tripolis 1.0000000
## 10             Aris             Aris 1.0000000
## 12     Skoda Xanthi     Skoda Xanthi 1.0000000
## 14        Panionios        Panionios 1.0000000
## 16          Kerkyra          Kerkyra 1.0000000
## 17        Ergotelis        Ergotelis 1.0000000
## 1        Olympiakos    Olympiakos P. 0.7692308
## 20     Panserraikos      Panetolikos 0.6666667
## 19        Panionios      Panetolikos 0.6363636
## 4      Panserraikos    Panathinaikos 0.6153846
## 18    Panathinaikos      Panetolikos 0.6153846
## 3         Panionios    Panathinaikos 0.5384615
## 13    Panathinaikos        Panionios 0.5384615
## 9        Olympiakos       Levadiakos 0.5000000
## 11           Larisa             Aris 0.5000000
## 15     Panserraikos        Panionios 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df5_gr$Teams[df5_gr$Teams == &quot;Olympiakos P.&quot;] &lt;- df4_gr$Teams[df4_gr$Teams == &quot;Olympiakos&quot;]

###Checking match funtion after the correction
match(df4_gr$Teams, df5_gr$Teams)
</code></pre>

<pre><code>##  [1]  1  2  5  3 NA  9 NA 14 11 NA 12  4 13  6 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 5 teams have
###been relegated the season 2010-2011 in Superleague Greece: https://en.wikipedia.org/wiki/2010-11_Superleague_Greece##

#####Manipulating the upper case issue in imported data (data_GRL13)#####

#library(dplyr)

head(data_GRL13)
</code></pre>

<pre><code>##    N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA             &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1    OLYMPIAKOS P.    30  24     5     1    64    16   12     2     1
## 3  2             PAOK    30  18     8     4    46    19   12     2     1
## 4  3 ASTERAS TRIPOLIS    30  17     5     8    41    25   11     2     2
## 5  4        ATROMITOS    30  11    13     6    26    22    8     3     4
## 6  5     PAS GIANNINA    30  12     8    10    28    24    7     4     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      34     8   12     3     0      30     8  77
## 3      28     8    6     6     3      18    11  62
## 4      26     9    6     3     6      15    16  56
## 5      13     9    3    10     2      13    13  46
## 6      14     9    5     4     6      14    15  44
</code></pre>

<pre><code class="r">data_GRL13 &lt;- data_GRL13[-1 , ]

####Converting teams names to lower case
data_GRL13$Team2 &lt;-  tolower(data_GRL13$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL13$Team3 &lt;- sapply(data_GRL13$Team2, simpleCap)

data_GRL13$Team4 &lt;- as.factor(data_GRL13$Team3)

data_GRL13$Team5 &lt;-as.character(data_GRL13$Team4)
rownames(data_GRL13) &lt;- 1:nrow(data_GRL13)
head(data_GRL13)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    30  24     5     1    64    16   12     2     1
## 2 2             PAOK    30  18     8     4    46    19   12     2     1
## 3 3 ASTERAS TRIPOLIS    30  17     5     8    41    25   11     2     2
## 4 4        ATROMITOS    30  11    13     6    26    22    8     3     4
## 5 5     PAS GIANNINA    30  12     8    10    28    24    7     4     4
## 6 6    PANATHINAIKOS    30  10    12     8    32    30    5     7     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      34     8   12     3     0      30     8  77    olympiakos p.
## 2      28     8    6     6     3      18    11  62             paok
## 3      26     9    6     3     6      15    16  56 asteras tripolis
## 4      13     9    3    10     2      13    13  46        atromitos
## 5      14     9    5     4     6      14    15  44     pas giannina
## 6      17    13    5     5     5      15    17  40    panathinaikos
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2             Paok             Paok             Paok
## 3 Asteras Tripolis Asteras Tripolis Asteras Tripolis
## 4        Atromitos        Atromitos        Atromitos
## 5     Pas Giannina     Pas Giannina     Pas Giannina
## 6    Panathinaikos    Panathinaikos    Panathinaikos
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL13)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    30  24     5     1    64    16   12     2     1
## 2 2             PAOK    30  18     8     4    46    19   12     2     1
## 3 3 ASTERAS TRIPOLIS    30  17     5     8    41    25   11     2     2
## 4 4        ATROMITOS    30  11    13     6    26    22    8     3     4
## 5 5     PAS GIANNINA    30  12     8    10    28    24    7     4     4
## 6 6    PANATHINAIKOS    30  10    12     8    32    30    5     7     3
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      34     8   12     3     0      30     8  77    olympiakos p.
## 2      28     8    6     6     3      18    11  62             paok
## 3      26     9    6     3     6      15    16  56 asteras tripolis
## 4      13     9    3    10     2      13    13  46        atromitos
## 5      14     9    5     4     6      14    15  44     pas giannina
## 6      17    13    5     5     5      15    17  40    panathinaikos
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2             Paok             Paok             Paok
## 3 Asteras Tripolis Asteras Tripolis Asteras Tripolis
## 4        Atromitos        Atromitos        Atromitos
## 5     Pas Giannina     Pas Giannina     Pas Giannina
## 6    Panathinaikos    Panathinaikos    Panathinaikos
</code></pre>

<pre><code class="r">names(data_GRL13)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df6_gr &lt;- data_GRL13[c(1, 23, 3:8, 19)]

str(df6_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos P.&quot; &quot;Paok&quot; &quot;Asteras Tripolis&quot; &quot;Atromitos&quot; ...
##  $ Total: Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 6 5 4 2 3 1 1 1 2 1 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 5 8 5 3 8 2 1 6 4 6 ...
##  $ NA..2: Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 8 10 9 2 10 2 5 6 5 ...
##  $ Goals: Factor w/ 13 levels &quot;16&quot;,&quot;21&quot;,&quot;26&quot;,..: 12 11 10 3 4 7 4 6 9 5 ...
##  $ NA..3: Factor w/ 15 levels &quot;16&quot;,&quot;19&quot;,&quot;22&quot;,..: 1 2 5 3 4 7 6 8 13 13 ...
##  $ Pts  : num  77 62 56 46 44 40 40 36 36 36 ...
</code></pre>

<pre><code class="r">head(df6_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1    Olympiakos P.    30  24     5     1    64    16  77
## 2 2             Paok    30  18     8     4    46    19  62
## 3 3 Asteras Tripolis    30  17     5     8    41    25  56
## 4 4        Atromitos    30  11    13     6    26    22  46
## 5 5     Pas Giannina    30  12     8    10    28    24  44
## 6 6    Panathinaikos    30  10    12     8    32    30  40
</code></pre>

<pre><code class="r">#####Changing the names#####

df6_gr$Aggregate &lt;- paste(df6_gr$Goals, df6_gr$NA..3, sep = &quot;-&quot;)
head(df6_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1    Olympiakos P.    30  24     5     1    64    16  77     64-16
## 2 2             Paok    30  18     8     4    46    19  62     46-19
## 3 3 Asteras Tripolis    30  17     5     8    41    25  56     41-25
## 4 4        Atromitos    30  11    13     6    26    22  46     26-22
## 5 5     Pas Giannina    30  12     8    10    28    24  44     28-24
## 6 6    Panathinaikos    30  10    12     8    32    30  40     32-30
</code></pre>

<pre><code class="r">df6_gr &lt;- df6_gr[ ,c(1:6, 10, 9)]
head(df6_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1    Olympiakos P.    30  24     5     1     64-16  77
## 2 2             Paok    30  18     8     4     46-19  62
## 3 3 Asteras Tripolis    30  17     5     8     41-25  56
## 4 4        Atromitos    30  11    13     6     26-22  46
## 5 5     Pas Giannina    30  12     8    10     28-24  44
## 6 6    Panathinaikos    30  10    12     8     32-30  40
</code></pre>

<pre><code class="r">names(df6_gr) &lt;- names(data_9)
head(df6_gr)
</code></pre>

<pre><code>##   Index            Teams Games Wins Draws Loss Aggregate Points
## 1     1    Olympiakos P.    30   24     5    1     64-16     77
## 2     2             Paok    30   18     8    4     46-19     62
## 3     3 Asteras Tripolis    30   17     5    8     41-25     56
## 4     4        Atromitos    30   11    13    6     26-22     46
## 5     5     Pas Giannina    30   12     8   10     28-24     44
## 6     6    Panathinaikos    30   10    12    8     32-30     40
</code></pre>

<pre><code class="r">str(df6_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos P.&quot; &quot;Paok&quot; &quot;Asteras Tripolis&quot; &quot;Atromitos&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 11 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 6 5 4 2 3 1 1 1 2 1 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;12&quot;,&quot;13&quot;,..: 5 8 5 3 8 2 1 6 4 6 ...
##  $ Loss     : Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 8 10 9 2 10 2 5 6 5 ...
##  $ Aggregate: chr  &quot;64-16&quot; &quot;46-19&quot; &quot;41-25&quot; &quot;26-22&quot; ...
##  $ Points   : num  77 62 56 46 44 40 40 36 36 36 ...
</code></pre>

<pre><code class="r">df6_gr[ ,c(3:6)] &lt;- apply(df6_gr[ ,c(3:6)], 2, as.numeric)

match(df5_gr$Teams, df6_gr$Teams)
</code></pre>

<pre><code>##  [1] NA  6  2  4 15  3 11  5 13 14  7  9 16 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df5_gr$Teams, df6_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    256 obs. of  2 variables:
##  $ Var1: Factor w/ 16 levels &quot;Olympiakos&quot;,&quot;Panathinaikos&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 16 levels &quot;Olympiakos P.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.76923077 0.15384615 0.15384615 0.23076923 0.07692308
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##               Var1          Var2   Distance
## 1       Olympiakos Olympiakos P. 0.76923077
## 2    Panathinaikos Olympiakos P. 0.15384615
## 3             Paok Olympiakos P. 0.15384615
## 4        Atromitos Olympiakos P. 0.23076923
## 5       Aek Athens Olympiakos P. 0.07692308
## 6 Asteras Tripolis Olympiakos P. 0.00000000
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 21
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 1        Olympiakos    Olympiakos P. 0.7692308
## 19             Paok             Paok 1.0000000
## 38 Asteras Tripolis Asteras Tripolis 1.0000000
## 52        Atromitos        Atromitos 1.0000000
## 72     Pas Giannina     Pas Giannina 1.0000000
## 82    Panathinaikos    Panathinaikos 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 2              Paok             Paok 1.0000000
## 3  Asteras Tripolis Asteras Tripolis 1.0000000
## 4         Atromitos        Atromitos 1.0000000
## 5      Pas Giannina     Pas Giannina 1.0000000
## 6     Panathinaikos    Panathinaikos 1.0000000
## 9      Skoda Xanthi     Skoda Xanthi 1.0000000
## 14        Panionios        Panionios 1.0000000
## 17       Levadiakos       Levadiakos 1.0000000
## 18             Aris             Aris 1.0000000
## 19              Ofi              Ofi 1.0000000
## 20       Aek Athens       Aek Athens 1.0000000
## 21          Kerkyra          Kerkyra 1.0000000
## 1        Olympiakos    Olympiakos P. 0.7692308
## 10    Panathinaikos     Panthrakikos 0.6923077
## 15      Panetolikos        Panionios 0.6363636
## 8       Panetolikos    Panathinaikos 0.6153846
## 12      Panetolikos     Panthrakikos 0.5833333
## 7         Panionios    Panathinaikos 0.5384615
## 13    Panathinaikos        Panionios 0.5384615
## 11        Panionios     Panthrakikos 0.5000000
## 16       Olympiakos       Levadiakos 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df6_gr$Teams[df6_gr$Teams == &quot;Olympiakos P.&quot;] &lt;- df5_gr$Teams[df5_gr$Teams == &quot;Olympiakos&quot;]

###Checking match funtion after the correction
match(df5_gr$Teams, df6_gr$Teams)
</code></pre>

<pre><code>##  [1]  1  6  2  4 15  3 11  5 13 14  7  9 16 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 3 teams have
###been relegated the season 2011-2012 in Superleague Greece: https://en.wikipedia.org/wiki/2011-12_Superleague_Greece##

#####Manipulating the upper case issue in imported data (data_GRL14)#####

#library(dplyr)

head(data_GRL14)
</code></pre>

<pre><code>##    N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA             &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1    OLYMPIAKOS P.    34  28     2     4    88    19   16     0     1
## 3  2             PAOK    34  21     6     7    68    37   16     1     0
## 4  3    PANATHINAIKOS    34  20     6     8    57    28   12     2     3
## 5  4        ATROMITOS    34  19     9     6    54    25   12     5     0
## 6  5 ASTERAS TRIPOLIS    34  16    10     8    46    35   10     6     1
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      47    10   12     2     3      41     9  86
## 3      41     8    5     5     7      27    29  69
## 4      31    14    8     4     5      26    14  66
## 5      33     6    7     4     6      21    19  66
## 6      30    14    6     4     7      16    21  58
</code></pre>

<pre><code class="r">data_GRL14 &lt;- data_GRL14[-1 , ]

####Converting teams names to lower case
data_GRL14$Team2 &lt;-  tolower(data_GRL14$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL14$Team3 &lt;- sapply(data_GRL14$Team2, simpleCap)

data_GRL14$Team4 &lt;- as.factor(data_GRL14$Team3)

data_GRL14$Team5 &lt;-as.character(data_GRL14$Team4)
rownames(data_GRL14) &lt;- 1:nrow(data_GRL14)
head(data_GRL14)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    34  28     2     4    88    19   16     0     1
## 2 2             PAOK    34  21     6     7    68    37   16     1     0
## 3 3    PANATHINAIKOS    34  20     6     8    57    28   12     2     3
## 4 4        ATROMITOS    34  19     9     6    54    25   12     5     0
## 5 5 ASTERAS TRIPOLIS    34  16    10     8    46    35   10     6     1
## 6 6        ERGOTELIS    34  11    11    12    39    40    6     5     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      47    10   12     2     3      41     9  86    olympiakos p.
## 2      41     8    5     5     7      27    29  69             paok
## 3      31    14    8     4     5      26    14  66    panathinaikos
## 4      33     6    7     4     6      21    19  66        atromitos
## 5      30    14    6     4     7      16    21  58 asteras tripolis
## 6      25    22    5     6     6      14    18  44        ergotelis
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2             Paok             Paok             Paok
## 3    Panathinaikos    Panathinaikos    Panathinaikos
## 4        Atromitos        Atromitos        Atromitos
## 5 Asteras Tripolis Asteras Tripolis Asteras Tripolis
## 6        Ergotelis        Ergotelis        Ergotelis
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL14)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    34  28     2     4    88    19   16     0     1
## 2 2             PAOK    34  21     6     7    68    37   16     1     0
## 3 3    PANATHINAIKOS    34  20     6     8    57    28   12     2     3
## 4 4        ATROMITOS    34  19     9     6    54    25   12     5     0
## 5 5 ASTERAS TRIPOLIS    34  16    10     8    46    35   10     6     1
## 6 6        ERGOTELIS    34  11    11    12    39    40    6     5     6
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      47    10   12     2     3      41     9  86    olympiakos p.
## 2      41     8    5     5     7      27    29  69             paok
## 3      31    14    8     4     5      26    14  66    panathinaikos
## 4      33     6    7     4     6      21    19  66        atromitos
## 5      30    14    6     4     7      16    21  58 asteras tripolis
## 6      25    22    5     6     6      14    18  44        ergotelis
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2             Paok             Paok             Paok
## 3    Panathinaikos    Panathinaikos    Panathinaikos
## 4        Atromitos        Atromitos        Atromitos
## 5 Asteras Tripolis Asteras Tripolis Asteras Tripolis
## 6        Ergotelis        Ergotelis        Ergotelis
</code></pre>

<pre><code class="r">names(data_GRL14)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df7_gr &lt;- data_GRL14[c(1, 23, 3:8, 19)]

str(df7_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos P.&quot; &quot;Paok&quot; &quot;Panathinaikos&quot; &quot;Atromitos&quot; ...
##  $ Total: Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 5 2 2 2 4 3 ...
##  $ NA..1: Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 4 7 7 9 1 2 2 9 5 6 ...
##  $ NA..2: Factor w/ 12 levels &quot;12&quot;,&quot;14&quot;,&quot;15&quot;,..: 8 10 11 9 11 1 1 2 6 5 ...
##  $ Goals: Factor w/ 16 levels &quot;26&quot;,&quot;30&quot;,&quot;31&quot;,..: 15 14 13 12 11 7 2 4 8 6 ...
##  $ NA..3: Factor w/ 18 levels &quot;19&quot;,&quot;25&quot;,&quot;28&quot;,..: 1 6 3 2 5 8 7 4 16 10 ...
##  $ Pts  : num  86 69 66 66 58 44 44 42 42 41 ...
</code></pre>

<pre><code class="r">head(df7_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1    Olympiakos P.    34  28     2     4    88    19  86
## 2 2             Paok    34  21     6     7    68    37  69
## 3 3    Panathinaikos    34  20     6     8    57    28  66
## 4 4        Atromitos    34  19     9     6    54    25  66
## 5 5 Asteras Tripolis    34  16    10     8    46    35  58
## 6 6        Ergotelis    34  11    11    12    39    40  44
</code></pre>

<pre><code class="r">#####Changing the names#####

df7_gr$Aggregate &lt;- paste(df7_gr$Goals, df7_gr$NA..3, sep = &quot;-&quot;)
head(df7_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1    Olympiakos P.    34  28     2     4    88    19  86     88-19
## 2 2             Paok    34  21     6     7    68    37  69     68-37
## 3 3    Panathinaikos    34  20     6     8    57    28  66     57-28
## 4 4        Atromitos    34  19     9     6    54    25  66     54-25
## 5 5 Asteras Tripolis    34  16    10     8    46    35  58     46-35
## 6 6        Ergotelis    34  11    11    12    39    40  44     39-40
</code></pre>

<pre><code class="r">df7_gr &lt;- df7_gr[ ,c(1:6, 10, 9)]
head(df7_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1    Olympiakos P.    34  28     2     4     88-19  86
## 2 2             Paok    34  21     6     7     68-37  69
## 3 3    Panathinaikos    34  20     6     8     57-28  66
## 4 4        Atromitos    34  19     9     6     54-25  66
## 5 5 Asteras Tripolis    34  16    10     8     46-35  58
## 6 6        Ergotelis    34  11    11    12     39-40  44
</code></pre>

<pre><code class="r">names(df7_gr) &lt;- names(data_9)
head(df7_gr)
</code></pre>

<pre><code>##   Index            Teams Games Wins Draws Loss Aggregate Points
## 1     1    Olympiakos P.    34   28     2    4     88-19     86
## 2     2             Paok    34   21     6    7     68-37     69
## 3     3    Panathinaikos    34   20     6    8     57-28     66
## 4     4        Atromitos    34   19     9    6     54-25     66
## 5     5 Asteras Tripolis    34   16    10    8     46-35     58
## 6     6        Ergotelis    34   11    11   12     39-40     44
</code></pre>

<pre><code class="r">str(df7_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos P.&quot; &quot;Paok&quot; &quot;Panathinaikos&quot; &quot;Atromitos&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;34&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 12 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 9 8 7 6 5 2 2 2 4 3 ...
##  $ Draws    : Factor w/ 10 levels &quot;10&quot;,&quot;11&quot;,&quot;13&quot;,..: 4 7 7 9 1 2 2 9 5 6 ...
##  $ Loss     : Factor w/ 12 levels &quot;12&quot;,&quot;14&quot;,&quot;15&quot;,..: 8 10 11 9 11 1 1 2 6 5 ...
##  $ Aggregate: chr  &quot;88-19&quot; &quot;68-37&quot; &quot;57-28&quot; &quot;54-25&quot; ...
##  $ Points   : num  86 69 66 66 58 44 44 42 42 41 ...
</code></pre>

<pre><code class="r">df7_gr[ ,c(3:6)] &lt;- apply(df7_gr[ ,c(3:6)], 2, as.numeric)

match(df6_gr$Teams, df7_gr$Teams)
</code></pre>

<pre><code>##  [1] NA  2  5  4 10  3 15 11 12 14  9 16 18  7 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df6_gr$Teams, df7_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    288 obs. of  2 variables:
##  $ Var1: Factor w/ 16 levels &quot;Olympiakos&quot;,&quot;Paok&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Olympiakos P.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.7692308 0.1538462 0.0000000 0.2307692 0.1538462
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##               Var1          Var2  Distance
## 1       Olympiakos Olympiakos P. 0.7692308
## 2             Paok Olympiakos P. 0.1538462
## 3 Asteras Tripolis Olympiakos P. 0.0000000
## 4        Atromitos Olympiakos P. 0.2307692
## 5     Pas Giannina Olympiakos P. 0.1538462
## 6    Panathinaikos Olympiakos P. 0.1538462
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 24
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 1     Olympiakos Olympiakos P. 0.7692308
## 18          Paok          Paok 1.0000000
## 38 Panathinaikos Panathinaikos 1.0000000
## 40  Panthrakikos Panathinaikos 0.6923077
## 41     Panionios Panathinaikos 0.5384615
## 52     Atromitos     Atromitos 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 2              Paok             Paok 1.0000000
## 3     Panathinaikos    Panathinaikos 1.0000000
## 6         Atromitos        Atromitos 1.0000000
## 7  Asteras Tripolis Asteras Tripolis 1.0000000
## 8               Ofi              Ofi 1.0000000
## 13       Levadiakos       Levadiakos 1.0000000
## 14     Pas Giannina     Pas Giannina 1.0000000
## 16     Panthrakikos     Panthrakikos 1.0000000
## 20        Panionios        Panionios 1.0000000
## 21        Platanias        Platanias 1.0000000
## 22     Skoda Xanthi     Skoda Xanthi 1.0000000
## 23            Veria            Veria 1.0000000
## 24             Aris             Aris 1.0000000
## 1        Olympiakos    Olympiakos P. 0.7692308
## 4      Panthrakikos    Panathinaikos 0.6923077
## 15    Panathinaikos     Panthrakikos 0.6923077
## 11        Panionios     Panaitolikos 0.6666667
## 9     Panathinaikos     Panaitolikos 0.6153846
## 10     Panthrakikos     Panaitolikos 0.5833333
## 5         Panionios    Panathinaikos 0.5384615
## 18    Panathinaikos        Panionios 0.5384615
## 12       Olympiakos       Levadiakos 0.5000000
## 17        Panionios     Panthrakikos 0.5000000
## 19     Panthrakikos        Panionios 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df7_gr$Teams[df7_gr$Teams == &quot;Olympiakos P.&quot;] &lt;- df6_gr$Teams[df6_gr$Teams == &quot;Olympiakos&quot;]

###Checking match funtion after the correction
match(df6_gr$Teams, df7_gr$Teams)
</code></pre>

<pre><code>##  [1]  1  2  5  4 10  3 15 11 12 14  9 16 18  7 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2012-2013 in Superleague Greece: https://en.wikipedia.org/wiki/2012-13_Superleague_Greece##

#####Manipulating the upper case issue in imported data (data_GRL15)#####

#library(dplyr)

head(data_GRL15)
</code></pre>

<pre><code>##    N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA             &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1    OLYMPIAKOS P.    34  24     6     4    79    23   15     1     1
## 3  2    PANATHINAIKOS    34  21     6     7    59    31   15     1     1
## 4  3             PAOK    34  20     5     9    57    42   11     4     2
## 5  4 ASTERAS TRIPOLIS    34  17     8     9    52    37   13     4     0
## 6  5        ATROMITOS    34  14    12     8    43    27   12     5     0
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      45     8    9     5     3      34    15  78
## 3      38    11    6     5     6      21    20  66
## 4      30    14    9     1     7      27    28  65
## 5      33     9    4     4     9      19    28  59
## 6      30     7    2     7     8      13    20  54
</code></pre>

<pre><code class="r">data_GRL15 &lt;- data_GRL15[-1 , ]

####Converting teams names to lower case
data_GRL15$Team2 &lt;-  tolower(data_GRL15$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL15$Team3 &lt;- sapply(data_GRL15$Team2, simpleCap)

data_GRL15$Team4 &lt;- as.factor(data_GRL15$Team3)

data_GRL15$Team5 &lt;-as.character(data_GRL15$Team4)
rownames(data_GRL15) &lt;- 1:nrow(data_GRL15)
head(data_GRL15)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    34  24     6     4    79    23   15     1     1
## 2 2    PANATHINAIKOS    34  21     6     7    59    31   15     1     1
## 3 3             PAOK    34  20     5     9    57    42   11     4     2
## 4 4 ASTERAS TRIPOLIS    34  17     8     9    52    37   13     4     0
## 5 5        ATROMITOS    34  14    12     8    43    27   12     5     0
## 6 6     PAS GIANNINA    34  13    14     7    47    33    9     6     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      45     8    9     5     3      34    15  78    olympiakos p.
## 2      38    11    6     5     6      21    20  66    panathinaikos
## 3      30    14    9     1     7      27    28  65             paok
## 4      33     9    4     4     9      19    28  59 asteras tripolis
## 5      30     7    2     7     8      13    20  54        atromitos
## 6      29    15    4     8     5      18    18  53     pas giannina
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2    Panathinaikos    Panathinaikos    Panathinaikos
## 3             Paok             Paok             Paok
## 4 Asteras Tripolis Asteras Tripolis Asteras Tripolis
## 5        Atromitos        Atromitos        Atromitos
## 6     Pas Giannina     Pas Giannina     Pas Giannina
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL15)
</code></pre>

<pre><code>##   N             Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1    OLYMPIAKOS P.    34  24     6     4    79    23   15     1     1
## 2 2    PANATHINAIKOS    34  21     6     7    59    31   15     1     1
## 3 3             PAOK    34  20     5     9    57    42   11     4     2
## 4 4 ASTERAS TRIPOLIS    34  17     8     9    52    37   13     4     0
## 5 5        ATROMITOS    34  14    12     8    43    27   12     5     0
## 6 6     PAS GIANNINA    34  13    14     7    47    33    9     6     2
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts            Team2
## 1      45     8    9     5     3      34    15  78    olympiakos p.
## 2      38    11    6     5     6      21    20  66    panathinaikos
## 3      30    14    9     1     7      27    28  65             paok
## 4      33     9    4     4     9      19    28  59 asteras tripolis
## 5      30     7    2     7     8      13    20  54        atromitos
## 6      29    15    4     8     5      18    18  53     pas giannina
##              Team3            Team4            Team5
## 1    Olympiakos P.    Olympiakos P.    Olympiakos P.
## 2    Panathinaikos    Panathinaikos    Panathinaikos
## 3             Paok             Paok             Paok
## 4 Asteras Tripolis Asteras Tripolis Asteras Tripolis
## 5        Atromitos        Atromitos        Atromitos
## 6     Pas Giannina     Pas Giannina     Pas Giannina
</code></pre>

<pre><code class="r">names(data_GRL15)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df8_gr &lt;- data_GRL15[c(1, 23, 3:8, 19)]

str(df8_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos P.&quot; &quot;Panathinaikos&quot; &quot;Paok&quot; &quot;Asteras Tripolis&quot; ...
##  $ Total: Factor w/ 3 levels &quot;33&quot;,&quot;34&quot;,&quot;U&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ NA.  : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 5 4 3 4 2 2 2 ...
##  $ NA..1: Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 8 8 7 10 4 5 2 3 10 10 ...
##  $ NA..2: Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 11 13 13 12 11 1 2 5 5 ...
##  $ Goals: Factor w/ 16 levels &quot;26&quot;,&quot;32&quot;,&quot;34&quot;,..: 15 13 12 11 7 10 6 8 2 5 ...
##  $ NA..3: Factor w/ 18 levels &quot;23&quot;,&quot;27&quot;,&quot;28&quot;,..: 1 5 12 8 2 6 3 11 4 9 ...
##  $ Pts  : num  78 66 65 59 54 53 52 47 44 44 ...
</code></pre>

<pre><code class="r">head(df8_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1    Olympiakos P.    34  24     6     4    79    23  78
## 2 2    Panathinaikos    34  21     6     7    59    31  66
## 3 3             Paok    34  20     5     9    57    42  65
## 4 4 Asteras Tripolis    34  17     8     9    52    37  59
## 5 5        Atromitos    34  14    12     8    43    27  54
## 6 6     Pas Giannina    34  13    14     7    47    33  53
</code></pre>

<pre><code class="r">#####Changing the names#####

df8_gr$Aggregate &lt;- paste(df8_gr$Goals, df8_gr$NA..3, sep = &quot;-&quot;)
head(df8_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1    Olympiakos P.    34  24     6     4    79    23  78     79-23
## 2 2    Panathinaikos    34  21     6     7    59    31  66     59-31
## 3 3             Paok    34  20     5     9    57    42  65     57-42
## 4 4 Asteras Tripolis    34  17     8     9    52    37  59     52-37
## 5 5        Atromitos    34  14    12     8    43    27  54     43-27
## 6 6     Pas Giannina    34  13    14     7    47    33  53     47-33
</code></pre>

<pre><code class="r">df8_gr &lt;- df8_gr[ ,c(1:6, 10, 9)]
head(df8_gr)
</code></pre>

<pre><code>##   N            Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1    Olympiakos P.    34  24     6     4     79-23  78
## 2 2    Panathinaikos    34  21     6     7     59-31  66
## 3 3             Paok    34  20     5     9     57-42  65
## 4 4 Asteras Tripolis    34  17     8     9     52-37  59
## 5 5        Atromitos    34  14    12     8     43-27  54
## 6 6     Pas Giannina    34  13    14     7     47-33  53
</code></pre>

<pre><code class="r">names(df8_gr) &lt;- names(data_9)
head(df8_gr)
</code></pre>

<pre><code>##   Index            Teams Games Wins Draws Loss Aggregate Points
## 1     1    Olympiakos P.    34   24     6    4     79-23     78
## 2     2    Panathinaikos    34   21     6    7     59-31     66
## 3     3             Paok    34   20     5    9     57-42     65
## 4     4 Asteras Tripolis    34   17     8    9     52-37     59
## 5     5        Atromitos    34   14    12    8     43-27     54
## 6     6     Pas Giannina    34   13    14    7     47-33     53
</code></pre>

<pre><code class="r">str(df8_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    18 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos P.&quot; &quot;Panathinaikos&quot; &quot;Paok&quot; &quot;Asteras Tripolis&quot; ...
##  $ Games    : Factor w/ 3 levels &quot;33&quot;,&quot;34&quot;,&quot;U&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ Wins     : Factor w/ 12 levels &quot;11&quot;,&quot;12&quot;,&quot;13&quot;,..: 9 8 7 5 4 3 4 2 2 2 ...
##  $ Draws    : Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 8 8 7 10 4 5 2 3 10 10 ...
##  $ Loss     : Factor w/ 14 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 10 11 13 13 12 11 1 2 5 5 ...
##  $ Aggregate: chr  &quot;79-23&quot; &quot;59-31&quot; &quot;57-42&quot; &quot;52-37&quot; ...
##  $ Points   : num  78 66 65 59 54 53 52 47 44 44 ...
</code></pre>

<pre><code class="r">df8_gr[ ,c(3:6)] &lt;- apply(df8_gr[ ,c(3:6)], 2, as.numeric)

match(df7_gr$Teams, df8_gr$Teams)
</code></pre>

<pre><code>##  [1] NA  3  2  5  4 16 17 NA 12  6 14 13 11  9  8 15 NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df7_gr$Teams, df8_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    324 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Olympiakos&quot;,&quot;Paok&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 18 levels &quot;Olympiakos P.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.7692308 0.1538462 0.1538462 0.2307692 0.0000000
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##               Var1          Var2   Distance
## 1       Olympiakos Olympiakos P. 0.76923077
## 2             Paok Olympiakos P. 0.15384615
## 3    Panathinaikos Olympiakos P. 0.15384615
## 4        Atromitos Olympiakos P. 0.23076923
## 5 Asteras Tripolis Olympiakos P. 0.00000000
## 6        Ergotelis Olympiakos P. 0.07692308
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 29
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 1     Olympiakos Olympiakos P. 0.7692308
## 21 Panathinaikos Panathinaikos 1.0000000
## 26  Panaitolikos Panathinaikos 0.6153846
## 29  Panthrakikos Panathinaikos 0.6923077
## 30     Panionios Panathinaikos 0.5384615
## 38          Paok          Paok 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 2     Panathinaikos    Panathinaikos 1.0000000
## 6              Paok             Paok 1.0000000
## 7  Asteras Tripolis Asteras Tripolis 1.0000000
## 8         Atromitos        Atromitos 1.0000000
## 9      Pas Giannina     Pas Giannina 1.0000000
## 14     Skoda Xanthi     Skoda Xanthi 1.0000000
## 15        Platanias        Platanias 1.0000000
## 16      Kalloni Ael      Kalloni Ael 1.0000000
## 18       Levadiakos       Levadiakos 1.0000000
## 22        Panionios        Panionios 1.0000000
## 25     Panthrakikos     Panthrakikos 1.0000000
## 27            Veria            Veria 1.0000000
## 28        Ergotelis        Ergotelis 1.0000000
## 29              Ofi              Ofi 1.0000000
## 11     Panaitolikos      Panetolikos 0.8333333
## 1        Olympiakos    Olympiakos P. 0.7692308
## 4      Panthrakikos    Panathinaikos 0.6923077
## 23    Panathinaikos     Panthrakikos 0.6923077
## 20     Panaitolikos        Panionios 0.6666667
## 13        Panionios      Panetolikos 0.6363636
## 3      Panaitolikos    Panathinaikos 0.6153846
## 10    Panathinaikos      Panetolikos 0.6153846
## 12     Panthrakikos      Panetolikos 0.5833333
## 24     Panaitolikos     Panthrakikos 0.5833333
## 5         Panionios    Panathinaikos 0.5384615
## 19    Panathinaikos        Panionios 0.5384615
## 17       Olympiakos       Levadiakos 0.5000000
## 21     Panthrakikos        Panionios 0.5000000
## 26        Panionios     Panthrakikos 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df8_gr$Teams[df8_gr$Teams == &quot;Olympiakos P.&quot;] &lt;- df7_gr$Teams[df7_gr$Teams == &quot;Olympiakos&quot;]
df8_gr$Teams[df8_gr$Teams == &quot;Panetolikos&quot;] &lt;- df7_gr$Teams[df7_gr$Teams == &quot;Panaitolikos&quot;]


###Checking match funtion after the correction
match(df7_gr$Teams, df8_gr$Teams)
</code></pre>

<pre><code>##  [1]  1  3  2  5  4 16 17  7 12  6 14 13 11  9  8 15 NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 2 teams have
###been relegated the season 2013-2014 in Superleague Greece: https://en.wikipedia.org/wiki/2013-14_Superleague_Greece##

#####Manipulating the upper case issue in imported data (data_GRL16)#####

#library(dplyr)

head(data_GRL16)
</code></pre>

<pre><code>##    N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 NA          &lt;NA&gt;     U   P     N     I     D     P    P     N     I
## 2  1 OLYMPIAKOS P.    30  28     1     1    81    16   15     0     0
## 3  2    AEK ATHENS    30  17     6     7    43    21   13     0     2
## 4  3 PANATHINAIKOS    30  18     4     8    52    26   10     3     2
## 5  4          PAOK    30  13     9     8    45    32    9     4     2
## 6  5     PANIONIOS    30  12     8    10    33    27    8     3     4
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts
## 1       D     P    P     N     I       D     P  NA
## 2      45     5   13     1     1      36    11  85
## 3      31     6    4     6     5      12    15  57
## 4      34    12    8     1     6      18    14  55
## 5      24    12    4     5     6      21    20  48
## 6      19    11    4     5     6      14    16  44
</code></pre>

<pre><code class="r">data_GRL16 &lt;- data_GRL16[-1 , ]

####Converting teams names to lower case
data_GRL16$Team2 &lt;-  tolower(data_GRL16$Team)

####Converting the starting letter of the teams names to upper case 
data_GRL16$Team3 &lt;- sapply(data_GRL16$Team2, simpleCap)

data_GRL16$Team4 &lt;- as.factor(data_GRL16$Team3)

data_GRL16$Team5 &lt;-as.character(data_GRL16$Team4)
rownames(data_GRL16) &lt;- 1:nrow(data_GRL16)
head(data_GRL16)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 OLYMPIAKOS P.    30  28     1     1    81    16   15     0     0
## 2 2    AEK ATHENS    30  17     6     7    43    21   13     0     2
## 3 3 PANATHINAIKOS    30  18     4     8    52    26   10     3     2
## 4 4          PAOK    30  13     9     8    45    32    9     4     2
## 5 5     PANIONIOS    30  12     8    10    33    27    8     3     4
## 6 6  PAS GIANNINA    30  12     6    12    36    40    7     3     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      45     5   13     1     1      36    11  85 olympiakos p.
## 2      31     6    4     6     5      12    15  57    aek athens
## 3      34    12    8     1     6      18    14  55 panathinaikos
## 4      24    12    4     5     6      21    20  48          paok
## 5      19    11    4     5     6      14    16  44     panionios
## 6      19    17    5     3     7      17    23  42  pas giannina
##           Team3         Team4         Team5
## 1 Olympiakos P. Olympiakos P. Olympiakos P.
## 2    Aek Athens    Aek Athens    Aek Athens
## 3 Panathinaikos Panathinaikos Panathinaikos
## 4          Paok          Paok          Paok
## 5     Panionios     Panionios     Panionios
## 6  Pas Giannina  Pas Giannina  Pas Giannina
</code></pre>

<pre><code class="r">####Bring the data set in the same form with the other European leagues####
head(data_GRL16)
</code></pre>

<pre><code>##   N          Team Total NA. NA..1 NA..2 Goals NA..3 Home NA..4 NA..5
## 1 1 OLYMPIAKOS P.    30  28     1     1    81    16   15     0     0
## 2 2    AEK ATHENS    30  17     6     7    43    21   13     0     2
## 3 3 PANATHINAIKOS    30  18     4     8    52    26   10     3     2
## 4 4          PAOK    30  13     9     8    45    32    9     4     2
## 5 5     PANIONIOS    30  12     8    10    33    27    8     3     4
## 6 6  PAS GIANNINA    30  12     6    12    36    40    7     3     5
##   Goals.1 NA..6 Away NA..7 NA..8 Goals.2 NA..9 Pts         Team2
## 1      45     5   13     1     1      36    11  85 olympiakos p.
## 2      31     6    4     6     5      12    15  57    aek athens
## 3      34    12    8     1     6      18    14  55 panathinaikos
## 4      24    12    4     5     6      21    20  48          paok
## 5      19    11    4     5     6      14    16  44     panionios
## 6      19    17    5     3     7      17    23  42  pas giannina
##           Team3         Team4         Team5
## 1 Olympiakos P. Olympiakos P. Olympiakos P.
## 2    Aek Athens    Aek Athens    Aek Athens
## 3 Panathinaikos Panathinaikos Panathinaikos
## 4          Paok          Paok          Paok
## 5     Panionios     Panionios     Panionios
## 6  Pas Giannina  Pas Giannina  Pas Giannina
</code></pre>

<pre><code class="r">names(data_GRL16)
</code></pre>

<pre><code>##  [1] &quot;N&quot;       &quot;Team&quot;    &quot;Total&quot;   &quot;NA.&quot;     &quot;NA..1&quot;   &quot;NA..2&quot;   &quot;Goals&quot;  
##  [8] &quot;NA..3&quot;   &quot;Home&quot;    &quot;NA..4&quot;   &quot;NA..5&quot;   &quot;Goals.1&quot; &quot;NA..6&quot;   &quot;Away&quot;   
## [15] &quot;NA..7&quot;   &quot;NA..8&quot;   &quot;Goals.2&quot; &quot;NA..9&quot;   &quot;Pts&quot;     &quot;Team2&quot;   &quot;Team3&quot;  
## [22] &quot;Team4&quot;   &quot;Team5&quot;
</code></pre>

<pre><code class="r">df9_gr &lt;- data_GRL16[c(1, 23, 3:8, 19)]

str(df9_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  9 variables:
##  $ N    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Team5: chr  &quot;Olympiakos P.&quot; &quot;Aek Athens&quot; &quot;Panathinaikos&quot; &quot;Paok&quot; ...
##  $ Total: Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ NA.  : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 5 6 4 3 3 3 2 1 12 ...
##  $ NA..1: Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 7 6 10 9 7 7 9 10 2 ...
##  $ NA..2: Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 8 9 9 2 4 4 3 3 3 ...
##  $ Goals: Factor w/ 15 levels &quot;18&quot;,&quot;19&quot;,&quot;24&quot;,..: 14 11 13 12 9 10 4 7 8 5 ...
##  $ NA..3: Factor w/ 14 levels &quot;16&quot;,&quot;21&quot;,&quot;26&quot;,..: 1 2 3 7 4 10 6 5 5 9 ...
##  $ Pts  : num  85 57 55 48 44 42 42 41 39 37 ...
</code></pre>

<pre><code class="r">head(df9_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts
## 1 1 Olympiakos P.    30  28     1     1    81    16  85
## 2 2    Aek Athens    30  17     6     7    43    21  57
## 3 3 Panathinaikos    30  18     4     8    52    26  55
## 4 4          Paok    30  13     9     8    45    32  48
## 5 5     Panionios    30  12     8    10    33    27  44
## 6 6  Pas Giannina    30  12     6    12    36    40  42
</code></pre>

<pre><code class="r">#####Changing the names#####

df9_gr$Aggregate &lt;- paste(df9_gr$Goals, df9_gr$NA..3, sep = &quot;-&quot;)
head(df9_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Goals NA..3 Pts Aggregate
## 1 1 Olympiakos P.    30  28     1     1    81    16  85     81-16
## 2 2    Aek Athens    30  17     6     7    43    21  57     43-21
## 3 3 Panathinaikos    30  18     4     8    52    26  55     52-26
## 4 4          Paok    30  13     9     8    45    32  48     45-32
## 5 5     Panionios    30  12     8    10    33    27  44     33-27
## 6 6  Pas Giannina    30  12     6    12    36    40  42     36-40
</code></pre>

<pre><code class="r">df9_gr &lt;- df9_gr[ ,c(1:6, 10, 9)]
head(df9_gr)
</code></pre>

<pre><code>##   N         Team5 Total NA. NA..1 NA..2 Aggregate Pts
## 1 1 Olympiakos P.    30  28     1     1     81-16  85
## 2 2    Aek Athens    30  17     6     7     43-21  57
## 3 3 Panathinaikos    30  18     4     8     52-26  55
## 4 4          Paok    30  13     9     8     45-32  48
## 5 5     Panionios    30  12     8    10     33-27  44
## 6 6  Pas Giannina    30  12     6    12     36-40  42
</code></pre>

<pre><code class="r">names(df9_gr) &lt;- names(data_9)
head(df9_gr)
</code></pre>

<pre><code>##   Index         Teams Games Wins Draws Loss Aggregate Points
## 1     1 Olympiakos P.    30   28     1    1     81-16     85
## 2     2    Aek Athens    30   17     6    7     43-21     57
## 3     3 Panathinaikos    30   18     4    8     52-26     55
## 4     4          Paok    30   13     9    8     45-32     48
## 5     5     Panionios    30   12     8   10     33-27     44
## 6     6  Pas Giannina    30   12     6   12     36-40     42
</code></pre>

<pre><code class="r">str(df9_gr)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    16 obs. of  8 variables:
##  $ Index    : num  1 2 3 4 5 6 7 8 9 10 ...
##  $ Teams    : chr  &quot;Olympiakos P.&quot; &quot;Aek Athens&quot; &quot;Panathinaikos&quot; &quot;Paok&quot; ...
##  $ Games    : Factor w/ 2 levels &quot;30&quot;,&quot;U&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ Wins     : Factor w/ 13 levels &quot;10&quot;,&quot;11&quot;,&quot;12&quot;,..: 7 5 6 4 3 3 3 2 1 12 ...
##  $ Draws    : Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 7 6 10 9 7 7 9 10 2 ...
##  $ Loss     : Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 8 9 9 2 4 4 3 3 3 ...
##  $ Aggregate: chr  &quot;81-16&quot; &quot;43-21&quot; &quot;52-26&quot; &quot;45-32&quot; ...
##  $ Points   : num  85 57 55 48 44 42 42 41 39 37 ...
</code></pre>

<pre><code class="r">df9_gr[ ,c(3:6)] &lt;- apply(df9_gr[ ,c(3:6)], 2, as.numeric)

match(df8_gr$Teams, df9_gr$Teams)
</code></pre>

<pre><code>##  [1] NA  3  4  8  7  6 NA 13  9 NA 16 10  5 15 14 NA NA NA
</code></pre>

<pre><code class="r">matches &lt;- data.frame(expand.grid(df8_gr$Teams, df9_gr$Teams))
str(matches)
</code></pre>

<pre><code>## &#39;data.frame&#39;:    288 obs. of  2 variables:
##  $ Var1: Factor w/ 18 levels &quot;Olympiakos&quot;,&quot;Panathinaikos&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...
##  $ Var2: Factor w/ 16 levels &quot;Olympiakos P.&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
</code></pre>

<pre><code class="r">matches$Var1 &lt;- as.character(matches$Var1)
matches$Var2 &lt;- as.character(matches$Var2)


#install.packages(&quot;RecordLinkage&quot;)
#install.packages(&quot;ffbase&quot;)
library(RecordLinkage)

distance &lt;- levenshteinSim(matches[ , 1], matches[ , 2])
distance[1:5]
</code></pre>

<pre><code>## [1] 0.7692308 0.1538462 0.1538462 0.0000000 0.2307692
</code></pre>

<pre><code class="r">matches$Distance &lt;- distance
head(matches)
</code></pre>

<pre><code>##               Var1          Var2  Distance
## 1       Olympiakos Olympiakos P. 0.7692308
## 2    Panathinaikos Olympiakos P. 0.1538462
## 3             Paok Olympiakos P. 0.1538462
## 4 Asteras Tripolis Olympiakos P. 0.0000000
## 5        Atromitos Olympiakos P. 0.2307692
## 6     Pas Giannina Olympiakos P. 0.1538462
</code></pre>

<pre><code class="r">length(which(matches$Distance &gt;= 0.5))
</code></pre>

<pre><code>## [1] 28
</code></pre>

<pre><code class="r">#####Finding the similar teams (Levehnstein distance &gt;= 0.5)#####
matches2 &lt;- subset.data.frame(matches, matches$Distance &gt;= 0.5, drop = TRUE)


###We check the names in order to have the same taxonomy ###
###between the season due to the dynamic index which rates the ranking mobility of the teams###
###As a result, if we have the same taxonomy we are able to find the mobility of the teams

head(matches2)
</code></pre>

<pre><code>##             Var1          Var2  Distance
## 1     Olympiakos Olympiakos P. 0.7692308
## 38 Panathinaikos Panathinaikos 1.0000000
## 43  Panaitolikos Panathinaikos 0.6153846
## 49     Panionios Panathinaikos 0.5384615
## 50  Panthrakikos Panathinaikos 0.6923077
## 57          Paok          Paok 1.0000000
</code></pre>

<pre><code class="r">rownames(matches2) &lt;- 1:nrow(matches2)
matches2[order(-(matches2$Distance)), ]
</code></pre>

<pre><code>##                Var1             Var2  Distance
## 2     Panathinaikos    Panathinaikos 1.0000000
## 6              Paok             Paok 1.0000000
## 9         Panionios        Panionios 1.0000000
## 11     Pas Giannina     Pas Giannina 1.0000000
## 12        Atromitos        Atromitos 1.0000000
## 13 Asteras Tripolis Asteras Tripolis 1.0000000
## 14        Platanias        Platanias 1.0000000
## 16       Levadiakos       Levadiakos 1.0000000
## 22     Skoda Xanthi     Skoda Xanthi 1.0000000
## 23            Veria            Veria 1.0000000
## 27     Panthrakikos     Panthrakikos 1.0000000
## 28      Kalloni Ael      Kalloni Ael 1.0000000
## 19     Panaitolikos      Panetolikos 0.8333333
## 1        Olympiakos    Olympiakos P. 0.7692308
## 5      Panthrakikos    Panathinaikos 0.6923077
## 24    Panathinaikos     Panthrakikos 0.6923077
## 8      Panaitolikos        Panionios 0.6666667
## 20        Panionios      Panetolikos 0.6363636
## 3      Panaitolikos    Panathinaikos 0.6153846
## 18    Panathinaikos      Panetolikos 0.6153846
## 21     Panthrakikos      Panetolikos 0.5833333
## 25     Panaitolikos     Panthrakikos 0.5833333
## 4         Panionios    Panathinaikos 0.5384615
## 7     Panathinaikos        Panionios 0.5384615
## 10     Panthrakikos        Panionios 0.5000000
## 15       Olympiakos       Levadiakos 0.5000000
## 17     Panthrakikos      Pae Iraklis 0.5000000
## 26        Panionios     Panthrakikos 0.5000000
</code></pre>

<pre><code class="r">#####Changing the names#####
df9_gr$Teams[df9_gr$Teams == &quot;Olympiakos P.&quot;] &lt;- df8_gr$Teams[df8_gr$Teams == &quot;Olympiakos&quot;]
df9_gr$Teams[df9_gr$Teams == &quot;Panetolikos&quot;] &lt;- df8_gr$Teams[df8_gr$Teams == &quot;Panaitolikos&quot;]


###Checking match funtion after the correction
match(df8_gr$Teams, df9_gr$Teams)
</code></pre>

<pre><code>##  [1]  1  3  4  8  7  6 12 13  9 NA 16 10  5 15 14 NA NA NA
</code></pre>

<pre><code class="r">###The result is right due to the relegation promotion - relegation rule, 4 teams have
###been relegated the season 2014-2015 in Superleague Greece: https://en.wikipedia.org/wiki/2014-15_Superleague_Greece##

#####Keeping the appropriate columns function####
columns_remove &lt;- function(s) {
  z &lt;- s[1:8]
  return(z)
}
</code></pre>

</body>

</html>
